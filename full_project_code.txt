

================================================
FILE: D:\barter_verse\backend\nodemon.json
================================================
{
  "watch": ["src"],
  "ext": "ts",
  "ignore": ["src/**/*.test.ts"],
  "exec": "tsx",
  "env": {
    "NODE_ENV": "development"
  }
}


================================================
FILE: D:\barter_verse\backend\package.json
================================================
{
  "name": "barterverse-backend",
  "version": "1.0.0",
  "description": "BarterVerse Backend API - Node.js + Express + Prisma",
  "main": "dist/server.js",
  "type": "module",
  "scripts": {
    "dev": "nodemon --exec tsx src/server.ts",
    "build": "tsc",
    "start": "tsx src/server.ts",
    "seed": "tsx src/scripts/seed.ts",
    "prisma:migrate": "prisma migrate dev",
    "prisma:studio": "prisma studio",
    "prisma:generate": "prisma generate"
  },
  "keywords": [
    "barterverse",
    "trading",
    "peer-to-peer",
    "express",
    "prisma"
  ],
  "author": "BarterVerse",
  "license": "MIT",
  "dependencies": {
    "@prisma/client": "^5.7.1",
    "@types/multer": "^2.0.0",
    "bcryptjs": "^3.0.3",
    "cookie-parser": "^1.4.7",
    "cors": "^2.8.5",
    "dotenv": "^16.3.1",
    "express": "^4.18.2",
    "helmet": "^7.1.0",
    "jsonwebtoken": "^9.0.3",
    "morgan": "^1.10.1",
    "multer": "^2.0.2",
    "tsconfig-paths": "^4.2.0",
    "zod": "^3.22.4"
  },
  "devDependencies": {
    "@types/cors": "^2.8.17",
    "@types/express": "^4.17.21",
    "@types/node": "^20.10.6",
    "nodemon": "^3.0.2",
    "prisma": "^5.7.1",
    "tsx": "^4.7.0",
    "typescript": "^5.3.3"
  }
}


================================================
FILE: D:\barter_verse\backend\prisma\client.ts
================================================
import { PrismaClient } from '@prisma/client';

export const prisma = new PrismaClient();

process.on('beforeExit', async () => {
  await prisma.$disconnect();
});


================================================
FILE: D:\barter_verse\backend\prisma\migrations\20251127224035_init\migration.sql
================================================
-- CreateEnum
CREATE TYPE "ListingStatus" AS ENUM ('ACTIVE', 'TRADED', 'ARCHIVED');

-- CreateEnum
CREATE TYPE "TradeStatus" AS ENUM ('PENDING', 'ACCEPTED', 'REJECTED', 'COMPLETED');

-- CreateTable
CREATE TABLE "Profile" (
    "id" TEXT NOT NULL,
    "email" TEXT NOT NULL,
    "username" TEXT NOT NULL,
    "avatar_url" TEXT,
    "bio" TEXT,
    "coins" INTEGER NOT NULL DEFAULT 100,
    "rating" DOUBLE PRECISION NOT NULL DEFAULT 5.0,
    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updated_at" TIMESTAMP(3) NOT NULL,

    CONSTRAINT "Profile_pkey" PRIMARY KEY ("id")
);

-- CreateTable
CREATE TABLE "Listing" (
    "id" TEXT NOT NULL,
    "owner_id" TEXT NOT NULL,
    "title" TEXT NOT NULL,
    "description" TEXT NOT NULL,
    "category" TEXT NOT NULL,
    "image_url" TEXT,
    "is_service" BOOLEAN NOT NULL DEFAULT false,
    "status" "ListingStatus" NOT NULL DEFAULT 'ACTIVE',
    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updated_at" TIMESTAMP(3) NOT NULL,

    CONSTRAINT "Listing_pkey" PRIMARY KEY ("id")
);

-- CreateTable
CREATE TABLE "Trade" (
    "id" TEXT NOT NULL,
    "initiator_id" TEXT NOT NULL,
    "responder_id" TEXT NOT NULL,
    "listing_id" TEXT NOT NULL,
    "proposed_listing_id" TEXT,
    "coin_amount" INTEGER NOT NULL DEFAULT 0,
    "message" TEXT,
    "status" "TradeStatus" NOT NULL DEFAULT 'PENDING',
    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updated_at" TIMESTAMP(3) NOT NULL,

    CONSTRAINT "Trade_pkey" PRIMARY KEY ("id")
);

-- CreateTable
CREATE TABLE "CoinTransaction" (
    "id" TEXT NOT NULL,
    "user_id" TEXT NOT NULL,
    "amount" INTEGER NOT NULL,
    "reason" TEXT NOT NULL,
    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,

    CONSTRAINT "CoinTransaction_pkey" PRIMARY KEY ("id")
);

-- CreateIndex
CREATE UNIQUE INDEX "Profile_email_key" ON "Profile"("email");

-- CreateIndex
CREATE UNIQUE INDEX "Profile_username_key" ON "Profile"("username");

-- CreateIndex
CREATE INDEX "Profile_email_idx" ON "Profile"("email");

-- CreateIndex
CREATE INDEX "Profile_username_idx" ON "Profile"("username");

-- CreateIndex
CREATE INDEX "Listing_owner_id_idx" ON "Listing"("owner_id");

-- CreateIndex
CREATE INDEX "Listing_category_idx" ON "Listing"("category");

-- CreateIndex
CREATE INDEX "Listing_status_idx" ON "Listing"("status");

-- CreateIndex
CREATE INDEX "Trade_initiator_id_idx" ON "Trade"("initiator_id");

-- CreateIndex
CREATE INDEX "Trade_responder_id_idx" ON "Trade"("responder_id");

-- CreateIndex
CREATE INDEX "Trade_listing_id_idx" ON "Trade"("listing_id");

-- CreateIndex
CREATE INDEX "Trade_status_idx" ON "Trade"("status");

-- CreateIndex
CREATE INDEX "CoinTransaction_user_id_idx" ON "CoinTransaction"("user_id");

-- AddForeignKey
ALTER TABLE "Listing" ADD CONSTRAINT "Listing_owner_id_fkey" FOREIGN KEY ("owner_id") REFERENCES "Profile"("id") ON DELETE CASCADE ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "Trade" ADD CONSTRAINT "Trade_initiator_id_fkey" FOREIGN KEY ("initiator_id") REFERENCES "Profile"("id") ON DELETE CASCADE ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "Trade" ADD CONSTRAINT "Trade_responder_id_fkey" FOREIGN KEY ("responder_id") REFERENCES "Profile"("id") ON DELETE CASCADE ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "Trade" ADD CONSTRAINT "Trade_listing_id_fkey" FOREIGN KEY ("listing_id") REFERENCES "Listing"("id") ON DELETE CASCADE ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "CoinTransaction" ADD CONSTRAINT "CoinTransaction_user_id_fkey" FOREIGN KEY ("user_id") REFERENCES "Profile"("id") ON DELETE CASCADE ON UPDATE CASCADE;


================================================
FILE: D:\barter_verse\backend\prisma\migrations\20251127231458_add_password_field\migration.sql
================================================
/*
  Warnings:

  - Added the required column `password` to the `Profile` table without a default value. This is not possible if the table is not empty.

*/
-- AlterTable
ALTER TABLE "Profile" ADD COLUMN     "password" TEXT NOT NULL;


================================================
FILE: D:\barter_verse\backend\prisma\migrations\20251127231910_add_admin_role\migration.sql
================================================
-- AlterTable
ALTER TABLE "Profile" ADD COLUMN     "role" TEXT NOT NULL DEFAULT 'user';

-- CreateIndex
CREATE INDEX "Profile_role_idx" ON "Profile"("role");


================================================
FILE: D:\barter_verse\backend\prisma\migrations\20251230045531_add_features_migration\migration.sql
================================================
-- CreateEnum
CREATE TYPE "SessionStatus" AS ENUM ('SCHEDULED', 'IN_PROGRESS', 'COMPLETED', 'CANCELLED', 'NO_SHOW');

-- AlterTable
ALTER TABLE "Profile" ADD COLUMN     "city" TEXT,
ADD COLUMN     "country" TEXT,
ADD COLUMN     "latitude" DOUBLE PRECISION,
ADD COLUMN     "longitude" DOUBLE PRECISION;

-- CreateTable
CREATE TABLE "Session" (
    "id" TEXT NOT NULL,
    "provider_id" TEXT NOT NULL,
    "participant_id" TEXT NOT NULL,
    "skill_title" TEXT NOT NULL,
    "description" TEXT,
    "scheduled_at" TIMESTAMP(3) NOT NULL,
    "duration_minutes" INTEGER NOT NULL DEFAULT 60,
    "status" "SessionStatus" NOT NULL DEFAULT 'SCHEDULED',
    "location" TEXT,
    "meeting_link" TEXT,
    "notes" TEXT,
    "feedback" TEXT,
    "rating" DOUBLE PRECISION,
    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updated_at" TIMESTAMP(3) NOT NULL,

    CONSTRAINT "Session_pkey" PRIMARY KEY ("id")
);

-- CreateTable
CREATE TABLE "Conversation" (
    "id" TEXT NOT NULL,
    "user_id" TEXT NOT NULL,
    "other_user_id" TEXT NOT NULL,
    "last_message" TEXT,
    "last_message_at" TIMESTAMP(3),
    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updated_at" TIMESTAMP(3) NOT NULL,

    CONSTRAINT "Conversation_pkey" PRIMARY KEY ("id")
);

-- CreateTable
CREATE TABLE "Message" (
    "id" TEXT NOT NULL,
    "sender_id" TEXT NOT NULL,
    "receiver_id" TEXT NOT NULL,
    "content" TEXT NOT NULL,
    "is_read" BOOLEAN NOT NULL DEFAULT false,
    "read_at" TIMESTAMP(3),
    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,

    CONSTRAINT "Message_pkey" PRIMARY KEY ("id")
);

-- CreateIndex
CREATE INDEX "Session_provider_id_idx" ON "Session"("provider_id");

-- CreateIndex
CREATE INDEX "Session_participant_id_idx" ON "Session"("participant_id");

-- CreateIndex
CREATE INDEX "Session_status_idx" ON "Session"("status");

-- CreateIndex
CREATE INDEX "Session_scheduled_at_idx" ON "Session"("scheduled_at");

-- CreateIndex
CREATE INDEX "Conversation_user_id_idx" ON "Conversation"("user_id");

-- CreateIndex
CREATE INDEX "Conversation_updated_at_idx" ON "Conversation"("updated_at");

-- CreateIndex
CREATE UNIQUE INDEX "Conversation_user_id_other_user_id_key" ON "Conversation"("user_id", "other_user_id");

-- CreateIndex
CREATE INDEX "Message_sender_id_idx" ON "Message"("sender_id");

-- CreateIndex
CREATE INDEX "Message_receiver_id_idx" ON "Message"("receiver_id");

-- CreateIndex
CREATE INDEX "Message_is_read_idx" ON "Message"("is_read");

-- CreateIndex
CREATE INDEX "Message_created_at_idx" ON "Message"("created_at");

-- AddForeignKey
ALTER TABLE "Session" ADD CONSTRAINT "Session_provider_id_fkey" FOREIGN KEY ("provider_id") REFERENCES "Profile"("id") ON DELETE CASCADE ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "Session" ADD CONSTRAINT "Session_participant_id_fkey" FOREIGN KEY ("participant_id") REFERENCES "Profile"("id") ON DELETE CASCADE ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "Conversation" ADD CONSTRAINT "Conversation_user_id_fkey" FOREIGN KEY ("user_id") REFERENCES "Profile"("id") ON DELETE CASCADE ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "Message" ADD CONSTRAINT "Message_sender_id_fkey" FOREIGN KEY ("sender_id") REFERENCES "Profile"("id") ON DELETE CASCADE ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "Message" ADD CONSTRAINT "Message_receiver_id_fkey" FOREIGN KEY ("receiver_id") REFERENCES "Profile"("id") ON DELETE CASCADE ON UPDATE CASCADE;


================================================
FILE: D:\barter_verse\backend\prisma\migrations\20251230054412_add_location_fields\migration.sql
================================================
-- AlterTable
ALTER TABLE "Profile" ADD COLUMN     "pincode" TEXT,
ADD COLUMN     "state" TEXT,
ADD COLUMN     "town" TEXT;


================================================
FILE: D:\barter_verse\backend\prisma\migrations\20260102054417_add_unique_id_and_reviews\migration.sql
================================================
/*
  Warnings:

  - A unique constraint covering the columns `[uniqueId]` on the table `Profile` will be added. If there are existing duplicate values, this will fail.

*/
-- AlterTable
ALTER TABLE "Profile" ADD COLUMN     "uniqueId" TEXT;

-- CreateTable
CREATE TABLE "Review" (
    "id" TEXT NOT NULL,
    "author_id" TEXT NOT NULL,
    "target_user_id" TEXT NOT NULL,
    "trade_id" TEXT,
    "listing_id" TEXT,
    "rating" INTEGER NOT NULL,
    "comment" TEXT NOT NULL,
    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updated_at" TIMESTAMP(3) NOT NULL,

    CONSTRAINT "Review_pkey" PRIMARY KEY ("id")
);

-- CreateIndex
CREATE INDEX "Review_author_id_idx" ON "Review"("author_id");

-- CreateIndex
CREATE INDEX "Review_target_user_id_idx" ON "Review"("target_user_id");

-- CreateIndex
CREATE INDEX "Review_rating_idx" ON "Review"("rating");

-- CreateIndex
CREATE INDEX "Review_created_at_idx" ON "Review"("created_at");

-- CreateIndex
CREATE UNIQUE INDEX "Profile_uniqueId_key" ON "Profile"("uniqueId");

-- AddForeignKey
ALTER TABLE "Review" ADD CONSTRAINT "Review_author_id_fkey" FOREIGN KEY ("author_id") REFERENCES "Profile"("id") ON DELETE CASCADE ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "Review" ADD CONSTRAINT "Review_target_user_id_fkey" FOREIGN KEY ("target_user_id") REFERENCES "Profile"("id") ON DELETE CASCADE ON UPDATE CASCADE;


================================================
FILE: D:\barter_verse\backend\prisma\migrations\20260111140231_sync_schema_update\migration.sql
================================================
/*
  Warnings:

  - You are about to drop the column `image_url` on the `Listing` table. All the data in the column will be lost.

*/
-- AlterEnum
-- This migration adds more than one value to an enum.
-- With PostgreSQL versions 11 and earlier, this is not possible
-- in a single migration. This can be worked around by creating
-- multiple migrations, each migration adding only one value to
-- the enum.


ALTER TYPE "TradeStatus" ADD VALUE 'ESCROW_LOCKED';
ALTER TYPE "TradeStatus" ADD VALUE 'DELIVERED';
ALTER TYPE "TradeStatus" ADD VALUE 'CANCELLED';
ALTER TYPE "TradeStatus" ADD VALUE 'DISPUTED';

-- DropIndex
DROP INDEX "Conversation_updated_at_idx";

-- DropIndex
DROP INDEX "Message_created_at_idx";

-- DropIndex
DROP INDEX "Message_is_read_idx";

-- DropIndex
DROP INDEX "Profile_role_idx";

-- DropIndex
DROP INDEX "Review_created_at_idx";

-- DropIndex
DROP INDEX "Review_rating_idx";

-- DropIndex
DROP INDEX "Session_scheduled_at_idx";

-- AlterTable
ALTER TABLE "Listing" DROP COLUMN "image_url",
ADD COLUMN     "images" TEXT[],
ADD COLUMN     "location" TEXT,
ADD COLUMN     "price_bc" INTEGER NOT NULL DEFAULT 0;

-- AlterTable
ALTER TABLE "Profile" ADD COLUMN     "display_name" TEXT;


================================================
FILE: D:\barter_verse\backend\prisma\schema.prisma
================================================
// prisma/schema.prisma
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Profile {
  id           String   @id @default(cuid())
  uniqueId     String?  @unique @default(cuid())
  email        String   @unique
  username     String   @unique
  display_name String?  // Added this field
  password     String
  avatar_url   String?
  bio          String?
  coins        Int      @default(100)
  rating       Float    @default(5.0)
  role         String   @default("user") // "user" or "admin"
  
  created_at   DateTime @default(now())
  updated_at   DateTime @updatedAt

  // Location fields
  latitude  Float?
  longitude Float?
  city      String?
  town      String?
  state     String?
  country   String?
  pincode   String?

  // Relations
  listings            Listing[]
  trades_initiated    Trade[]           @relation("trades_initiator")
  trades_received     Trade[]           @relation("trades_responder")
  coin_transactions   CoinTransaction[]
  sessions_as_provider Session[]        @relation("provider")
  sessions_as_participant Session[]     @relation("participant")
  messages_sent       Message[]         @relation("sender")
  messages_received   Message[]         @relation("receiver")
  conversations       Conversation[]
  reviews_authored    Review[]          @relation("reviews_authored")
  reviews_received    Review[]          @relation("reviews_received")

  @@index([email])
  @@index([username])
}

model Listing {
  id           String   @id @default(cuid())
  owner_id     String
  owner        Profile  @relation(fields: [owner_id], references: [id], onDelete: Cascade)
  
  title        String
  description  String   @db.Text
  category     String
  
  // Updated Fields for Marketplace Logic
  images       String[] // Changed from single image_url to array for multiple images
  price_bc     Int      @default(0) // Added Price in Barter Coins
  location     String?  // Added specific location string (e.g. "Remote" or "NYC")
  
  is_service   Boolean  @default(false)
  status       ListingStatus @default(ACTIVE)
  
  created_at   DateTime @default(now())
  updated_at   DateTime @updatedAt

  trades       Trade[]

  @@index([owner_id])
  @@index([category])
  @@index([status])
}

model Trade {
  id                 String   @id @default(cuid())
  initiator_id       String
  initiator          Profile  @relation("trades_initiator", fields: [initiator_id], references: [id], onDelete: Cascade)
  
  responder_id       String
  responder          Profile  @relation("trades_responder", fields: [responder_id], references: [id], onDelete: Cascade)
  
  listing_id         String
  listing            Listing  @relation(fields: [listing_id], references: [id], onDelete: Cascade)
  
  proposed_listing_id String?
  coin_amount        Int      @default(0)
  message            String?  @db.Text
  
  // Updated Enum usage
  status             TradeStatus @default(PENDING)
  
  created_at         DateTime @default(now())
  updated_at         DateTime @updatedAt

  @@index([initiator_id])
  @@index([responder_id])
  @@index([listing_id])
  @@index([status])
}

model CoinTransaction {
  id        String   @id @default(cuid())
  user_id   String
  user      Profile  @relation(fields: [user_id], references: [id], onDelete: Cascade)
  
  amount    Int
  reason    String
  created_at DateTime @default(now())

  @@index([user_id])
}

enum ListingStatus {
  ACTIVE
  TRADED
  ARCHIVED
}

// CRITICAL UPDATE: Supports Escrow Flow
enum TradeStatus {
  PENDING
  ACCEPTED       // Initial accept
  ESCROW_LOCKED  // Coins locked
  DELIVERED      // Seller sent item
  COMPLETED      // Buyer received, coins released
  REJECTED       // Offer declined
  CANCELLED      // Offer cancelled by initiator
  DISPUTED       // Admin help needed
}

enum SessionStatus {
  SCHEDULED
  IN_PROGRESS
  COMPLETED
  CANCELLED
  NO_SHOW
}

model Session {
  id           String   @id @default(cuid())
  
  provider_id  String
  provider     Profile  @relation("provider", fields: [provider_id], references: [id], onDelete: Cascade)
  
  participant_id String
  participant    Profile @relation("participant", fields: [participant_id], references: [id], onDelete: Cascade)
  
  skill_title  String
  description  String?  @db.Text
  
  scheduled_at DateTime
  duration_minutes Int   @default(60)
  
  status       SessionStatus @default(SCHEDULED)
  location     String?
  meeting_link String?
  
  notes        String?  @db.Text
  feedback     String?  @db.Text
  rating       Float?
  
  created_at   DateTime @default(now())
  updated_at   DateTime @updatedAt

  @@index([provider_id])
  @@index([participant_id])
  @@index([status])
}

model Conversation {
  id           String   @id @default(cuid())
  user_id      String
  user         Profile  @relation(fields: [user_id], references: [id], onDelete: Cascade)
  other_user_id String
  last_message String?
  last_message_at DateTime?
  created_at   DateTime @default(now())
  updated_at   DateTime @updatedAt

  @@unique([user_id, other_user_id])
  @@index([user_id])
}

model Message {
  id           String   @id @default(cuid())
  sender_id    String
  sender       Profile  @relation("sender", fields: [sender_id], references: [id], onDelete: Cascade)
  receiver_id  String
  receiver     Profile  @relation("receiver", fields: [receiver_id], references: [id], onDelete: Cascade)
  content      String   @db.Text
  is_read      Boolean  @default(false)
  read_at      DateTime?
  created_at   DateTime @default(now())

  @@index([sender_id])
  @@index([receiver_id])
}

model Review {
  id           String   @id @default(cuid())
  author_id    String
  author       Profile  @relation("reviews_authored", fields: [author_id], references: [id], onDelete: Cascade)
  target_user_id String
  target_user    Profile  @relation("reviews_received", fields: [target_user_id], references: [id], onDelete: Cascade)
  trade_id     String?
  listing_id   String?
  rating       Int
  comment      String   @db.Text
  created_at   DateTime @default(now())
  updated_at   DateTime @updatedAt

  @@index([author_id])
  @@index([target_user_id])
}

================================================
FILE: D:\barter_verse\backend\src\app.ts
================================================
import express from 'express';
import cors from 'cors';
import morgan from 'morgan';
import cookieParser from 'cookie-parser';
import helmet from 'helmet';
import { errorHandler } from './middleware/error.middleware';

import authRoutes from './routes/auth.routes';
import tradesRoutes from './routes/trades.routes';
import coinsRoutes from './routes/coins.routes';
import adminRoutes from './routes/admin.routes';
import listingsRoutes from './routes/listings.routes';
import privacyRoutes from './routes/privacy.routes';
import locationRoutes from './routes/location.routes';
import sessionsRoutes from './routes/sessions.routes';
import chatRoutes from './routes/chat.routes';
import reviewsRoutes from './routes/reviews.routes';

export const app = express();

// Security middleware
app.use(helmet());

// CORS Configuration
const corsOrigins = process.env.CORS_ORIGINS
  ? process.env.CORS_ORIGINS.split(',').map(origin => origin.trim())
  : ['http://localhost:5173', 'http://localhost:8080', 'http://localhost:8081', 'http://localhost:8082', 'http://127.0.0.1:5173', 'http://127.0.0.1:8080', 'http://127.0.0.1:8081', 'http://127.0.0.1:8082'];

app.use(
  cors({
    origin: corsOrigins,
    credentials: true,
  })
);

app.use(express.json());
app.use(cookieParser());
app.use(morgan(process.env.NODE_ENV === 'production' ? 'combined' : 'dev'));

app.get('/api/health', (_req, res) => {
  res.json({ ok: true });
});

app.use('/api/auth', authRoutes);
app.use('/api/trades', tradesRoutes);
app.use('/api/coins', coinsRoutes);
app.use('/api/listings', listingsRoutes);
app.use('/api/admin', adminRoutes);
app.use('/api/privacy', privacyRoutes);
app.use('/api/location', locationRoutes);
app.use('/api/sessions', sessionsRoutes);
app.use('/api/chat', chatRoutes);
app.use('/api/reviews', reviewsRoutes);

app.use(errorHandler);


================================================
FILE: D:\barter_verse\backend\src\controllers\admin.controller.ts
================================================
import { Request, Response, NextFunction } from 'express';
import { prisma } from '../prisma/client';

export const listUsers = async (_req: Request, res: Response, next: NextFunction) => {
  try {
    const users = await prisma.profile.findMany({
      select: {
        id: true,
        email: true,
        username: true,
        coins: true,
        rating: true,
        role: true,
        created_at: true,
      },
      orderBy: { created_at: 'desc' },
    });

    res.json(users);
  } catch (err) {
    next(err);
  }
};

export const setUserRole = async (req: Request, res: Response, next: NextFunction) => {
  try {
    const { userId, role } = req.body;

    if (!userId || !role) {
      return res.status(400).json({ message: 'userId and role required' });
    }

    const updated = await prisma.profile.update({
      where: { id: userId },
      data: { role },
    });

    res.json(updated);
  } catch (err) {
    next(err);
  }
};

// Admin: Add coins to a user
export const adminAddCoins = async (req: Request, res: Response, next: NextFunction) => {
  try {
    const { userId, amount, reason } = req.body;

    if (!userId || !amount) {
      return res.status(400).json({ message: 'userId and amount required' });
    }

    const user = await prisma.profile.findUnique({
      where: { id: userId },
    });

    if (!user) {
      return res.status(404).json({ message: 'User not found' });
    }

    const newBalance = user.coins + Number(amount);

    const updated = await prisma.profile.update({
      where: { id: userId },
      data: { coins: newBalance },
    });

    // Log transaction
    const transaction = await prisma.coinTransaction.create({
      data: {
        user_id: userId,
        amount: Number(amount),
        reason: reason || 'admin_added',
      },
    });

    res.json({
      data: {
        user: {
          id: updated.id,
          email: updated.email,
          username: updated.username,
          coins: updated.coins,
        },
        transaction,
        new_balance: newBalance,
      },
    });
  } catch (err) {
    next(err);
  }
};

// Admin: Deduct coins from a user
export const adminDeductCoins = async (req: Request, res: Response, next: NextFunction) => {
  try {
    const { userId, amount, reason } = req.body;

    if (!userId || !amount) {
      return res.status(400).json({ message: 'userId and amount required' });
    }

    const user = await prisma.profile.findUnique({
      where: { id: userId },
    });

    if (!user) {
      return res.status(404).json({ message: 'User not found' });
    }

    const deductAmount = Number(amount);
    if (user.coins < deductAmount) {
      return res.status(400).json({ message: 'Insufficient coins' });
    }

    const newBalance = user.coins - deductAmount;

    const updated = await prisma.profile.update({
      where: { id: userId },
      data: { coins: newBalance },
    });

    // Log transaction
    const transaction = await prisma.coinTransaction.create({
      data: {
        user_id: userId,
        amount: -deductAmount,
        reason: reason || 'admin_deducted',
      },
    });

    res.json({
      data: {
        user: {
          id: updated.id,
          email: updated.email,
          username: updated.username,
          coins: updated.coins,
        },
        transaction,
        new_balance: newBalance,
      },
    });
  } catch (err) {
    next(err);
  }
};

// Admin: Get all coin transactions (with user info)
export const getCoinTransactions = async (req: Request, res: Response, next: NextFunction) => {
  try {
    const limit = Number(req.query.limit) || 50;
    const offset = Number(req.query.offset) || 0;

    const transactions = await prisma.coinTransaction.findMany({
      include: {
        user: {
          select: {
            id: true,
            email: true,
            username: true,
          },
        },
      },
      orderBy: { created_at: 'desc' },
      take: limit,
      skip: offset,
    });

    const total = await prisma.coinTransaction.count();

    res.json({
      data: transactions,
      pagination: {
        limit,
        offset,
        total,
      },
    });
  } catch (err) {
    next(err);
  }
};

// Admin: Get transaction history for a specific user
export const getUserTransactions = async (req: Request, res: Response, next: NextFunction) => {
  try {
    const { userId } = req.params;
    const limit = Number(req.query.limit) || 50;
    const offset = Number(req.query.offset) || 0;

    const user = await prisma.profile.findUnique({
      where: { id: userId },
    });

    if (!user) {
      return res.status(404).json({ message: 'User not found' });
    }

    const transactions = await prisma.coinTransaction.findMany({
      where: { user_id: userId },
      orderBy: { created_at: 'desc' },
      take: limit,
      skip: offset,
    });

    const total = await prisma.coinTransaction.count({
      where: { user_id: userId },
    });

    res.json({
      data: {
        user: {
          id: user.id,
          email: user.email,
          username: user.username,
          coins: user.coins,
        },
        transactions,
        pagination: {
          limit,
          offset,
          total,
        },
      },
    });
  } catch (err) {
    next(err);
  }
};


================================================
FILE: D:\barter_verse\backend\src\controllers\auth.controller.ts
================================================
import { Request, Response } from 'express';
import bcrypt from 'bcryptjs';
import jwt from 'jsonwebtoken';
import { prisma } from '../prisma/client';

const buildUserPayload = (user: any) => ({
  id: user.id,
  email: user.email,
  username: user.username,
  avatar_url: user.avatar_url,
  bio: user.bio,
  coins: user.coins,
  rating: user.rating,
  role: user.role,
});

export const signup = async (req: Request, res: Response) => {
  try {
    const { email, username, password } = req.body;

    if (!email || !password) {
      return res.status(400).json({ message: 'Email and password are required' });
    }

    // If frontend did not provide a username, derive one from the email
    let finalUsername = username;
    if (!finalUsername) {
      const base = email.split('@')[0].replace(/[^a-zA-Z0-9_-]/g, '').toLowerCase() || 'user';
      finalUsername = base;
      
      // Ensure uniqueness by appending timestamp if needed
      let i = 0;
      while (i < 100) { // Limit to 100 attempts
        const existing = await prisma.profile.findUnique({ where: { username: finalUsername } });
        if (!existing) break; // Username is free, use it
        i += 1;
        finalUsername = `${base}${i}`;
      }
      
      // If still colliding after 100 attempts, add random suffix
      if (i >= 100) {
        finalUsername = `${base}_${Date.now()}`;
      }
    }

    const existingEmail = await prisma.profile.findUnique({ where: { email } });
    if (existingEmail) {
      return res.status(409).json({ message: 'Email already in use' });
    }

    const hashed = await bcrypt.hash(password, 10);

    const user = await prisma.profile.create({
      data: {
        email,
        username: finalUsername,
        password: hashed,
      },
    });

    const token = jwt.sign({ id: user.id, role: user.role }, process.env.JWT_SECRET as string, { expiresIn: '7d' });

    res.status(201).json({ data: { token, user: buildUserPayload(user) } });
  } catch (err: any) {
    console.error('signup error:', err);
    res.status(500).json({ message: 'Signup failed' });
  }
};

export const login = async (req: Request, res: Response) => {
  try {
    // Support both `{ emailOrUsername, password }` and `{ email, password }` payloads
    const { emailOrUsername, email, username, password } = req.body;
    const identifier = emailOrUsername ?? email ?? username;

    if (!identifier || !password) {
      return res.status(400).json({ message: 'Email/username and password are required' });
    }

    const user = await prisma.profile.findFirst({ where: { OR: [{ email: identifier }, { username: identifier }] } });

    if (!user) {
      return res.status(404).json({ message: 'User not found' });
    }

    const ok = await bcrypt.compare(password, user.password);
    if (!ok) {
      return res.status(401).json({ message: 'Invalid credentials' });
    }

    const token = jwt.sign({ id: user.id, role: user.role }, process.env.JWT_SECRET as string, { expiresIn: '7d' });

    res.json({ data: { token, user: buildUserPayload(user) } });
  } catch (err) {
    console.error('login error:', err);
    res.status(500).json({ message: 'Login failed' });
  }
};

export const me = async (req: Request, res: Response) => {
  try {
    const authHeader = req.headers.authorization;
    const token = authHeader?.startsWith('Bearer ')
      ? authHeader.slice(7)
      : undefined;

    if (!token) {
      return res.status(401).json({ message: 'Not authenticated' });
    }

    const decoded = jwt.verify(
      token,
      process.env.JWT_SECRET as string
    ) as { id: string; role: string };

    const user = await prisma.profile.findUnique({
      where: { id: decoded.id },
    });

    if (!user) {
      return res.status(404).json({ message: 'User not found' });
    }

    res.json({ data: { user: buildUserPayload(user) } });
  } catch (err) {
    console.error('me error:', err);
    res.status(401).json({ message: 'Invalid token' });
  }
};

export const updateProfile = async (req: Request, res: Response) => {
  try {
    console.log('updateProfile called');
    console.log('req.userId:', (req as any).userId);
    console.log('req.user:', (req as any).user);
    console.log('req.headers.authorization:', req.headers.authorization);
    
    const userId = (req as any).userId || (req as any).user?.id;
    
    if (!userId) {
      console.error('No userId found in request');
      return res.status(401).json({ message: 'Not authenticated' });
    }

    const { display_name, bio, avatar_url } = req.body;

    const updateData: any = {};
    if (display_name) {
      updateData.username = display_name;
      updateData.display_name = display_name;
    }
    if (bio !== undefined) {
      updateData.bio = bio;
    }
    if (avatar_url) {
      updateData.avatar_url = avatar_url;
    }

    console.log('Updating user', userId, 'with data:', Object.keys(updateData));

    const user = await prisma.profile.update({
      where: { id: userId },
      data: updateData,
    });

    res.json({ 
      success: true,
      data: { user: buildUserPayload(user) }
    });
  } catch (err: any) {
    console.error('updateProfile error:', err);
    res.status(500).json({ success: false, message: 'Failed to update profile' });
  }
};


================================================
FILE: D:\barter_verse\backend\src\controllers\coins.controller.ts
================================================
import { Response, NextFunction } from 'express';
import { AuthRequest } from '../types';
import { prisma } from '../prisma/client';
import { CoinsService } from '../services/coins.service';

const coinsService = new CoinsService();

export const getMyCoins = async (
  req: AuthRequest,
  res: Response,
  next: NextFunction
) => {
  try {
    if (!req.user) return res.status(401).json({ message: 'Unauthenticated' });

    const user = await prisma.profile.findUnique({
      where: { id: req.user.id },
      select: { coins: true },
    });

    res.json({ coins: user?.coins ?? 0 });
  } catch (err) {
    next(err);
  }
};

export const getMyCoinTransactions = async (
  req: AuthRequest,
  res: Response,
  next: NextFunction
) => {
  try {
    if (!req.user) return res.status(401).json({ message: 'Unauthenticated' });

    const txs = await prisma.coinTransaction.findMany({
      where: { user_id: req.user.id },
      orderBy: { created_at: 'desc' },
    });

    res.json(txs);
  } catch (err) {
    next(err);
  }
};

// Add coins to the current authenticated user
export const addCoins = async (
  req: AuthRequest,
  res: Response,
  next: NextFunction
) => {
  try {
    if (!req.user) return res.status(401).json({ message: 'Unauthenticated' });

    const { amount, reason } = req.body;
    const result = await coinsService.addCoins(req.user.id, Number(amount), reason || 'manual');

    res.json({ data: { new_balance: result.balance, transaction: result.transaction } });
  } catch (err) {
    next(err);
  }
};

// Spend coins for the current authenticated user
export const spendCoins = async (
  req: AuthRequest,
  res: Response,
  next: NextFunction
) => {
  try {
    if (!req.user) return res.status(401).json({ message: 'Unauthenticated' });

    const { amount, reason } = req.body;
    const result = await coinsService.spendCoins(req.user.id, Number(amount), reason || 'spend');

    res.json({ data: { new_balance: result.balance, transaction: result.transaction } });
  } catch (err) {
    next(err);
  }
};

// Transfer coins from authenticated user to another user
export const transferCoins = async (
  req: AuthRequest,
  res: Response,
  next: NextFunction
) => {
  try {
    if (!req.user) return res.status(401).json({ message: 'Unauthenticated' });

    const { toUserId, amount } = req.body;
    const result = await coinsService.transferCoins(req.user.id, toUserId, Number(amount), 'transfer');

    res.json({ data: result });
  } catch (err) {
    next(err);
  }
};


================================================
FILE: D:\barter_verse\backend\src\controllers\listings.controller.ts
================================================
import { Request, Response, NextFunction } from "express";
import {
  ListingsService,
  createListingSchema,
  updateListingSchema,
} from "../services/listings.service";
import { AppError } from "../middleware/error.middleware";
import { ApiResponse } from "../types/index";

const listingsService = new ListingsService();

export class ListingsController {
  async createListing(req: Request, res: Response, next: NextFunction) {
    try {
      const userId = req.userId;
      if (!userId) {
        throw new AppError(401, "User ID is required");
      }

      const validatedData = createListingSchema.parse(req.body);
      const listing = await listingsService.createListing(userId, validatedData);

      res.status(201).json({
        success: true,
        data: listing,
        message: "Listing created successfully",
      } as ApiResponse<typeof listing>);
    } catch (error) {
      next(error);
    }
  }

  async getListings(req: Request, res: Response, next: NextFunction) {
    try {
      const page = parseInt(req.query.page as string) || 1;
      const limit = parseInt(req.query.limit as string) || 10;
      const category = req.query.category as string | undefined;
      const search = req.query.search as string | undefined;

      const { listings, total } = await listingsService.getListings(
        page,
        limit,
        category,
        search
      );

      res.status(200).json({
        success: true,
        data: {
          listings,
          pagination: {
            page,
            limit,
            total,
            pages: Math.ceil(total / limit),
          },
        },
      });
    } catch (error) {
      next(error);
    }
  }

  async getListingById(req: Request, res: Response, next: NextFunction) {
    try {
      const { id } = req.params;
      const listing = await listingsService.getListingById(id);

      res.status(200).json({
        success: true,
        data: listing,
      } as ApiResponse<typeof listing>);
    } catch (error) {
      next(error);
    }
  }

  async getUserListings(req: Request, res: Response, next: NextFunction) {
    try {
      const userId = req.userId;
      if (!userId) {
        throw new AppError(401, "User ID is required");
      }

      const listings = await listingsService.getUserListings(userId);

      res.status(200).json({
        success: true,
        data: listings,
      } as ApiResponse<typeof listings>);
    } catch (error) {
      next(error);
    }
  }

  async updateListing(req: Request, res: Response, next: NextFunction) {
    try {
      const userId = req.userId;
      if (!userId) {
        throw new AppError(401, "User ID is required");
      }

      const { id } = req.params;
      const validatedData = updateListingSchema.parse(req.body);
      const listing = await listingsService.updateListing(id, userId, validatedData);

      res.status(200).json({
        success: true,
        data: listing,
        message: "Listing updated successfully",
      } as ApiResponse<typeof listing>);
    } catch (error) {
      next(error);
    }
  }

  async deleteListing(req: Request, res: Response, next: NextFunction) {
    try {
      const userId = req.userId;
      if (!userId) {
        throw new AppError(401, "User ID is required");
      }

      const { id } = req.params;
      await listingsService.deleteListing(id, userId);

      res.status(200).json({
        success: true,
        message: "Listing deleted successfully",
      });
    } catch (error) {
      next(error);
    }
  }

  async archiveListing(req: Request, res: Response, next: NextFunction) {
    try {
      const userId = req.userId;
      if (!userId) {
        throw new AppError(401, "User ID is required");
      }

      const { id } = req.params;
      const listing = await listingsService.archiveListing(id, userId);

      res.status(200).json({
        success: true,
        data: listing,
        message: "Listing archived successfully",
      } as ApiResponse<typeof listing>);
    } catch (error) {
      next(error);
    }
  }
}

export const listingsController = new ListingsController();


================================================
FILE: D:\barter_verse\backend\src\controllers\reviews.controller.ts
================================================
import { Response, NextFunction } from 'express';
import { AuthRequest } from '../types';
import { prisma } from '../prisma/client';

export const createReview = async (
  req: AuthRequest,
  res: Response,
  next: NextFunction
) => {
  try {
    if (!req.user) {
      return res.status(401).json({ message: 'Unauthenticated' });
    }

    const {
      target_user_id,
      trade_id,
      listing_id,
      rating,
      comment,
    } = req.body;

    // Validate required fields
    if (!target_user_id || !rating || !comment) {
      return res.status(400).json({
        message: 'target_user_id, rating, and comment are required',
      });
    }

    // Validate rating is between 1-5
    if (rating < 1 || rating > 5) {
      return res.status(400).json({
        message: 'Rating must be between 1 and 5',
      });
    }

    // Cannot review yourself
    if (target_user_id === req.user.id) {
      return res.status(400).json({
        message: 'You cannot review yourself',
      });
    }

    // Check if target user exists
    const targetUser = await prisma.profile.findUnique({
      where: { id: target_user_id },
    });

    if (!targetUser) {
      return res.status(404).json({ message: 'Target user not found' });
    }

    // Create review
    const review = await prisma.review.create({
      data: {
        author_id: req.user.id,
        target_user_id,
        trade_id,
        listing_id,
        rating,
        comment,
      },
      include: {
        author: { select: { id: true, username: true, avatar_url: true } },
        target_user: { select: { id: true, username: true, avatar_url: true, rating: true } },
      },
    });

    // Update target user's rating (average of all reviews)
    const reviews = await prisma.review.findMany({
      where: { target_user_id },
    });

    const averageRating = reviews.length > 0 
      ? reviews.reduce((sum: number, r: any) => sum + r.rating, 0) / reviews.length 
      : 5.0;

    await prisma.profile.update({
      where: { id: target_user_id },
      data: { rating: averageRating },
    });

    res.status(201).json({ data: review });
  } catch (err) {
    next(err);
  }
};

export const getReviews = async (
  req: AuthRequest,
  res: Response,
  next: NextFunction
) => {
  try {
    const { target_user_id } = req.params;

    const reviews = await prisma.review.findMany({
      where: { target_user_id },
      include: {
        author: { select: { id: true, username: true, avatar_url: true } },
      },
      orderBy: { created_at: 'desc' },
    });

    res.json({ data: reviews });
  } catch (err) {
    next(err);
  }
};

export const getUserReviewsGiven = async (
  req: AuthRequest,
  res: Response,
  next: NextFunction
) => {
  try {
    if (!req.user) {
      return res.status(401).json({ message: 'Unauthenticated' });
    }

    const reviews = await prisma.review.findMany({
      where: { author_id: req.user.id },
      include: {
        target_user: { select: { id: true, username: true, avatar_url: true } },
      },
      orderBy: { created_at: 'desc' },
    });

    res.json({ data: reviews });
  } catch (err) {
    next(err);
  }
};

export const deleteReview = async (
  req: AuthRequest,
  res: Response,
  next: NextFunction
) => {
  try {
    if (!req.user) {
      return res.status(401).json({ message: 'Unauthenticated' });
    }

    const { id } = req.params;

    const review = await prisma.review.findUnique({ where: { id } });

    if (!review) {
      return res.status(404).json({ message: 'Review not found' });
    }

    // Only author can delete
    if (review.author_id !== req.user.id) {
      return res.status(403).json({ message: 'You cannot delete this review' });
    }

    await prisma.review.delete({ where: { id } });

    // Recalculate target user's rating
    const reviews = await prisma.review.findMany({
      where: { target_user_id: review.target_user_id },
    });

    const averageRating =
      reviews.length > 0 ? reviews.reduce((sum: number, r: any) => sum + r.rating, 0) / reviews.length : 5.0;

    await prisma.profile.update({
      where: { id: review.target_user_id },
      data: { rating: averageRating },
    });

    res.json({ message: 'Review deleted successfully' });
  } catch (err) {
    next(err);
  }
};


================================================
FILE: D:\barter_verse\backend\src\controllers\trades.controller.ts
================================================
import { Response, NextFunction } from 'express';
import { AuthRequest } from '../types';
import { prisma } from '../prisma/client';

export const getMyTrades = async (
  req: AuthRequest,
  res: Response,
  next: NextFunction
) => {
  try {
    if (!req.user) return res.status(401).json({ message: 'Unauthenticated' });

    const trades = await prisma.trade.findMany({
      where: {
        OR: [
          { initiator_id: req.user.id },
          { responder_id: req.user.id },
        ],
      },
      include: {
        initiator: { select: { id: true, username: true, avatar_url: true } },
        responder: { select: { id: true, username: true, avatar_url: true } },
        listing: {
          select: {
            id: true,
            title: true,
            category: true,
            images: true, // Fixed: select 'images', not 'image_url'
            price_bc: true,
          },
        },
      },
      orderBy: { created_at: 'desc' },
    });

    res.json({ data: trades });
  } catch (err) {
    next(err);
  }
};

export const getTradeById = async (
  req: AuthRequest,
  res: Response,
  next: NextFunction
) => {
  try {
    if (!req.user) return res.status(401).json({ message: 'Unauthenticated' });

    const { id } = req.params;
    const trade = await prisma.trade.findUnique({
      where: { id },
      include: {
        initiator: { select: { id: true, username: true } },
        responder: { select: { id: true, username: true } },
        listing: { select: { id: true, title: true } },
      },
    });

    if (!trade) return res.status(404).json({ message: 'Trade not found' });

    res.json({ data: trade });
  } catch (err) {
    next(err);
  }
};

// 1. CREATE: Deduct coins immediately (Escrow Lock)
export const createTrade = async (
  req: AuthRequest,
  res: Response,
  next: NextFunction
) => {
  try {
    if (!req.user) return res.status(401).json({ message: 'Unauthenticated' });

    const {
      responder_id, responderUserId,
      listing_id, listingId,
      proposed_listing_id,
      coin_amount, proposedCoins,
      message,
    } = req.body;

    const finalResponderId = responder_id || responderUserId;
    const finalListingId = listing_id || listingId;
    const coinAmount = Number(coin_amount || proposedCoins || 0);

    if (!finalResponderId || !finalListingId) {
      return res.status(400).json({ message: 'responder_id and listing_id are required' });
    }

    const result = await prisma.$transaction(async (tx) => {
      // 1. Check Balance
      const initiator = await tx.profile.findUnique({ where: { id: req.user!.id } });
      if (!initiator || initiator.coins < coinAmount) {
        throw new Error('Insufficient coins for this trade offer');
      }

      // 2. Create Trade
      const trade = await tx.trade.create({
        data: {
          initiator_id: req.user!.id,
          responder_id: finalResponderId,
          listing_id: finalListingId,
          proposed_listing_id,
          coin_amount: coinAmount,
          message,
          status: 'PENDING',
        },
        include: {
            initiator: { select: { id: true, username: true } },
            responder: { select: { id: true, username: true } },
            listing: { select: { id: true, title: true } },
        }
      });

      // 3. Deduct Coins (Lock in Escrow)
      if (coinAmount > 0) {
        await tx.profile.update({
          where: { id: req.user!.id },
          data: { coins: { decrement: coinAmount } },
        });

        await tx.coinTransaction.create({
          data: {
            user_id: req.user!.id,
            amount: -coinAmount,
            reason: `Escrow Lock: Trade Offer for ${finalListingId}`,
          },
        });
      }

      return trade;
    });

    res.status(201).json({ data: result });
  } catch (err: any) {
    if (err.message === 'Insufficient coins for this trade offer') {
        return res.status(400).json({ message: err.message });
    }
    next(err);
  }
};

// 2. CONFIRM: Accept (Lock) or Reject (Refund)
export const confirmTrade = async (
  req: AuthRequest,
  res: Response,
  next: NextFunction
) => {
  try {
    if (!req.user) return res.status(401).json({ message: 'Unauthenticated' });

    const { id } = req.params;
    const { action } = req.body;

    const trade = await prisma.trade.findUnique({ where: { id } });
    if (!trade) return res.status(404).json({ message: 'Trade not found' });

    if (trade.responder_id !== req.user.id) {
      return res.status(403).json({ message: 'Only the seller can confirm this trade' });
    }

    if (trade.status !== 'PENDING') {
      return res.status(400).json({ message: 'Trade is not pending' });
    }

    const result = await prisma.$transaction(async (tx) => {
        let status = '';
        if (action === 'accept') {
            status = 'ESCROW_LOCKED';
            await tx.trade.update({ where: { id }, data: { status: 'ESCROW_LOCKED' } }); // Use string literal to satisfy Enum
        } else {
            status = 'REJECTED';
            await tx.trade.update({ where: { id }, data: { status: 'REJECTED' } });

            if (trade.coin_amount > 0) {
                await tx.profile.update({
                    where: { id: trade.initiator_id },
                    data: { coins: { increment: trade.coin_amount } }
                });
                await tx.coinTransaction.create({
                    data: {
                        user_id: trade.initiator_id,
                        amount: trade.coin_amount,
                        reason: `Refund: Trade Rejected by Seller (${trade.id})`
                    }
                });
            }
        }
        return { status };
    });

    res.json({ message: `Trade ${action}ed successfully`, data: result });
  } catch (err) {
    next(err);
  }
};

// 3. CONFIRM DELIVERY
export const confirmDelivery = async (
    req: AuthRequest,
    res: Response,
    next: NextFunction
  ) => {
    try {
      if (!req.user) return res.status(401).json({ message: 'Unauthenticated' });
      const { id } = req.params;
  
      const trade = await prisma.trade.findUnique({ where: { id } });
      if (!trade) return res.status(404).json({ message: 'Trade not found' });
  
      if (trade.responder_id !== req.user.id) {
        return res.status(403).json({ message: 'Only the seller can confirm delivery' });
      }
  
      const updated = await prisma.trade.update({
        where: { id },
        data: { status: 'DELIVERED' }, // Use string literal
      });
  
      res.json({ data: updated });
    } catch (err) {
      next(err);
    }
};

// 4. COMPLETE TRADE
export const completeTrade = async (
  req: AuthRequest,
  res: Response,
  next: NextFunction
) => {
  try {
    if (!req.user) return res.status(401).json({ message: 'Unauthenticated' });

    const { id } = req.params;
    const trade = await prisma.trade.findUnique({ where: { id } });
    if (!trade) return res.status(404).json({ message: 'Trade not found' });

    if (trade.initiator_id !== req.user.id) {
      return res.status(403).json({ message: 'Only the buyer can release funds' });
    }

    if (trade.status === 'COMPLETED') {
        return res.status(400).json({ message: 'Trade already completed' });
    }

    const result = await prisma.$transaction(async (tx) => {
        const updatedTrade = await tx.trade.update({
            where: { id },
            data: { status: 'COMPLETED' },
            include: { initiator: true, responder: true }
        });

        if (trade.coin_amount > 0) {
            await tx.profile.update({
                where: { id: trade.responder_id },
                data: { coins: { increment: trade.coin_amount } },
            });
            await tx.coinTransaction.create({
                data: {
                    user_id: trade.responder_id,
                    amount: trade.coin_amount,
                    reason: `Payment: Trade Completed (${trade.id})`,
                },
            });
        }
        return updatedTrade;
    });

    res.json({ data: result });
  } catch (err) {
    next(err);
  }
};

// 5. CANCEL TRADE
export const cancelTrade = async (
  req: AuthRequest,
  res: Response,
  next: NextFunction
) => {
  try {
    if (!req.user) return res.status(401).json({ message: 'Unauthenticated' });

    const { id } = req.params;
    const trade = await prisma.trade.findUnique({ where: { id } });
    if (!trade) return res.status(404).json({ message: 'Trade not found' });

    if (trade.status !== 'PENDING') {
        return res.status(400).json({ message: 'Cannot cancel active trade. Use dispute.' });
    }

    if (trade.initiator_id !== req.user.id) {
        return res.status(403).json({ message: 'Only the initiator can cancel this offer' });
    }

    const result = await prisma.$transaction(async (tx) => {
        await tx.trade.update({
            where: { id },
            data: { status: 'CANCELLED' } 
        });

        if (trade.coin_amount > 0) {
            await tx.profile.update({
                where: { id: trade.initiator_id },
                data: { coins: { increment: trade.coin_amount } }
            });
            await tx.coinTransaction.create({
                data: {
                    user_id: trade.initiator_id,
                    amount: trade.coin_amount,
                    reason: `Refund: Trade Cancelled (${trade.id})`
                }
            });
        }
        return { message: 'Trade cancelled and funds refunded' };
    });

    res.json({ data: result });
  } catch (err) {
    next(err);
  }
};

================================================
FILE: D:\barter_verse\backend\src\middleware\auth.middleware.ts
================================================
import { Response, NextFunction } from 'express';
import jwt from 'jsonwebtoken';
import { prisma } from '../prisma/client';
import { AuthRequest, JwtPayload } from '../types';

export const authRequired = async (
  req: AuthRequest,
  res: Response,
  next: NextFunction
) => {
  const header = req.headers.authorization;
  const token = header?.startsWith('Bearer ')
    ? header.slice(7)
    : undefined;

  if (!token) {
    return res.status(401).json({ message: 'Not authenticated' });
  }

  try {
    const secret = process.env.JWT_SECRET;
    if (!secret) {
      throw new Error('Missing JWT_SECRET');
    }

    const decoded = jwt.verify(token, secret) as JwtPayload;

    const user = await prisma.profile.findUnique({
      where: { id: decoded.id },
    });

    if (!user) {
      return res.status(401).json({ message: 'User not found' });
    }

    req.user = user;
    // convenience properties used across controllers
    req.userId = user.id;
    req.userRole = user.role;
    next();
  } catch (err) {
    console.error('authRequired error:', err);
    res.status(401).json({ message: 'Invalid or expired token' });
  }
};

export const adminOnly = (req: AuthRequest, res: Response, next: NextFunction) => {
  if (!req.user || req.user.role !== 'admin') {
    return res.status(403).json({ message: 'Admin only' });
  }
  next();
};

// Alias for backwards compatibility
export const verifyToken = authRequired;


================================================
FILE: D:\barter_verse\backend\src\middleware\error.middleware.ts
================================================
import { Request, Response, NextFunction } from 'express';

export class AppError extends Error {
  statusCode: number;
  constructor(statusCode: number, message: string) {
    super(message);
    this.statusCode = statusCode;
    Object.setPrototypeOf(this, AppError.prototype);
  }
}

export const errorHandler = (
  err: any,
  _req: Request,
  res: Response,
  _next: NextFunction
) => {
  console.error('Error:', err);
  const status = err.statusCode || err.status || 500;
  res.status(status).json({
    message: err.message || 'Internal server error',
  });
};


================================================
FILE: D:\barter_verse\backend\src\prisma\client.ts
================================================
import { PrismaClient } from "@prisma/client";

const prismaClientSingleton = () => {
  return new PrismaClient();
};

type PrismaClientSingleton = ReturnType<typeof prismaClientSingleton>;

const globalForPrisma = globalThis as unknown as {
  prisma: PrismaClientSingleton | undefined;
};

export const prisma =
  globalForPrisma.prisma ??
  prismaClientSingleton();

if (process.env.NODE_ENV !== "production") {
  globalForPrisma.prisma = prisma;
}


================================================
FILE: D:\barter_verse\backend\src\routes\admin.routes.ts
================================================
import { Router } from 'express';
import { authRequired, adminOnly } from '../middleware/auth.middleware';
import {
  listUsers,
  setUserRole,
  adminAddCoins,
  adminDeductCoins,
  getCoinTransactions,
  getUserTransactions,
} from '../controllers/admin.controller';

const router = Router();

// User management
router.get('/users', authRequired, adminOnly, listUsers);
router.post('/users/role', authRequired, adminOnly, setUserRole);

// Coin management
router.post('/coins/add', authRequired, adminOnly, adminAddCoins);
router.post('/coins/deduct', authRequired, adminOnly, adminDeductCoins);

// Transaction history
router.get('/transactions', authRequired, adminOnly, getCoinTransactions);
router.get('/users/:userId/transactions', authRequired, adminOnly, getUserTransactions);

export default router;


================================================
FILE: D:\barter_verse\backend\src\routes\auth.routes.ts
================================================
import { Router } from 'express';
import { signup, login, me, updateProfile } from '../controllers/auth.controller';
import { authRequired } from '../middleware/auth.middleware';

const router = Router();

router.post('/signup', signup);
router.post('/login', login);
router.post('/signin', login); // alias for frontend that uses "signin"
router.get('/me', me);
router.patch('/profile', authRequired, updateProfile);

export default router;


================================================
FILE: D:\barter_verse\backend\src\routes\chat.routes.ts
================================================
import { Router, Request, Response } from 'express';
import { PrismaClient } from '@prisma/client';
import { verifyToken } from '../middleware/auth.middleware';

const router = Router();
const prisma = new PrismaClient();

// Send a message
router.post('/send', verifyToken, async (req: any, res: Response) => {
  try {
    const senderId = req.user.id;
    const { receiver_id, content } = req.body;

    if (!receiver_id || !content) {
      return res.status(400).json({
        success: false,
        message: 'Missing required fields: receiver_id, content',
      });
    }

    if (senderId === receiver_id) {
      return res.status(400).json({
        success: false,
        message: 'Cannot send message to yourself',
      });
    }

    // Verify receiver exists
    const receiver = await prisma.profile.findUnique({
      where: { id: receiver_id },
    });

    if (!receiver) {
      return res.status(404).json({
        success: false,
        message: 'Receiver not found',
      });
    }

    // Create message
    const message = await prisma.message.create({
      data: {
        sender_id: senderId,
        receiver_id,
        content,
      },
      include: {
        sender: { select: { id: true, username: true, avatar_url: true } },
        receiver: { select: { id: true, username: true, avatar_url: true } },
      },
    });

    // Update or create conversation
    await prisma.conversation.upsert({
      where: {
        user_id_other_user_id: {
          user_id: senderId,
          other_user_id: receiver_id,
        },
      },
      update: {
        last_message: content,
        last_message_at: new Date(),
      },
      create: {
        user_id: senderId,
        other_user_id: receiver_id,
        last_message: content,
        last_message_at: new Date(),
      },
    });

    res.status(201).json({
      success: true,
      message: 'Message sent successfully',
      data: message,
    });
  } catch (error: any) {
    res.status(400).json({
      success: false,
      message: error.message,
    });
  }
});

// Get conversation with a user
router.get('/conversation/:user_id', verifyToken, async (req: any, res: Response) => {
  try {
    const currentUserId = req.user.id;
    const { user_id } = req.params;
    const limit = parseInt(req.query.limit) || 50;

    if (currentUserId === user_id) {
      return res.status(400).json({
        success: false,
        message: 'Cannot get conversation with yourself',
      });
    }

    // Get all messages between the two users
    const messages = await prisma.message.findMany({
      where: {
        OR: [
          { sender_id: currentUserId, receiver_id: user_id },
          { sender_id: user_id, receiver_id: currentUserId },
        ],
      },
      include: {
        sender: { select: { id: true, username: true, avatar_url: true } },
        receiver: { select: { id: true, username: true, avatar_url: true } },
      },
      orderBy: { created_at: 'desc' },
      take: limit,
    });

    // Mark messages as read
    await prisma.message.updateMany({
      where: {
        sender_id: user_id,
        receiver_id: currentUserId,
        is_read: false,
      },
      data: {
        is_read: true,
        read_at: new Date(),
      },
    });

    // Get the other user's info
    const otherUser = await prisma.profile.findUnique({
      where: { id: user_id },
      select: { id: true, username: true, avatar_url: true, rating: true, bio: true },
    });

    res.json({
      success: true,
      data: {
        messages: messages.reverse(),
        otherUser,
        total: messages.length,
      },
    });
  } catch (error: any) {
    res.status(400).json({
      success: false,
      message: error.message,
    });
  }
});

// Get all conversations for current user
router.get('/conversations', verifyToken, async (req: any, res: Response) => {
  try {
    const userId = req.user.id;

    // Get all conversations
    const conversations = await prisma.conversation.findMany({
      where: { user_id: userId },
      include: {
        user: { select: { id: true, username: true, avatar_url: true } },
      },
      orderBy: { last_message_at: 'desc' },
    });

    // Enrich with unread count
    const conversationsWithUnread = await Promise.all(
      conversations.map(async (conv) => {
        const unreadCount = await prisma.message.count({
          where: {
            sender_id: conv.other_user_id,
            receiver_id: userId,
            is_read: false,
          },
        });

        const otherUser = await prisma.profile.findUnique({
          where: { id: conv.other_user_id },
          select: { id: true, username: true, avatar_url: true },
        });

        return {
          ...conv,
          otherUser,
          unread_count: unreadCount,
        };
      })
    );

    res.json({
      success: true,
      data: conversationsWithUnread,
      total: conversationsWithUnread.length,
    });
  } catch (error: any) {
    res.status(400).json({
      success: false,
      message: error.message,
    });
  }
});

// Get unread messages count
router.get('/unread-count', verifyToken, async (req: any, res: Response) => {
  try {
    const userId = req.user.id;

    const unreadCount = await prisma.message.count({
      where: {
        receiver_id: userId,
        is_read: false,
      },
    });

    res.json({
      success: true,
      data: { unread_count: unreadCount },
    });
  } catch (error: any) {
    res.status(400).json({
      success: false,
      message: error.message,
    });
  }
});

// Mark message as read
router.put('/:message_id/read', verifyToken, async (req: any, res: Response) => {
  try {
    const { message_id } = req.params;

    const message = await prisma.message.findUnique({
      where: { id: message_id },
    });

    if (!message) {
      return res.status(404).json({
        success: false,
        message: 'Message not found',
      });
    }

    if (message.receiver_id !== req.user.id) {
      return res.status(403).json({
        success: false,
        message: 'Unauthorized to mark this message as read',
      });
    }

    const updatedMessage = await prisma.message.update({
      where: { id: message_id },
      data: {
        is_read: true,
        read_at: new Date(),
      },
    });

    res.json({
      success: true,
      message: 'Message marked as read',
      data: updatedMessage,
    });
  } catch (error: any) {
    res.status(400).json({
      success: false,
      message: error.message,
    });
  }
});

// Delete message (soft delete - just update is_deleted or hard delete)
router.delete('/:message_id', verifyToken, async (req: any, res: Response) => {
  try {
    const { message_id } = req.params;

    const message = await prisma.message.findUnique({
      where: { id: message_id },
    });

    if (!message) {
      return res.status(404).json({
        success: false,
        message: 'Message not found',
      });
    }

    // Only sender can delete their message
    if (message.sender_id !== req.user.id) {
      return res.status(403).json({
        success: false,
        message: 'Unauthorized to delete this message',
      });
    }

    await prisma.message.delete({
      where: { id: message_id },
    });

    res.json({
      success: true,
      message: 'Message deleted successfully',
    });
  } catch (error: any) {
    res.status(400).json({
      success: false,
      message: error.message,
    });
  }
});

export default router;


================================================
FILE: D:\barter_verse\backend\src\routes\coins.routes.ts
================================================
import { Router } from 'express';
import { authRequired } from '../middleware/auth.middleware';
import { getMyCoins, getMyCoinTransactions, addCoins, spendCoins, transferCoins } from '../controllers/coins.controller';

const router = Router();

router.get('/', authRequired, getMyCoins);
router.get('/transactions', authRequired, getMyCoinTransactions);

router.post('/add', authRequired, addCoins);
router.post('/spend', authRequired, spendCoins);
router.post('/transfer', authRequired, transferCoins);

export default router;


================================================
FILE: D:\barter_verse\backend\src\routes\listings.routes.ts
================================================
import { Router } from "express";
import { listingsController } from "../controllers/listings.controller";
import { authRequired } from "../middleware/auth.middleware";

const router = Router();

// Public routes
router.get("/", (req, res, next) => listingsController.getListings(req, res, next));
router.get("/:id", (req, res, next) => listingsController.getListingById(req, res, next));

// Protected routes
router.post("/", authRequired, (req, res, next) => listingsController.createListing(req, res, next));
router.get("/user/my-listings", authRequired, (req, res, next) => listingsController.getUserListings(req, res, next));
router.patch("/:id", authRequired, (req, res, next) => listingsController.updateListing(req, res, next));
router.delete("/:id", authRequired, (req, res, next) => listingsController.deleteListing(req, res, next));
router.post("/:id/archive", authRequired, (req, res, next) => listingsController.archiveListing(req, res, next));

export default router;


================================================
FILE: D:\barter_verse\backend\src\routes\location.routes.ts
================================================
import { Router, Request, Response } from 'express';
import { PrismaClient } from '@prisma/client';
import { verifyToken } from '../middleware/auth.middleware';
import { calculateDistance, findNearbyLocations, isValidCoordinate, geocodeLocation } from '../utils/location';

const router = Router();
const prisma = new PrismaClient();

// Update user location
router.put('/update-location', verifyToken, async (req: any, res: Response) => {
  try {
    const userId = req.user.id;
    const { latitude, longitude, city, town, state, country, pincode } = req.body;

    const updatedUser = await prisma.profile.update({
      where: { id: userId },
      data: {
        latitude: latitude || undefined,
        longitude: longitude || undefined,
        city: city || undefined,
        town: town || undefined,
        state: state || undefined,
        country: country || undefined,
        pincode: pincode || undefined,
      },
    });

    res.json({
      success: true,
      message: 'Location updated successfully',
      data: {
        id: updatedUser.id,
        latitude: updatedUser.latitude,
        longitude: updatedUser.longitude,
        city: updatedUser.city,
        town: updatedUser.town,
        state: updatedUser.state,
        country: updatedUser.country,
        pincode: updatedUser.pincode,
      },
    });
  } catch (error: any) {
    res.status(400).json({
      success: false,
      message: error.message,
    });
  }
});

// Find nearby traders (for skill sharing/trading)
router.get('/nearby-traders', verifyToken, async (req: any, res: Response) => {
  try {
    const userId = req.user.id;
    const radiusKm = parseInt(req.query.radius) || 50;
    const category = req.query.category;

    // Get current user's location
    const currentUser = await prisma.profile.findUnique({
      where: { id: userId },
    });

    if (!currentUser) {
      return res.status(400).json({
        success: false,
        message: 'User not found. Please set your location first.',
      });
    }

    // Filter by location details (city, state, country, pincode)
    let whereClause: any = {
      id: { not: userId },
    };

    // Match by pincode if available
    if (currentUser.pincode) {
      whereClause.pincode = currentUser.pincode;
    } 
    // Otherwise match by state and country
    else if (currentUser.state && currentUser.country) {
      whereClause.state = currentUser.state;
      whereClause.country = currentUser.country;
    }
    // Fall back to country and city
    else if (currentUser.country && currentUser.city) {
      whereClause.country = currentUser.country;
      whereClause.city = currentUser.city;
    }
    // Minimum: match by country
    else if (currentUser.country) {
      whereClause.country = currentUser.country;
    } else {
      return res.status(400).json({
        success: false,
        message: 'Please set your location (country/city/pincode) first.',
      });
    }

    // Find nearby users
    let users = await prisma.profile.findMany({
      where: whereClause,
      include: {
        listings: {
          where: category ? { category } : undefined,
          take: 5,
        },
      },
      take: 20,
    });

    res.json({
      success: true,
      data: users.map(user => ({
        id: user.id,
        username: user.username,
        rating: user.rating,
        avatar_url: user.avatar_url,
        city: user.city,
        town: user.town,
        state: user.state,
        country: user.country,
        pincode: user.pincode,
        listings: user.listings,
      })),
      total: users.length,
      matchType: currentUser.pincode ? 'pincode' : 'location',
    });
  } catch (error: any) {
    res.status(400).json({
      success: false,
      message: error.message,
    });
  }
});

// Find nearby listings
router.get('/nearby-listings', verifyToken, async (req: any, res: Response) => {
  try {
    const userId = req.user.id;
    const category = req.query.category;

    // Get current user's location
    const currentUser = await prisma.profile.findUnique({
      where: { id: userId },
    });

    if (!currentUser) {
      return res.status(400).json({
        success: false,
        message: 'User not found. Please set your location first.',
      });
    }

    // Build location filter for listings owners
    let ownerWhereClause: any = {};

    // Match by pincode if available
    if (currentUser.pincode) {
      ownerWhereClause.pincode = currentUser.pincode;
    } 
    // Otherwise match by state and country
    else if (currentUser.state && currentUser.country) {
      ownerWhereClause.state = currentUser.state;
      ownerWhereClause.country = currentUser.country;
    }
    // Fall back to country and city
    else if (currentUser.country && currentUser.city) {
      ownerWhereClause.country = currentUser.country;
      ownerWhereClause.city = currentUser.city;
    }
    // Minimum: match by country
    else if (currentUser.country) {
      ownerWhereClause.country = currentUser.country;
    } else {
      return res.status(400).json({
        success: false,
        message: 'Please set your location (country/city/pincode) first.',
      });
    }

    // Find nearby listings
    const listings = await prisma.listing.findMany({
      where: {
        owner_id: { not: userId },
        status: 'ACTIVE',
        category: category ? category : undefined,
        owner: ownerWhereClause,
      },
      include: {
        owner: true,
      },
      take: 20,
    });

    res.json({
      success: true,
      data: listings.map(listing => ({
        id: listing.id,
        title: listing.title,
        description: listing.description,
        category: listing.category,
        image_url: listing.image_url,
        is_service: listing.is_service,
        owner: {
          id: listing.owner.id,
          username: listing.owner.username,
          rating: listing.owner.rating,
          avatar_url: listing.owner.avatar_url,
          city: listing.owner.city,
          town: listing.owner.town,
          state: listing.owner.state,
          country: listing.owner.country,
          pincode: listing.owner.pincode,
        },
      })),
      total: listings.length,
      matchType: currentUser.pincode ? 'pincode' : 'location',
    });
  } catch (error: any) {
    res.status(400).json({
      success: false,
      message: error.message,
    });
  }
});

export default router;


================================================
FILE: D:\barter_verse\backend\src\routes\privacy.routes.ts
================================================
import { Router, Request, Response } from 'express';
import { verifyToken } from '../middleware/auth.middleware';
import { exportUserData, anonymizeUserData, getAuditLogs, logAuditTrail, getClientIp } from '../utils/gdpr';

const router = Router();

// Export user data (GDPR)
router.get('/export', verifyToken, async (req: any, res: Response) => {
  try {
    const userId = req.user.id;
    const data = await exportUserData(userId);

    res.json({
      success: true,
      message: 'User data exported successfully',
      data,
    });
  } catch (error: any) {
    res.status(400).json({
      success: false,
      message: error.message,
    });
  }
});

// Request account deletion (GDPR - Right to be forgotten)
router.post('/delete-account', verifyToken, async (req: any, res: Response) => {
  try {
    const userId = req.user.id;
    const { password } = req.body;

    if (!password) {
      return res.status(400).json({
        success: false,
        message: 'Password confirmation is required for account deletion',
      });
    }

    // Verify password before deletion
    const { PrismaClient } = require('@prisma/client');
    const prisma = new PrismaClient();
    const user = await prisma.profile.findUnique({
      where: { id: userId },
    });

    if (!user) {
      return res.status(404).json({
        success: false,
        message: 'User not found',
      });
    }

    const bcrypt = require('bcryptjs');
    const isPasswordValid = await bcrypt.compare(password, user.password);

    if (!isPasswordValid) {
      logAuditTrail({
        userId,
        action: 'DELETE_ACCOUNT_FAILED',
        resource: 'Profile',
        resourceId: userId,
        ipAddress: getClientIp(req),
        status: 'failure',
      });

      return res.status(401).json({
        success: false,
        message: 'Invalid password',
      });
    }

    // Anonymize user data instead of hard deletion
    await anonymizeUserData(userId);

    res.json({
      success: true,
      message: 'Your account has been deleted and anonymized per GDPR regulations',
    });
  } catch (error: any) {
    res.status(500).json({
      success: false,
      message: error.message,
    });
  }
});

// Get audit logs for user
router.get('/audit-logs', verifyToken, async (req: any, res: Response) => {
  try {
    const userId = req.user.id;
    const limit = parseInt(req.query.limit) || 50;

    const logs = getAuditLogs(userId, undefined, limit);

    res.json({
      success: true,
      data: logs,
      total: logs.length,
    });
  } catch (error: any) {
    res.status(400).json({
      success: false,
      message: error.message,
    });
  }
});

export default router;


================================================
FILE: D:\barter_verse\backend\src\routes\reviews.routes.ts
================================================
import { Router } from 'express';
import { authRequired } from '../middleware/auth.middleware';
import {
  createReview,
  getReviews,
  getUserReviewsGiven,
  deleteReview,
} from '../controllers/reviews.controller';

const router = Router();

// Create a new review
router.post('/', authRequired, createReview);

// Get reviews for a specific user
router.get('/user/:target_user_id', getReviews);

// Get reviews given by current user
router.get('/my-reviews/given', authRequired, getUserReviewsGiven);

// Delete a review
router.delete('/:id', authRequired, deleteReview);

export default router;


================================================
FILE: D:\barter_verse\backend\src\routes\sessions.routes.ts
================================================
import { Router, Request, Response } from 'express';
import { PrismaClient } from '@prisma/client';
import { verifyToken } from '../middleware/auth.middleware';

const router = Router();
const prisma = new PrismaClient();

// Create a new session
router.post('/create', verifyToken, async (req: any, res: Response) => {
  try {
    const providerId = req.user.id;
    const {
      participant_id,
      skill_title,
      description,
      scheduled_at,
      duration_minutes,
      location,
      meeting_link,
    } = req.body;

    if (!participant_id || !skill_title || !scheduled_at) {
      return res.status(400).json({
        success: false,
        message: 'Missing required fields: participant_id, skill_title, scheduled_at',
      });
    }

    // Validate scheduled date is in future
    const scheduledDate = new Date(scheduled_at);
    if (scheduledDate <= new Date()) {
      return res.status(400).json({
        success: false,
        message: 'Session must be scheduled for a future date',
      });
    }

    const session = await prisma.session.create({
      data: {
        provider_id: providerId,
        participant_id,
        skill_title,
        description,
        scheduled_at: scheduledDate,
        duration_minutes: duration_minutes || 60,
        location: location || null,
        meeting_link: meeting_link || null,
      },
      include: {
        provider: { select: { id: true, username: true, avatar_url: true } },
        participant: { select: { id: true, username: true, avatar_url: true } },
      },
    });

    res.status(201).json({
      success: true,
      message: 'Session created successfully',
      data: session,
    });
  } catch (error: any) {
    res.status(400).json({
      success: false,
      message: error.message,
    });
  }
});

// Get available time slots (mock implementation)
router.get('/availability/:provider_id', async (req: Request, res: Response) => {
  try {
    const { provider_id } = req.params;
    const date = req.query.date as string;

    if (!date) {
      return res.status(400).json({
        success: false,
        message: 'Date parameter is required (YYYY-MM-DD)',
      });
    }

    // Get user's existing sessions for the date
    const existingSessions = await prisma.session.findMany({
      where: {
        provider_id,
        scheduled_at: {
          gte: new Date(`${date}T00:00:00`),
          lt: new Date(`${date}T23:59:59`),
        },
      },
    });

    // Generate available slots (9 AM to 6 PM, hourly)
    const slots = [];
    const workStart = 9;
    const workEnd = 18;

    for (let hour = workStart; hour < workEnd; hour++) {
      const slotTime = new Date(`${date}T${hour.toString().padStart(2, '0')}:00:00`);
      const isBooked = existingSessions.some(session => {
        const sessionHour = session.scheduled_at.getHours();
        return sessionHour === hour;
      });

      if (!isBooked) {
        slots.push({
          time: slotTime.toISOString(),
          available: true,
        });
      }
    }

    res.json({
      success: true,
      data: slots,
      date,
    });
  } catch (error: any) {
    res.status(400).json({
      success: false,
      message: error.message,
    });
  }
});

// Get user's sessions (as provider or participant)
router.get('/my-sessions', verifyToken, async (req: any, res: Response) => {
  try {
    const userId = req.user.id;
    const role = req.query.role || 'both'; // 'provider', 'participant', or 'both'

    let where: any = {};

    if (role === 'provider') {
      where.provider_id = userId;
    } else if (role === 'participant') {
      where.participant_id = userId;
    } else {
      where = {
        OR: [{ provider_id: userId }, { participant_id: userId }],
      };
    }

    const sessions = await prisma.session.findMany({
      where,
      include: {
        provider: { select: { id: true, username: true, avatar_url: true, rating: true } },
        participant: { select: { id: true, username: true, avatar_url: true, rating: true } },
      },
      orderBy: { scheduled_at: 'asc' },
    });

    res.json({
      success: true,
      data: sessions,
      total: sessions.length,
    });
  } catch (error: any) {
    res.status(400).json({
      success: false,
      message: error.message,
    });
  }
});

// Update session status
router.put('/:session_id/status', verifyToken, async (req: any, res: Response) => {
  try {
    const { session_id } = req.params;
    const { status, feedback, rating } = req.body;

    const validStatuses = ['SCHEDULED', 'IN_PROGRESS', 'COMPLETED', 'CANCELLED', 'NO_SHOW'];
    if (!validStatuses.includes(status)) {
      return res.status(400).json({
        success: false,
        message: `Invalid status. Must be one of: ${validStatuses.join(', ')}`,
      });
    }

    const session = await prisma.session.findUnique({
      where: { id: session_id },
    });

    if (!session) {
      return res.status(404).json({
        success: false,
        message: 'Session not found',
      });
    }

    // Only provider or participant can update
    if (session.provider_id !== req.user.id && session.participant_id !== req.user.id) {
      return res.status(403).json({
        success: false,
        message: 'Unauthorized to update this session',
      });
    }

    const updatedSession = await prisma.session.update({
      where: { id: session_id },
      data: {
        status,
        feedback: feedback || undefined,
        rating: rating ? Math.min(5, Math.max(1, rating)) : undefined,
      },
      include: {
        provider: { select: { id: true, username: true, avatar_url: true } },
        participant: { select: { id: true, username: true, avatar_url: true } },
      },
    });

    res.json({
      success: true,
      message: 'Session updated successfully',
      data: updatedSession,
    });
  } catch (error: any) {
    res.status(400).json({
      success: false,
      message: error.message,
    });
  }
});

// Cancel session
router.delete('/:session_id', verifyToken, async (req: any, res: Response) => {
  try {
    const { session_id } = req.params;

    const session = await prisma.session.findUnique({
      where: { id: session_id },
    });

    if (!session) {
      return res.status(404).json({
        success: false,
        message: 'Session not found',
      });
    }

    // Only provider or participant can cancel
    if (session.provider_id !== req.user.id && session.participant_id !== req.user.id) {
      return res.status(403).json({
        success: false,
        message: 'Unauthorized to cancel this session',
      });
    }

    const deletedSession = await prisma.session.delete({
      where: { id: session_id },
    });

    res.json({
      success: true,
      message: 'Session cancelled successfully',
      data: deletedSession,
    });
  } catch (error: any) {
    res.status(400).json({
      success: false,
      message: error.message,
    });
  }
});

export default router;


================================================
FILE: D:\barter_verse\backend\src\routes\trades.routes.ts
================================================
import { Router } from 'express';
import { authRequired } from '../middleware/auth.middleware';
import { 
  getMyTrades, 
  createTrade, 
  confirmTrade, 
  completeTrade, 
  cancelTrade, 
  getTradeById,
  confirmDelivery // Added this import
} from '../controllers/trades.controller';

const router = Router();

// Get Trades
router.get('/', authRequired, getMyTrades);
router.get('/:id', authRequired, getTradeById);


// Create Trade
router.post('/', authRequired, createTrade);

// Trade Lifecycle Actions
router.patch('/:id/confirm', authRequired, confirmTrade);   // Accept/Reject
router.patch('/:id/delivery', authRequired, confirmDelivery); // Seller confirms sending [New]
router.patch('/:id/complete', authRequired, completeTrade);   // Buyer confirms receipt
router.patch('/:id/cancel', authRequired, cancelTrade);
// Inside trades.routes.ts
router.patch('/:id/delivery', authMiddleware, tradesController.confirmDelivery);       // Cancel pending

export default router;

================================================
FILE: D:\barter_verse\backend\src\scripts\seed-admin.js
================================================
import bcrypt from "bcryptjs";
import { PrismaClient } from "@prisma/client";

const prisma = new PrismaClient();

async function seedAdmin() {
  try {
    const hashedPassword = await bcrypt.hash("admin123", 10);

    await prisma.profile.upsert({
      where: { email: "admin@gmail.com" },
      update: {},
      create: {
        email: "admin@gmail.com",
        username: "admin",
        password: hashedPassword,
        role: "admin",
        coins: 100,
      },
    });

    console.log("Admin created successfully!");
  } catch (error) {
    console.error("Error:", error);
  } finally {
    await prisma.$disconnect();
  }
}

seedAdmin();


================================================
FILE: D:\barter_verse\backend\src\server.ts
================================================
import dotenv from 'dotenv';
dotenv.config();

console.log('Starting server...');

import { app } from './app';

console.log('App imported successfully');

const PORT = Number(process.env.PORT) || 5000;

console.log('PORT:', PORT);

const server = app.listen(PORT, () => {
  console.log(` Backend listening on port ${PORT}`);
  console.log('Server callback executed');
});

console.log('listen() called');

server.on('error', (error) => {
  console.error('Server error:', error);
  process.exit(1);
});

process.on('unhandledRejection', (reason, promise) => {
  console.error('Unhandled Rejection at:', promise, 'reason:', reason);
  process.exit(1);
});

process.on('uncaughtException', (error) => {
  console.error('Uncaught Exception:', error);
  process.exit(1);
});


================================================
FILE: D:\barter_verse\backend\src\services\admin.service.ts
================================================
import { prisma } from "../prisma/client";
import { AppError } from "../middleware/error.middleware";

export const adminService = {
  getAllUsers: async () => {
    return prisma.profile.findMany({
      select: { id: true, username: true, email: true, coins: true, role: true },
    });
  },

  getUserById: async (userId: string) => {
    const user = await prisma.profile.findUnique({
      where: { id: userId },
      select: { id: true, username: true, email: true, coins: true, role: true },
    });
    if (!user) throw new AppError(404, "User not found");
    return user;
  },

  addCoinsToUser: async (userId: string, amount: number, reason: string) => {
    return prisma.coinTransaction.create({
      data: { user_id: userId, amount, reason },
    });
  },

  removeCoinsFromUser: async (userId: string, amount: number, reason: string) => {
    const user = await prisma.profile.findUnique({ where: { id: userId } });
    if (!user || user.coins < amount) throw new AppError(400, "Not enough coins");

    return prisma.coinTransaction.create({
      data: { user_id: userId, amount: -amount, reason },
    });
  },

  updateUserRole: async (userId: string, role: string) => {
    return prisma.profile.update({
      where: { id: userId },
      data: { role },
    });
  },

  getAllTrades: async (status?: string) => {
    return prisma.trade.findMany({
      where: status ? { status: status.toUpperCase() as any } : undefined,
      include: {
        initiator: { select: { id: true, username: true } },
        responder: { select: { id: true, username: true } },
        listing: true,
      },
    });
  },

  getTradeById: async (tradeId: string) => {
    const trade = await prisma.trade.findUnique({
      where: { id: tradeId },
      include: {
        initiator: { select: { id: true, username: true } },
        responder: { select: { id: true, username: true } },
        listing: true,
      },
    });
    if (!trade) throw new AppError(404, "Trade not found");
    return trade;
  },

  acceptTrade: async (tradeId: string) => {
    return prisma.trade.update({
      where: { id: tradeId },
      data: { status: "ACCEPTED" },
    });
  },

  rejectTrade: async (tradeId: string, reason?: string) => {
    return prisma.trade.update({
      where: { id: tradeId },
      data: { status: "REJECTED", message: reason },
    });
  },

  completeTrade: async (tradeId: string) => {
    return prisma.trade.update({
      where: { id: tradeId },
      data: { status: "COMPLETED" },
    });
  },

  cancelTrade: async (tradeId: string, reason?: string) => {
    return prisma.trade.update({
      where: { id: tradeId },
      data: { status: "REJECTED", message: reason },
    });
  },

  getAdminStats: async () => {
    const users = await prisma.profile.count();
    const trades = await prisma.trade.count();
    return { totalUsers: users, totalTrades: trades };
  },
};


================================================
FILE: D:\barter_verse\backend\src\services\auth.service.ts
================================================
import { prisma } from "../prisma/client";
import { AppError } from "../middleware/error.middleware";
import bcrypt from "bcryptjs";

export const authService = {
  signup: async (email: string, password: string, username: string) => {
    // Check if user already exists
    const existingUser = await prisma.profile.findUnique({
      where: { email },
    });

    if (existingUser) {
      throw new AppError(409, "User with this email already exists");
    }

    // Check if username is taken
    const existingUsername = await prisma.profile.findUnique({
      where: { username },
    });

    if (existingUsername) {
      throw new AppError(409, "Username is already taken");
    }

    // Hash password
    const hashedPassword = await bcrypt.hash(password, 10);

    // Create new user
    const user = await prisma.profile.create({
      data: {
        email,
        username,
        password: hashedPassword,
        coins: 100, // Starting coins
      },
    });

    // Generate token (simple version - in production use JWT)
    const token = Buffer.from(`${user.id}:${email}`).toString("base64");

    return {
      user: {
        id: user.id,
        email: user.email,
        username: user.username,
        coins: user.coins,
        rating: user.rating,
      },
      token,
    };
  },

  signin: async (email: string, password: string) => {
    // Find user by email
    const user = await prisma.profile.findUnique({
      where: { email },
    });

    if (!user) {
      throw new AppError(401, "Invalid email or password");
    }

    // Verify password
    const isPasswordValid = await bcrypt.compare(password, user.password);

    if (!isPasswordValid) {
      throw new AppError(401, "Invalid email or password");
    }

    // Generate token
    const token = Buffer.from(`${user.id}:${email}`).toString("base64");

    return {
      user: {
        id: user.id,
        email: user.email,
        username: user.username,
        coins: user.coins,
        rating: user.rating,
      },
      token,
    };
  },

  verifyToken: (token: string) => {
    try {
      // Decode the simple base64 token
      const decoded = Buffer.from(token, "base64").toString("utf-8");
      const [userId] = decoded.split(":");
      return userId;
    } catch {
      throw new AppError(401, "Invalid token");
    }
  },
};


================================================
FILE: D:\barter_verse\backend\src\services\coins.service.ts
================================================
import { prisma } from "../prisma/client";
import { AppError } from "../middleware/error.middleware";
import { z } from "zod";

export const spendCoinsSchema = z.object({
  amount: z.number().int().min(1),
  reason: z.string().min(1),
});

export const addCoinsSchema = z.object({
  amount: z.number().int().min(1),
  reason: z.string().min(1),
});

export type SpendCoinsInput = z.infer<typeof spendCoinsSchema>;
export type AddCoinsInput = z.infer<typeof addCoinsSchema>;

export class CoinsService {
  async getBalance(userId: string): Promise<number> {
    const profile = await prisma.profile.findUnique({
      where: { id: userId },
      select: { coins: true },
    });

    if (!profile) {
      throw new AppError(404, "User not found");
    }

    return profile.coins;
  }

  async addCoins(
    userId: string,
    amount: number,
    reason: string
  ): Promise<{ balance: number; transaction: any }> {
    if (amount <= 0) {
      throw new AppError(400, "Amount must be greater than 0");
    }

    const [profile, transaction] = await Promise.all([
      prisma.profile.update({
        where: { id: userId },
        data: { coins: { increment: amount } },
      }),
      prisma.coinTransaction.create({
        data: {
          user_id: userId,
          amount,
          reason,
        },
      }),
    ]);

    return {
      balance: profile.coins,
      transaction,
    };
  }

  async spendCoins(
    userId: string,
    amount: number,
    reason: string
  ): Promise<{ balance: number; transaction: any }> {
    if (amount <= 0) {
      throw new AppError(400, "Amount must be greater than 0");
    }

    const profile = await prisma.profile.findUnique({
      where: { id: userId },
      select: { coins: true },
    });

    if (!profile) {
      throw new AppError(404, "User not found");
    }

    if (profile.coins < amount) {
      throw new AppError(400, "Insufficient coins balance");
    }

    const [updatedProfile, transaction] = await Promise.all([
      prisma.profile.update({
        where: { id: userId },
        data: { coins: { decrement: amount } },
      }),
      prisma.coinTransaction.create({
        data: {
          user_id: userId,
          amount: -amount,
          reason,
        },
      }),
    ]);

    return {
      balance: updatedProfile.coins,
      transaction,
    };
  }

  async getTransactionHistory(
    userId: string,
    limit: number = 50
  ): Promise<any[]> {
    return await prisma.coinTransaction.findMany({
      where: { user_id: userId },
      orderBy: { created_at: "desc" },
      take: limit,
    });
  }

  async transferCoins(
    fromUserId: string,
    toUserId: string,
    amount: number,
    reason: string
  ): Promise<any> {
    if (amount <= 0) {
      throw new AppError(400, "Amount must be greater than 0");
    }

    // Check sender balance
    const sender = await prisma.profile.findUnique({
      where: { id: fromUserId },
      select: { coins: true },
    });

    if (!sender) {
      throw new AppError(404, "Sender not found");
    }

    if (sender.coins < amount) {
      throw new AppError(400, "Insufficient coins balance");
    }

    // Check recipient exists
    const recipient = await prisma.profile.findUnique({
      where: { id: toUserId },
      select: { id: true },
    });

    if (!recipient) {
      throw new AppError(404, "Recipient not found");
    }

    // Transfer coins
    const transferReason = `Transfer: ${reason}`;

    const result = await prisma.$transaction(async (tx: any) => {
      const updated = await tx.profile.update({
        where: { id: fromUserId },
        data: { coins: { decrement: amount } },
      });

      await tx.profile.update({
        where: { id: toUserId },
        data: { coins: { increment: amount } },
      });

      const senderTx = await tx.coinTransaction.create({
        data: {
          user_id: fromUserId,
          amount: -amount,
          reason: transferReason,
        },
      });

      const recipientTx = await tx.coinTransaction.create({
        data: {
          user_id: toUserId,
          amount,
          reason: transferReason,
        },
      });

      return {
        senderBalance: updated.coins,
        senderTransaction: senderTx,
        recipientTransaction: recipientTx,
      };
    });

    return result;
  }
}


================================================
FILE: D:\barter_verse\backend\src\services\listings.service.ts
================================================
import { prisma } from "../prisma/client";
import { Listing, ListingStatus } from "@prisma/client";
import { AppError } from "../middleware/error.middleware";
import { z } from "zod";

export const createListingSchema = z.object({
  title: z.string().min(3).max(255),
  description: z.string().min(10).max(2000),
  category: z.string().min(1),
  image_url: z.string().url().optional(),
  is_service: z.boolean().optional().default(false),
});

export const updateListingSchema = createListingSchema.partial();

export type CreateListingInput = z.infer<typeof createListingSchema>;
export type UpdateListingInput = z.infer<typeof updateListingSchema>;

export class ListingsService {
  async createListing(
    ownerId: string,
    data: CreateListingInput
  ): Promise<Listing> {
    return await prisma.listing.create({
      data: {
        owner_id: ownerId,
        ...data,
      },
    });
  }

  async getListings(
    page: number = 1,
    limit: number = 10,
    category?: string,
    search?: string
  ): Promise<{ listings: Listing[]; total: number }> {
    const skip = (page - 1) * limit;

    const where: any = {
      status: ListingStatus.ACTIVE,
    };

    if (category) {
      where.category = category;
    }

    if (search) {
      where.OR = [
        { title: { contains: search, mode: "insensitive" } },
        { description: { contains: search, mode: "insensitive" } },
      ];
    }

    const [listings, total] = await Promise.all([
      prisma.listing.findMany({
        where,
        include: {
          owner: {
            select: {
              id: true,
              username: true,
              avatar_url: true,
              rating: true,
            },
          },
        },
        skip,
        take: limit,
        orderBy: { created_at: "desc" },
      }),
      prisma.listing.count({ where }),
    ]);

    return { listings, total };
  }

  async getListingById(id: string): Promise<Listing> {
    const listing = await prisma.listing.findUnique({
      where: { id },
      include: {
        owner: {
          select: {
            id: true,
            username: true,
            avatar_url: true,
            rating: true,
            bio: true,
          },
        },
      },
    });

    if (!listing) {
      throw new AppError(404, "Listing not found");
    }

    return listing;
  }

  async getUserListings(userId: string): Promise<Listing[]> {
    return await prisma.listing.findMany({
      where: { owner_id: userId },
      orderBy: { created_at: "desc" },
    });
  }

  async updateListing(
    id: string,
    userId: string,
    data: UpdateListingInput
  ): Promise<Listing> {
    // Verify ownership
    const listing = await prisma.listing.findUnique({
      where: { id },
    });

    if (!listing) {
      throw new AppError(404, "Listing not found");
    }

    if (listing.owner_id !== userId) {
      throw new AppError(403, "Unauthorized to update this listing");
    }

    return await prisma.listing.update({
      where: { id },
      data,
    });
  }

  async deleteListing(id: string, userId: string): Promise<void> {
    // Verify ownership
    const listing = await prisma.listing.findUnique({
      where: { id },
    });

    if (!listing) {
      throw new AppError(404, "Listing not found");
    }

    if (listing.owner_id !== userId) {
      throw new AppError(403, "Unauthorized to delete this listing");
    }

    await prisma.listing.delete({
      where: { id },
    });
  }

  async archiveListing(id: string, userId: string): Promise<Listing> {
    const listing = await prisma.listing.findUnique({
      where: { id },
    });

    if (!listing) {
      throw new AppError(404, "Listing not found");
    }

    if (listing.owner_id !== userId) {
      throw new AppError(403, "Unauthorized to archive this listing");
    }

    return await prisma.listing.update({
      where: { id },
      data: { status: ListingStatus.ARCHIVED },
    });
  }
}


================================================
FILE: D:\barter_verse\backend\src\services\trades.service.ts
================================================
import { prisma } from "../prisma/client";
import { Trade, TradeStatus } from "@prisma/client";
import { AppError } from "../middleware/error.middleware";
import { z } from "zod";

export const createTradeSchema = z.object({
  listing_id: z.string().uuid(),
  proposed_listing_id: z.string().uuid().optional(),
  coin_amount: z.number().int().min(0).optional().default(0),
  message: z.string().optional(),
});

export const confirmTradeSchema = z.object({
  accepted: z.boolean(),
});

export type CreateTradeInput = z.infer<typeof createTradeSchema>;
export type ConfirmTradeInput = z.infer<typeof confirmTradeSchema>;

export class TradesService {
  async createTrade(
    initiatorId: string,
    data: CreateTradeInput
  ): Promise<Trade> {
    // Verify listing exists
    const listing = await prisma.listing.findUnique({
      where: { id: data.listing_id },
    });

    if (!listing) {
      throw new AppError(404, "Listing not found");
    }

    // Check if user is not the owner
    if (listing.owner_id === initiatorId) {
      throw new AppError(400, "Cannot trade your own listing");
    }

    // If proposing a listing, verify it exists
    if (data.proposed_listing_id) {
      const proposedListing = await prisma.listing.findUnique({
        where: { id: data.proposed_listing_id },
      });

      if (!proposedListing) {
        throw new AppError(404, "Proposed listing not found");
      }

      if (proposedListing.owner_id !== initiatorId) {
        throw new AppError(400, "You can only propose your own listings");
      }
    }

    const trade = await prisma.trade.create({
      data: {
        initiator_id: initiatorId,
        responder_id: listing.owner_id,
        listing_id: data.listing_id,
        proposed_listing_id: data.proposed_listing_id,
        coin_amount: data.coin_amount || 0,
        message: data.message,
      },
    });

    return trade;
  }

  async getTrades(userId: string, type: "incoming" | "outgoing" = "incoming"): Promise<Trade[]> {
    const where =
      type === "incoming"
        ? { responder_id: userId }
        : { initiator_id: userId };

    return await prisma.trade.findMany({
      where,
      include: {
        initiator: {
          select: {
            id: true,
            username: true,
            avatar_url: true,
            rating: true,
          },
        },
        responder: {
          select: {
            id: true,
            username: true,
            avatar_url: true,
            rating: true,
          },
        },
        listing: true,
      },
      orderBy: { created_at: "desc" },
    });
  }

  async getTradeById(id: string): Promise<Trade> {
    const trade = await prisma.trade.findUnique({
      where: { id },
      include: {
        initiator: {
          select: {
            id: true,
            username: true,
            avatar_url: true,
            rating: true,
            bio: true,
          },
        },
        responder: {
          select: {
            id: true,
            username: true,
            avatar_url: true,
            rating: true,
            bio: true,
          },
        },
        listing: {
          include: {
            owner: {
              select: {
                id: true,
                username: true,
              },
            },
          },
        },
      },
    });

    if (!trade) {
      throw new AppError(404, "Trade not found");
    }

    return trade;
  }

  async confirmTrade(
    id: string,
    userId: string,
    accepted: boolean
  ): Promise<Trade> {
    const trade = await prisma.trade.findUnique({
      where: { id },
    });

    if (!trade) {
      throw new AppError(404, "Trade not found");
    }

    // Only responder can confirm
    if (trade.responder_id !== userId) {
      throw new AppError(403, "Only responder can confirm this trade");
    }

    if (trade.status !== TradeStatus.PENDING) {
      throw new AppError(400, "Trade can only be confirmed if pending");
    }

    const updatedTrade = await prisma.trade.update({
      where: { id },
      data: {
        status: accepted ? TradeStatus.ACCEPTED : TradeStatus.REJECTED,
      },
    });

    return updatedTrade;
  }

  async completeTrade(id: string, userId: string): Promise<Trade> {
    const trade = await prisma.trade.findUnique({
      where: { id },
    });

    if (!trade) {
      throw new AppError(404, "Trade not found");
    }

    // Either participant can complete
    if (trade.initiator_id !== userId && trade.responder_id !== userId) {
      throw new AppError(403, "Unauthorized to complete this trade");
    }

    if (trade.status !== TradeStatus.ACCEPTED) {
      throw new AppError(400, "Trade must be accepted before completing");
    }

    // Update listing status and handle coin transfer if needed
    const result = await prisma.$transaction(async (tx: any) => {
      // Update listing status to TRADED
      await tx.listing.update({
        where: { id: trade.listing_id },
        data: { status: "TRADED" },
      });

      // Handle coin transfer if coins were part of the trade
      if (trade.coin_amount > 0) {
        const payer =
          trade.initiator_id === userId ? trade.responder_id : trade.initiator_id;
        const receiver =
          trade.initiator_id === userId ? trade.initiator_id : trade.responder_id;

        await tx.profile.update({
          where: { id: payer },
          data: { coins: { decrement: trade.coin_amount } },
        });

        await tx.profile.update({
          where: { id: receiver },
          data: { coins: { increment: trade.coin_amount } },
        });

        // Log transactions
        await tx.coinTransaction.create({
          data: {
            user_id: payer,
            amount: -trade.coin_amount,
            reason: `Trade completion - to ${receiver}`,
          },
        });

        await tx.coinTransaction.create({
          data: {
            user_id: receiver,
            amount: trade.coin_amount,
            reason: `Trade completion - from ${payer}`,
          },
        });
      }

      // Update trade status
      return await tx.trade.update({
        where: { id },
        data: { status: TradeStatus.COMPLETED },
      });
    });

    return result;
  }

  async cancelTrade(id: string, userId: string): Promise<Trade> {
    const trade = await prisma.trade.findUnique({
      where: { id },
    });

    if (!trade) {
      throw new AppError(404, "Trade not found");
    }

    // Only initiator can cancel
    if (trade.initiator_id !== userId) {
      throw new AppError(403, "Only initiator can cancel this trade");
    }

    if (trade.status !== TradeStatus.PENDING) {
      throw new AppError(400, "Can only cancel pending trades");
    }

    return await prisma.trade.delete({
      where: { id },
    }) as Trade;
  }
}


================================================
FILE: D:\barter_verse\backend\src\types\express.d.ts
================================================
import { Profile } from '@prisma/client';

declare global {
  namespace Express {
    interface Request {
      userId?: string;
      userRole?: string;
      user?: Profile;
    }
  }
}

export {};


================================================
FILE: D:\barter_verse\backend\src\types\index.ts
================================================
import { Request } from 'express';
import { Profile } from '@prisma/client';

export interface AuthRequest extends Request {
  user?: Profile;
}

export interface JwtPayload {
  id: string;
  role: string;
}

export type ApiResponse<T = any> = {
  success: boolean;
  data?: T;
  message?: string;
  error?: string;
};


================================================
FILE: D:\barter_verse\backend\src\types\shims.d.ts
================================================
// Shims for modules without types installed. Prefer installing @types/* packages.

declare module 'morgan' {
  import { RequestHandler } from 'express';
  const morgan: (...args: any[]) => RequestHandler;
  export = morgan;
}

declare module 'cookie-parser' {
  import { RequestHandler } from 'express';
  function cookieParser(secret?: string): RequestHandler;
  namespace cookieParser {}
  export = cookieParser;
}

declare module 'jsonwebtoken' {
  export function sign(payload: any, secretOrPrivateKey: string, options?: any): string;
  export function verify(token: string, secretOrPublicKey: string, options?: any): any;
  export function decode(token: string, options?: any): any;
}


================================================
FILE: D:\barter_verse\backend\src\utils\encryption.ts
================================================
import crypto from 'crypto';

const ENCRYPTION_KEY = process.env.ENCRYPTION_KEY || 'your-256-bit-key-change-in-production-12345678901234';
const ALGORITHM = 'aes-256-gcm';

// Ensure key is 32 bytes (256 bits)
const getKey = (): Buffer => {
  const key = ENCRYPTION_KEY.padEnd(32, '0').substring(0, 32);
  return Buffer.from(key);
};

export const encryptField = (plaintext: string): string => {
  const key = getKey();
  const iv = crypto.randomBytes(12); // 96-bit IV for GCM
  const cipher = crypto.createCipheriv(ALGORITHM, key, iv);

  let encrypted = cipher.update(plaintext, 'utf8', 'hex');
  encrypted += cipher.final('hex');

  const authTag = cipher.getAuthTag();

  // Combine IV + authTag + encrypted data
  return `${iv.toString('hex')}:${authTag.toString('hex')}:${encrypted}`;
};

export const decryptField = (encryptedData: string): string => {
  try {
    const key = getKey();
    const [ivHex, authTagHex, encrypted] = encryptedData.split(':');

    const iv = Buffer.from(ivHex, 'hex');
    const authTag = Buffer.from(authTagHex, 'hex');

    const decipher = crypto.createDecipheriv(ALGORITHM, key, iv);
    decipher.setAuthTag(authTag);

    let decrypted = decipher.update(encrypted, 'hex', 'utf8');
    decrypted += decipher.final('utf8');

    return decrypted;
  } catch (error) {
    throw new Error('Decryption failed: Invalid or tampered data');
  }
};

// Hash sensitive data (one-way, for verification only)
export const hashSensitiveData = (data: string): string => {
  return crypto.createHash('sha256').update(data).digest('hex');
};

// Generate random token for password reset/verification
export const generateSecureToken = (length: number = 32): string => {
  return crypto.randomBytes(length).toString('hex');
};


================================================
FILE: D:\barter_verse\backend\src\utils\gdpr.ts
================================================
import { Response } from 'express';
import { PrismaClient } from '@prisma/client';

const prisma = new PrismaClient();

export interface AuditLog {
  userId: string;
  action: string;
  resource: string;
  resourceId: string;
  changes?: Record<string, any>;
  ipAddress: string;
  timestamp?: Date;
  status: 'success' | 'failure';
}

// In-memory audit logs (in production, use a database table)
const auditLogs: AuditLog[] = [];

export const logAuditTrail = (log: AuditLog): void => {
  auditLogs.push({
    ...log,
    timestamp: new Date(),
  });

  // Keep only last 10000 logs in memory
  if (auditLogs.length > 10000) {
    auditLogs.shift();
  }
};

export const getAuditLogs = (
  userId?: string,
  action?: string,
  limit: number = 100
): AuditLog[] => {
  let filtered = auditLogs;

  if (userId) {
    filtered = filtered.filter(log => log.userId === userId);
  }

  if (action) {
    filtered = filtered.filter(log => log.action === action);
  }

  return filtered.slice(-limit);
};

export const getClientIp = (req: any): string => {
  const forwarded = req.headers['x-forwarded-for'];
  if (typeof forwarded === 'string') {
    return forwarded.split(',')[0].trim();
  }
  return req.connection.remoteAddress || 'unknown';
};

// GDPR: Right to be forgotten - anonymize user data
export const anonymizeUserData = async (userId: string): Promise<void> => {
  try {
    const anonymousEmail = `anonymous_${userId}@deleted.local`;
    const anonymousUsername = `deleted_user_${userId.substring(0, 8)}`;

    await prisma.profile.update({
      where: { id: userId },
      data: {
        email: anonymousEmail,
        username: anonymousUsername,
        password: 'DELETED',
        avatar_url: null,
        bio: 'Account deleted by user request',
        role: 'user',
      },
    });

    logAuditTrail({
      userId,
      action: 'GDPR_ANONYMIZE',
      resource: 'Profile',
      resourceId: userId,
      ipAddress: 'system',
      status: 'success',
    });
  } catch (error) {
    throw new Error(`Failed to anonymize user data: ${error}`);
  }
};

// GDPR: Data export - generate complete user data export
export const exportUserData = async (userId: string): Promise<Record<string, any>> => {
  try {
    const user = await prisma.profile.findUnique({
      where: { id: userId },
      include: {
        listings: true,
        trades_initiated: true,
        trades_received: true,
        coin_transactions: true,
      },
    });

    if (!user) {
      throw new Error('User not found');
    }

    logAuditTrail({
      userId,
      action: 'GDPR_EXPORT',
      resource: 'Profile',
      resourceId: userId,
      ipAddress: 'system',
      status: 'success',
    });

    return {
      profile: user,
      listings: user.listings,
      trades: {
        initiated: user.trades_initiated,
        received: user.trades_received,
      },
      transactions: user.coin_transactions,
      exportDate: new Date().toISOString(),
    };
  } catch (error) {
    throw new Error(`Failed to export user data: ${error}`);
  }
};


================================================
FILE: D:\barter_verse\backend\src\utils\location.ts
================================================
// Haversine formula to calculate distance between two coordinates
export const calculateDistance = (
  lat1: number,
  lon1: number,
  lat2: number,
  lon2: number
): number => {
  const R = 6371; // Earth's radius in km
  const dLat = (lat2 - lat1) * (Math.PI / 180);
  const dLon = (lon2 - lon1) * (Math.PI / 180);

  const a =
    Math.sin(dLat / 2) * Math.sin(dLat / 2) +
    Math.cos(lat1 * (Math.PI / 180)) *
      Math.cos(lat2 * (Math.PI / 180)) *
      Math.sin(dLon / 2) *
      Math.sin(dLon / 2);

  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
  return R * c; // Distance in km
};

// Find nearby locations within radius
export const findNearbyLocations = (
  centerLat: number,
  centerLon: number,
  locations: Array<{ id: string; latitude: number; longitude: number }>,
  radiusKm: number = 50
): Array<{ id: string; distance: number }> => {
  return locations
    .map(location => ({
      id: location.id,
      distance: calculateDistance(centerLat, centerLon, location.latitude, location.longitude),
    }))
    .filter(result => result.distance <= radiusKm)
    .sort((a, b) => a.distance - b.distance);
};

// Validate coordinates
export const isValidCoordinate = (lat: number, lon: number): boolean => {
  return lat >= -90 && lat <= 90 && lon >= -180 && lon <= 180;
};

// Geocode city/country to coordinates (mock implementation)
// In production, use Google Maps API or similar
export const geocodeLocation = async (
  city: string,
  country: string
): Promise<{ latitude: number; longitude: number } | null> => {
  const locations: Record<string, [number, number]> = {
    'bangalore_india': [12.9716, 77.5946],
    'delhi_india': [28.7041, 77.1025],
    'mumbai_india': [19.0760, 72.8777],
    'hyderabad_india': [17.3850, 78.4867],
    'pune_india': [18.5204, 73.8567],
    'london_uk': [51.5074, -0.1278],
    'newyork_usa': [40.7128, -74.0060],
    'sydney_australia': [-33.8688, 151.2093],
  };

  const key = `${city.toLowerCase().replace(/\s+/g, '')}_${country.toLowerCase().replace(/\s+/g, '')}`;
  const coords = locations[key];

  if (coords) {
    return { latitude: coords[0], longitude: coords[1] };
  }

  return null;
};


================================================
FILE: D:\barter_verse\backend\tsconfig.json
================================================
{
  "compilerOptions": {
    "target": "ES2020",
    "module": "ES2020",
    "lib": ["ES2020"],
    "outDir": "./dist",
    "rootDir": "./src",
    "strict": true,
    "esModuleInterop": true,
    "skipLibCheck": true,
    "forceConsistentCasingInFileNames": true,
    "resolveJsonModule": true,
    "declaration": false,
    "sourceMap": true,
    "moduleResolution": "bundler",
    "allowSyntheticDefaultImports": true,
    "baseUrl": "./src",
    "paths": {
      "@/*": ["*"]
    }
  },
  "include": ["src/**/*"],
  "exclude": ["node_modules", "dist"]
}


================================================
FILE: D:\barter_verse\frontend\components.json
================================================
{
  "$schema": "https://ui.shadcn.com/schema.json",
  "style": "default",
  "rsc": false,
  "tsx": true,
  "tailwind": {
    "config": "tailwind.config.ts",
    "css": "src/index.css",
    "baseColor": "slate",
    "cssVariables": true,
    "prefix": ""
  },
  "aliases": {
    "components": "@/components",
    "utils": "@/lib/utils",
    "ui": "@/components/ui",
    "lib": "@/lib",
    "hooks": "@/hooks"
  }
}


================================================
FILE: D:\barter_verse\frontend\eslint.config.js
================================================
import js from "@eslint/js";
import globals from "globals";
import reactHooks from "eslint-plugin-react-hooks";
import reactRefresh from "eslint-plugin-react-refresh";
import tseslint from "typescript-eslint";

export default tseslint.config(
  { ignores: ["dist"] },
  {
    extends: [js.configs.recommended, ...tseslint.configs.recommended],
    files: ["**/*.{ts,tsx}"],
    languageOptions: {
      ecmaVersion: 2020,
      globals: globals.browser,
    },
    plugins: {
      "react-hooks": reactHooks,
      "react-refresh": reactRefresh,
    },
    rules: {
      ...reactHooks.configs.recommended.rules,
      "react-refresh/only-export-components": ["warn", { allowConstantExport: true }],
      "@typescript-eslint/no-unused-vars": "off",
    },
  },
);


================================================
FILE: D:\barter_verse\frontend\package.json
================================================
{
  "name": "vite_react_shadcn_ts",
  "private": true,
  "version": "0.0.0",
  "type": "module",
  "scripts": {
    "dev": "vite",
    "build": "vite build",
    "build:dev": "vite build --mode development",
    "lint": "eslint .",
    "preview": "vite preview"
  },
  "dependencies": {
    "@hookform/resolvers": "^3.10.0",
    "@radix-ui/react-accordion": "^1.2.11",
    "@radix-ui/react-alert-dialog": "^1.1.14",
    "@radix-ui/react-aspect-ratio": "^1.1.7",
    "@radix-ui/react-avatar": "^1.1.10",
    "@radix-ui/react-checkbox": "^1.3.2",
    "@radix-ui/react-collapsible": "^1.1.11",
    "@radix-ui/react-context-menu": "^2.2.15",
    "@radix-ui/react-dialog": "^1.1.14",
    "@radix-ui/react-dropdown-menu": "^2.1.15",
    "@radix-ui/react-hover-card": "^1.1.14",
    "@radix-ui/react-label": "^2.1.7",
    "@radix-ui/react-menubar": "^1.1.15",
    "@radix-ui/react-navigation-menu": "^1.2.13",
    "@radix-ui/react-popover": "^1.1.14",
    "@radix-ui/react-progress": "^1.1.7",
    "@radix-ui/react-radio-group": "^1.3.7",
    "@radix-ui/react-scroll-area": "^1.2.9",
    "@radix-ui/react-select": "^2.2.5",
    "@radix-ui/react-separator": "^1.1.7",
    "@radix-ui/react-slider": "^1.3.5",
    "@radix-ui/react-slot": "^1.2.3",
    "@radix-ui/react-switch": "^1.2.5",
    "@radix-ui/react-tabs": "^1.1.12",
    "@radix-ui/react-toast": "^1.2.14",
    "@radix-ui/react-toggle": "^1.1.9",
    "@radix-ui/react-toggle-group": "^1.1.10",
    "@radix-ui/react-tooltip": "^1.2.7",
    "@tanstack/react-query": "^5.83.0",
    "class-variance-authority": "^0.7.1",
    "clsx": "^2.1.1",
    "cmdk": "^1.1.1",
    "date-fns": "^3.6.0",
    "embla-carousel-react": "^8.6.0",
    "input-otp": "^1.4.2",
    "lucide-react": "^0.462.0",
    "next-themes": "^0.3.0",
    "react": "^18.3.1",
    "react-day-picker": "^8.10.1",
    "react-dom": "^18.3.1",
    "react-hook-form": "^7.61.1",
    "react-resizable-panels": "^2.1.9",
    "react-router-dom": "^6.30.1",
    "recharts": "^2.15.4",
    "sonner": "^1.7.4",
    "tailwind-merge": "^2.6.0",
    "tailwindcss-animate": "^1.0.7",
    "vaul": "^0.9.9",
    "zod": "^3.25.76",
    "axios": "^1.6.8"
  },
  "devDependencies": {
    "@eslint/js": "^9.32.0",
    "@tailwindcss/typography": "^0.5.16",
    "@types/node": "^22.16.5",
    "@types/react": "^18.3.23",
    "@types/react-dom": "^18.3.7",
    "@vitejs/plugin-react-swc": "^3.11.0",
    "autoprefixer": "^10.4.21",
    "eslint": "^9.32.0",
    "eslint-plugin-react-hooks": "^5.2.0",
    "eslint-plugin-react-refresh": "^0.4.20",
    "globals": "^15.15.0",
    "lovable-tagger": "^1.1.11",
    "postcss": "^8.5.6",
    "tailwindcss": "^3.4.17",
    "typescript": "^5.8.3",
    "typescript-eslint": "^8.38.0",
    "vite": "^5.4.19"
  }
}


================================================
FILE: D:\barter_verse\frontend\postcss.config.js
================================================
export default {
  plugins: {
    tailwindcss: {},
    autoprefixer: {},
  },
};


================================================
FILE: D:\barter_verse\frontend\src\App.css
================================================
#root {
  max-width: 1280px;
  margin: 0 auto;
  padding: 2rem;
}

.logo {
  height: 6em;
  padding: 1.5em;
  will-change: filter;
  transition: filter 300ms;
}

.logo:hover {
  filter: drop-shadow(0 0 2em hsl(159, 60%, 22%, 0.5));
}

.logo.react:hover {
  filter: drop-shadow(0 0 2em hsl(38, 92%, 50%, 0.5));
}

@keyframes logo-spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

@media (prefers-reduced-motion: no-preference) {
  a:nth-of-type(2) .logo {
    animation: logo-spin infinite 20s linear;
  }
}

.card {
  padding: 2em;
  background: hsl(0, 0%, 100%);
  border: 1px solid hsl(210, 14%, 91%);
  border-radius: 0.5rem;
}

.read-the-docs {
  color: hsl(215, 16%, 47%);
}


================================================
FILE: D:\barter_verse\frontend\src\App.tsx
================================================
import { BrowserRouter, Routes, Route } from 'react-router-dom';
import Navbar from './components/Navbar';
import Footer from './components/Footer';
import Home from './pages/Home';
import Auth from './pages/Auth';
import Dashboard from './pages/Dashboard';
import Explore from './pages/Explore';
import PostListing from './pages/PostListing';
import SkillShare from './pages/SkillShare';
import Community from './pages/Community';
import TradeCenter from './pages/TradeCenter';
import Analytics from './pages/Analytics';
import Profile from './pages/Profile';
import EcoMap from './pages/EcoMap';         
import Quests from './pages/Quests';         
import Governance from './pages/Governance'; 
import { Toaster } from '@/components/ui/toaster';
import { AuthProvider } from '@/contexts/AuthContext';
import { CoinProvider } from '@/contexts/CoinContext';
import { TradeProvider } from '@/contexts/TradeContext';
import { ListingsProvider } from '@/contexts/ListingsContext';
import Messages from './pages/Messages';

function App() {
  return (
    <BrowserRouter>
      <div className="min-h-screen bg-background text-foreground flex flex-col">
        <AuthProvider>
          <CoinProvider>
            <TradeProvider>
              <ListingsProvider>
                <Navbar />
                <main className="flex-1 pt-16">
                  <Routes>
                    <Route path="/" element={<Home />} />
                    <Route path="/auth" element={<Auth />} />
                    <Route path="/dashboard" element={<Dashboard />} />
                    <Route path="/explore" element={<Explore />} />
                    <Route path="/post" element={<PostListing />} />
                    <Route path="/skill-share" element={<SkillShare />} />
                    <Route path="/community" element={<Community />} />
                    <Route path="/trade-center" element={<TradeCenter />} />
                    <Route path="/analytics" element={<Analytics />} />
                    <Route path="/profile" element={<Profile />} />
                    <Route path="/messages" element={<Messages />} />
                    
                    {/* New Tabs */}
                    <Route path="/map" element={<EcoMap />} />
                    <Route path="/quests" element={<Quests />} />
                    <Route path="/governance" element={<Governance />} />
                  </Routes>
                </main>
                <Footer />
                <Toaster />
              </ListingsProvider>
            </TradeProvider>
          </CoinProvider>
        </AuthProvider>
      </div>
    </BrowserRouter>
  );
}

export default App;

================================================
FILE: D:\barter_verse\frontend\src\components\ChatSystem.tsx
================================================
import React, { useState, useEffect, useRef } from 'react';
import { Send, MessageCircle, Trash2 } from 'lucide-react';

const ChatSystem = () => {
  const [conversations, setConversations] = useState<any[]>([]);
  const [selectedConversation, setSelectedConversation] = useState<string | null>(null);
  const [messages, setMessages] = useState<any[]>([]);
  const [newMessage, setNewMessage] = useState('');
  const [loading, setLoading] = useState(false);
  const [message, setMessage] = useState('');
  const [unreadCount, setUnreadCount] = useState(0);
  const [startNewChat, setStartNewChat] = useState(false);
  const [newChatUserId, setNewChatUserId] = useState('');
  const messagesEndRef = useRef<HTMLDivElement>(null);

  useEffect(() => {
    fetchConversations();
    fetchUnreadCount();
    const interval = setInterval(() => {
      fetchUnreadCount();
      if (selectedConversation) {
        fetchMessages(selectedConversation);
      }
    }, 3000); // Poll every 3 seconds
    return () => clearInterval(interval);
  }, [selectedConversation]);

  useEffect(() => {
    scrollToBottom();
  }, [messages]);

  const scrollToBottom = () => {
    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });
  };

  const fetchConversations = async () => {
    try {
      const response = await fetch('/api/chat/conversations', {
        headers: { Authorization: `Bearer ${localStorage.getItem('token')}` },
      });
      const result = await response.json();

      if (result.success) {
        setConversations(result.data || []);
      } else {
        setMessage(` ${result.message}`);
      }
    } catch (error: any) {
      setMessage(` Error: ${error.message}`);
    }
  };

  const fetchMessages = async (userId: string) => {
    try {
      const response = await fetch(`/api/chat/conversation/${userId}?limit=50`, {
        headers: { Authorization: `Bearer ${localStorage.getItem('token')}` },
      });
      const result = await response.json();

      if (result.success) {
        setMessages(result.data.messages || []);
      } else {
        setMessage(` ${result.message}`);
      }
    } catch (error: any) {
      setMessage(` Error: ${error.message}`);
    }
  };

  const fetchUnreadCount = async () => {
    try {
      const response = await fetch('/api/chat/unread-count', {
        headers: { Authorization: `Bearer ${localStorage.getItem('token')}` },
      });
      const result = await response.json();

      if (result.success) {
        setUnreadCount(result.data.unread_count);
      }
    } catch (error) {
      console.error('Error fetching unread count:', error);
    }
  };

  const handleSendMessage = async (e: React.FormEvent) => {
    e.preventDefault();

    if (!selectedConversation || !newMessage.trim()) {
      return;
    }

    try {
      setLoading(true);
      const response = await fetch('/api/chat/send', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          Authorization: `Bearer ${localStorage.getItem('token')}`,
        },
        body: JSON.stringify({
          receiver_id: selectedConversation,
          content: newMessage,
        }),
      });

      const result = await response.json();

      if (result.success) {
        setNewMessage('');
        fetchMessages(selectedConversation);
        fetchConversations();
      } else {
        setMessage(` ${result.message}`);
      }
    } catch (error: any) {
      setMessage(` Error: ${error.message}`);
    } finally {
      setLoading(false);
    }
  };

  const handleStartNewChat = async () => {
    if (!newChatUserId.trim()) {
      setMessage(' Please enter a user ID');
      return;
    }

    setSelectedConversation(newChatUserId);
    setStartNewChat(false);
    setNewChatUserId('');
    await fetchMessages(newChatUserId);
  };

  const handleDeleteMessage = async (messageId: string) => {
    if (!confirm('Delete this message?')) return;

    try {
      const response = await fetch(`/api/chat/${messageId}`, {
        method: 'DELETE',
        headers: { Authorization: `Bearer ${localStorage.getItem('token')}` },
      });

      const result = await response.json();

      if (result.success) {
        if (selectedConversation) {
          fetchMessages(selectedConversation);
        }
      } else {
        setMessage(` ${result.message}`);
      }
    } catch (error: any) {
      setMessage(` Error: ${error.message}`);
    }
  };

  const currentUser = localStorage.getItem('userId'); // Assume this is stored

  return (
    <div className="max-w-6xl mx-auto p-6">
      <h1 className="text-3xl font-bold mb-8 flex items-center gap-2 text-foreground">
        <MessageCircle /> Direct Messaging
        {unreadCount > 0 && (
          <span className="ml-2 bg-destructive text-white px-3 py-1 rounded-full text-sm font-medium">
            {unreadCount} Unread
          </span>
        )}
      </h1>

      {message && (
        <div className="mb-6 p-4 rounded-lg bg-blue-50 border border-blue-200">
          {message}
        </div>
      )}

      <div className="grid grid-cols-1 md:grid-cols-3 gap-6 h-[600px]">
        {/* Conversations List */}
        <div className="card-upgrade rounded-lg overflow-hidden flex flex-col">
          <div className="p-4 border-b" style={{ background: 'hsl(var(--section-background))' }}>
            <h2 className="text-lg font-semibold mb-3 text-foreground">Conversations</h2>
            <button
              onClick={() => setStartNewChat(!startNewChat)}
              className="w-full btn-primary text-white py-2 rounded-lg text-sm font-medium"
            >
              {startNewChat ? ' Cancel' : ' New Chat'}
            </button>

            {startNewChat && (
              <div className="mt-3 flex gap-2">
                <input
                  type="text"
                  placeholder="User ID"
                  value={newChatUserId}
                  onChange={(e) => setNewChatUserId(e.target.value)}
                  className="flex-1 px-3 py-2 border border-[hsl(var(--border))] rounded-lg text-sm text-foreground bg-card"
                />
                <button
                  onClick={handleStartNewChat}
                  className="btn-secondary px-3 py-2 text-sm"
                >
                  
                </button>
              </div>
            )}
          </div>

          <div className="flex-1 overflow-y-auto">
            {conversations.length > 0 ? (
              conversations.map((conv) => (
                <div
                  key={conv.other_user_id}
                  onClick={() => setSelectedConversation(conv.other_user_id)}
                  className={`p-4 border-b cursor-pointer transition ${
                    selectedConversation === conv.other_user_id
                      ? 'bg-section-background border-l-4' + ' border-l-[hsl(var(--primary))]'
                      : 'hover:bg-section-background'
                  }`}
                >
                  <div className="flex items-start justify-between">
                    <div className="flex-1">
                      <p className="font-semibold">{conv.other_user_id}</p>
                      <p className="text-sm text-muted-foreground truncate">{conv.last_message || 'No messages'}</p>
                      {conv.last_message_at && (
                        <p className="text-xs text-muted-foreground mt-1">{new Date(conv.last_message_at).toLocaleDateString()}</p>
                      )}
                    </div>
                    {conv.unread_count > 0 && (
                      <span className="ml-2 bg-destructive text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-medium">
                        {conv.unread_count}
                      </span>
                    )}
                  </div>
                </div>
              ))
            ) : (
              <div className="p-4 text-center text-gray-500">
                <p>No conversations yet</p>
              </div>
            )}
          </div>
        </div>

        {/* Chat Area */}
        <div className="md:col-span-2 card-upgrade flex flex-col">
          {selectedConversation ? (
            <>
              {/* Header */}
              <div className="p-4 border-b" style={{ background: 'hsl(var(--section-background))' }}>
                <h3 className="text-lg font-semibold text-foreground">{selectedConversation}</h3>
              </div>

              {/* Messages */}
              <div className="flex-1 overflow-y-auto p-4 space-y-4">
                {messages.length > 0 ? (
                  messages.map((msg) => (
                    <div
                      key={msg.id}
                      className={`flex ${msg.sender_id === currentUser ? 'justify-end' : 'justify-start'}`}
                    >
                      <div
                        className={`max-w-xs px-4 py-2 rounded-lg ${
                          msg.sender_id === currentUser
                            ? 'bg-secondary text-white'
                            : 'bg-card text-foreground'
                        }`}
                      >
                        <p className="text-sm">{msg.content}</p>
                        <p className="text-xs mt-1 opacity-70">
                          {new Date(msg.created_at).toLocaleTimeString([], {
                            hour: '2-digit',
                            minute: '2-digit',
                          })}
                        </p>
                        {msg.sender_id === currentUser && (
                          <button
                            onClick={() => handleDeleteMessage(msg.id)}
                            className="mt-1 text-xs hover:underline text-muted-foreground"
                          >
                            Delete
                          </button>
                        )}
                      </div>
                    </div>
                  ))
                ) : (
                  <div className="text-center text-gray-500 mt-8">
                    <p>No messages yet. Start the conversation!</p>
                  </div>
                )}
                <div ref={messagesEndRef} />
              </div>

              {/* Input */}
              <form onSubmit={handleSendMessage} className="p-4 border-t" style={{ background: 'hsl(var(--section-background))' }}>
                <div className="flex gap-2">
                  <input
                    type="text"
                    value={newMessage}
                    onChange={(e) => setNewMessage(e.target.value)}
                    placeholder="Type a message..."
                    className="flex-1 px-4 py-2 border border-[hsl(var(--border))] rounded-lg focus:outline-none bg-card text-foreground"
                  />
                  <button
                    type="submit"
                    disabled={loading || !newMessage.trim()}
                    className="btn-primary disabled:opacity-50 flex items-center gap-2 px-6"
                  >
                    <Send size={18} />
                    Send
                  </button>
                </div>
              </form>
            </>
          ) : (
            <div className="flex items-center justify-center h-full text-gray-500">
              <p>Select or start a conversation</p>
            </div>
          )}
        </div>
      </div>
    </div>
  );
};

export default ChatSystem;


================================================
FILE: D:\barter_verse\frontend\src\components\Footer.tsx
================================================
import { Link } from 'react-router-dom';
import { Github, Twitter, Linkedin, Repeat } from 'lucide-react';

export default function Footer() {
  const currentYear = new Date().getFullYear();

  return (
    <footer className="bg-[#020617] border-t border-white/5 pt-12 pb-8">
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        
        {/* Top Section: Brand & Main Nav */}
        <div className="flex flex-col md:flex-row justify-between items-center gap-6 mb-8">
          
          {/* Brand */}
          <div className="flex items-center gap-2">
            <div className="w-8 h-8 rounded-lg bg-emerald-500/10 flex items-center justify-center border border-emerald-500/20">
              <Repeat className="w-5 h-5 text-emerald-400" />
            </div>
            <span className="text-xl font-bold text-white tracking-tight">BarterVerse</span>
          </div>

          {/* Minimal Navigation */}
          <nav className="flex gap-8 text-sm font-medium">
            <Link to="/explore" className="text-slate-400 hover:text-emerald-400 transition-colors">Marketplace</Link>
            <Link to="/map" className="text-slate-400 hover:text-emerald-400 transition-colors">EcoMap</Link>
            <Link to="/governance" className="text-slate-400 hover:text-emerald-400 transition-colors">Governance</Link>
            <Link to="/about" className="text-slate-400 hover:text-emerald-400 transition-colors">About</Link>
          </nav>
        </div>

        {/* Divider */}
        <div className="w-full h-px bg-white/5 mb-8" />

        {/* Bottom Section: Copyright & Socials */}
        <div className="flex flex-col md:flex-row justify-between items-center gap-4 text-xs text-slate-500">
          
          <div className="flex gap-6">
            <span> {currentYear} BarterVerse Inc.</span>
            <Link to="/privacy" className="hover:text-slate-300">Privacy Policy</Link>
            <Link to="/terms" className="hover:text-slate-300">Terms of Service</Link>
          </div>

          {/* Social Icons */}
          <div className="flex gap-4">
            <a href="#" className="p-2 rounded-full hover:bg-white/5 hover:text-white transition-colors">
              <Twitter className="w-4 h-4" />
            </a>
            <a href="#" className="p-2 rounded-full hover:bg-white/5 hover:text-white transition-colors">
              <Github className="w-4 h-4" />
            </a>
            <a href="#" className="p-2 rounded-full hover:bg-white/5 hover:text-white transition-colors">
              <Linkedin className="w-4 h-4" />
            </a>
          </div>

        </div>
      </div>
    </footer>
  );
}

================================================
FILE: D:\barter_verse\frontend\src\components\ListingCard.tsx
================================================
import { useState, useEffect } from 'react';
import { useNavigate, useSearchParams } from 'react-router-dom';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { Textarea } from '@/components/ui/textarea';
import { Label } from '@/components/ui/label';
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';
import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';
import { ImagePlus, X, Loader2, Save, ArrowLeft } from 'lucide-react';
import { toast } from 'sonner';
import { api } from '@/lib/api';

const CATEGORIES = ['Electronics', 'Furniture', 'Clothing', 'Books', 'Services', 'Skills', 'Vehicles', 'Other'];

export default function PostListing() {
  const navigate = useNavigate();
  const [searchParams] = useSearchParams();
  const editId = searchParams.get('edit'); // Get ID from URL
  
  const [loading, setLoading] = useState(false);
  const [fetching, setFetching] = useState(!!editId);
  const [formData, setFormData] = useState({
    title: '',
    description: '',
    category: '',
    price_bc: '',
    location: '',
    images: [] as string[]
  });

  // 1. Fetch Existing Data if Editing
  useEffect(() => {
    if (!editId) return;

    const loadListing = async () => {
      try {
        setFetching(true);
        const response = await api.getListingById(editId);
        const data = response.data.data;
        
        setFormData({
          title: data.title,
          description: data.description,
          category: data.category,
          price_bc: data.price_bc.toString(),
          location: data.location || '',
          images: data.images || (data.image_url ? [data.image_url] : [])
        });
      } catch (error) {
        toast.error("Could not load listing details");
        navigate('/post'); // Fallback to create mode
      } finally {
        setFetching(false);
      }
    };

    loadListing();
  }, [editId, navigate]);

  const handleImageUpload = (e: React.ChangeEvent<HTMLInputElement>) => {
    const files = e.target.files;
    if (!files) return;

    // Simple local preview logic (In production, upload to Cloudinary/AWS S3 here)
    Array.from(files).forEach(file => {
        const reader = new FileReader();
        reader.onloadend = () => {
            setFormData(prev => ({
                ...prev,
                images: [...prev.images, reader.result as string].slice(0, 4) // Max 4 images
            }));
        };
        reader.readAsDataURL(file);
    });
  };

  const removeImage = (index: number) => {
    setFormData(prev => ({
        ...prev,
        images: prev.images.filter((_, i) => i !== index)
    }));
  };

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    if (!formData.title || !formData.category || !formData.price_bc) {
        toast.error("Please fill in all required fields");
        return;
    }

    setLoading(true);
    try {
        const payload = {
            ...formData,
            price_bc: Number(formData.price_bc)
        };

        if (editId) {
            // UPDATE MODE
            await api.updateListing(editId, payload);
            toast.success("Listing updated successfully!");
        } else {
            // CREATE MODE
            await api.createListing(payload);
            toast.success("Item posted successfully!");
        }
        
        navigate('/profile'); // Go back to inventory
    } catch (error: any) {
        toast.error(error.response?.data?.message || "Something went wrong");
    } finally {
        setLoading(false);
    }
  };

  if (fetching) {
      return (
          <div className="min-h-screen bg-[#020617] flex items-center justify-center">
              <Loader2 className="w-8 h-8 text-emerald-500 animate-spin" />
          </div>
      );
  }

  return (
    <div className="min-h-screen py-12 px-4 bg-[#020617] relative">
      {/* Background Glow */}
      <div className="absolute top-0 right-0 w-[500px] h-[500px] bg-emerald-500/5 rounded-full blur-[100px] -z-10" />

      <div className="max-w-3xl mx-auto">
        <Button 
            variant="ghost" 
            onClick={() => navigate(-1)} 
            className="mb-6 text-slate-400 hover:text-white pl-0 hover:bg-transparent"
        >
            <ArrowLeft className="w-4 h-4 mr-2" /> Back
        </Button>

        <Card className="glass border-white/10">
          <CardHeader>
            <CardTitle className="text-2xl font-bold text-white flex items-center gap-2">
                {editId ? <Edit2 className="w-6 h-6 text-emerald-400" /> : <ImagePlus className="w-6 h-6 text-emerald-400" />}
                {editId ? 'Edit Listing' : 'Post New Item'}
            </CardTitle>
          </CardHeader>
          <CardContent>
            <form onSubmit={handleSubmit} className="space-y-6">
              
              {/* Image Upload */}
              <div className="space-y-3">
                <Label className="text-slate-300">Photos (Max 4)</Label>
                <div className="flex flex-wrap gap-4">
                    {formData.images.map((img, idx) => (
                        <div key={idx} className="relative w-24 h-24 rounded-lg overflow-hidden border border-slate-700 group">
                            <img src={img} alt="Preview" className="w-full h-full object-cover" />
                            <button 
                                type="button"
                                onClick={() => removeImage(idx)}
                                className="absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity text-white"
                            >
                                <X className="w-6 h-6" />
                            </button>
                        </div>
                    ))}
                    {formData.images.length < 4 && (
                        <label className="w-24 h-24 rounded-lg border-2 border-dashed border-slate-700 hover:border-emerald-500 hover:bg-emerald-500/5 flex flex-col items-center justify-center cursor-pointer transition-all group">
                            <ImagePlus className="w-6 h-6 text-slate-500 group-hover:text-emerald-500" />
                            <span className="text-[10px] text-slate-500 mt-1">Add Photo</span>
                            <input type="file" accept="image/*" multiple className="hidden" onChange={handleImageUpload} />
                        </label>
                    )}
                </div>
              </div>

              {/* Basic Info */}
              <div className="grid gap-6 md:grid-cols-2">
                <div className="space-y-2">
                    <Label htmlFor="title" className="text-slate-300">Title</Label>
                    <Input 
                        id="title" 
                        value={formData.title}
                        onChange={(e) => setFormData({...formData, title: e.target.value})}
                        placeholder="e.g. Vintage Camera" 
                        className="bg-slate-950 border-slate-800 text-white" 
                    />
                </div>
                <div className="space-y-2">
                    <Label className="text-slate-300">Category</Label>
                    <Select 
                        value={formData.category} 
                        onValueChange={(val) => setFormData({...formData, category: val})}
                    >
                        <SelectTrigger className="bg-slate-950 border-slate-800 text-white">
                            <SelectValue placeholder="Select Category" />
                        </SelectTrigger>
                        <SelectContent className="bg-slate-900 border-slate-800 text-white">
                            {CATEGORIES.map(cat => (
                                <SelectItem key={cat} value={cat}>{cat}</SelectItem>
                            ))}
                        </SelectContent>
                    </Select>
                </div>
              </div>

              {/* Price & Location */}
              <div className="grid gap-6 md:grid-cols-2">
                <div className="space-y-2">
                    <Label htmlFor="price" className="text-slate-300">Value (Barter Coins)</Label>
                    <div className="relative">
                        <Input 
                            id="price" 
                            type="number"
                            value={formData.price_bc}
                            onChange={(e) => setFormData({...formData, price_bc: e.target.value})}
                            placeholder="0" 
                            className="bg-slate-950 border-slate-800 text-white pl-8" 
                        />
                        <span className="absolute left-3 top-2.5 text-slate-500 text-sm">BC</span>
                    </div>
                </div>
                <div className="space-y-2">
                    <Label htmlFor="location" className="text-slate-300">Location</Label>
                    <Input 
                        id="location" 
                        value={formData.location}
                        onChange={(e) => setFormData({...formData, location: e.target.value})}
                        placeholder="City, Country or 'Remote'" 
                        className="bg-slate-950 border-slate-800 text-white" 
                    />
                </div>
              </div>

              {/* Description */}
              <div className="space-y-2">
                <Label htmlFor="desc" className="text-slate-300">Description</Label>
                <Textarea 
                    id="desc" 
                    value={formData.description}
                    onChange={(e) => setFormData({...formData, description: e.target.value})}
                    placeholder="Describe condition, age, reason for trading..." 
                    className="bg-slate-950 border-slate-800 text-white min-h-[150px]" 
                />
              </div>

              {/* Submit Action */}
              <div className="pt-4">
                <Button type="submit" disabled={loading} className="w-full bg-emerald-600 hover:bg-emerald-500 text-white h-12 text-lg font-bold shadow-lg shadow-emerald-900/20">
                    {loading ? <Loader2 className="w-5 h-5 animate-spin" /> : <Save className="w-5 h-5 mr-2" />}
                    {editId ? 'Update Listing' : 'Post Listing'}
                </Button>
              </div>

            </form>
          </CardContent>
        </Card>
      </div>
    </div>
  );
}

// Icon helper
import { Edit2 } from 'lucide-react';

================================================
FILE: D:\barter_verse\frontend\src\components\ListingModal.tsx
================================================
import { Dialog, DialogContent, DialogClose } from '@/components/ui/dialog';
import { Button } from '@/components/ui/button';
import { Badge } from '@/components/ui/badge';
import { ScrollArea } from '@/components/ui/scroll-area';
import { Avatar, AvatarFallback, AvatarImage } from '@/components/ui/avatar';
import { MapPin, User, ShieldCheck, X, ArrowRight, Star, Calendar, Share2, Heart } from 'lucide-react';
import { useState } from 'react';
import MakeOfferDialog from './MakeOfferDialog';
import { useAuth } from '@/contexts/AuthContext';

interface ListingModalProps {
  listing: any; // Using 'any' for flexibility with your current context types
  isOpen: boolean;
  onClose: () => void;
}

export default function ListingModal({ listing, isOpen, onClose }: ListingModalProps) {
  const { user } = useAuth();
  const [isOfferOpen, setIsOfferOpen] = useState(false);

  if (!listing) return null;

  const isOwner = user?.id === listing.owner_id;

  return (
    <>
      <Dialog open={isOpen} onOpenChange={onClose}>
        <DialogContent className="max-w-4xl p-0 bg-[#0B1121] border-slate-800 text-slate-200 overflow-hidden h-[90vh] md:h-auto md:max-h-[85vh] flex flex-col md:flex-row gap-0">
          
          {/* Close Button (Mobile friendly) */}
          <button 
             onClick={onClose} 
             className="absolute right-4 top-4 z-50 p-2 bg-black/50 backdrop-blur-md rounded-full text-white hover:bg-white/20 transition-colors"
          >
             <X className="w-5 h-5" />
          </button>

          {/* LEFT: Image Gallery */}
          <div className="w-full md:w-1/2 h-64 md:h-auto bg-slate-900 relative group">
             <img 
               src={listing.images?.[0] || 'https://images.unsplash.com/photo-1556740758-90de374c12ad'} 
               alt={listing.title} 
               className="w-full h-full object-cover"
             />
             <div className="absolute inset-0 bg-gradient-to-t from-[#0B1121] to-transparent md:hidden" />
             
             {/* Floating Price Badge */}
             <div className="absolute bottom-4 left-4 md:bottom-6 md:left-6 px-4 py-2 bg-black/60 backdrop-blur-xl rounded-xl border border-white/10 flex items-center gap-2">
                <div className="w-2 h-2 rounded-full bg-emerald-500 animate-pulse" />
                <span className="text-emerald-400 font-bold text-lg">{listing.price_bc} BC</span>
             </div>
          </div>

          {/* RIGHT: Content & Actions */}
          <div className="w-full md:w-1/2 flex flex-col h-full bg-[#0B1121]">
             <ScrollArea className="flex-1 p-6 md:p-8">
                <div className="space-y-6">
                   
                   {/* Header Info */}
                   <div>
                      <div className="flex items-center gap-2 mb-3">
                         <Badge variant="outline" className="bg-emerald-500/10 text-emerald-400 border-emerald-500/20 px-3 py-1">
                            {listing.category}
                         </Badge>
                         {listing.verified && (
                            <Badge variant="outline" className="bg-blue-500/10 text-blue-400 border-blue-500/20 gap-1 pl-1">
                               <ShieldCheck className="w-3 h-3" /> Verified
                            </Badge>
                         )}
                      </div>
                      <h2 className="text-3xl font-extrabold text-white leading-tight mb-2">{listing.title}</h2>
                      <div className="flex items-center text-slate-400 text-sm gap-4">
                         <span className="flex items-center gap-1"><MapPin className="w-4 h-4" /> {listing.location || 'Remote'}</span>
                         <span className="flex items-center gap-1"><Calendar className="w-4 h-4" /> Posted 2d ago</span>
                      </div>
                   </div>

                   {/* Description */}
                   <div className="space-y-2">
                      <h3 className="text-sm font-bold text-slate-500 uppercase tracking-wider">Description</h3>
                      <p className="text-slate-300 leading-relaxed whitespace-pre-wrap">
                         {listing.description || 'No detailed description provided by the seller.'}
                      </p>
                   </div>

                   {/* Seller Info Card */}
                   <div className="p-4 rounded-2xl bg-slate-900/50 border border-slate-800 flex items-center gap-4">
                      <Avatar className="w-12 h-12 border-2 border-slate-700">
                         <AvatarImage src={listing.owner?.avatar_url} />
                         <AvatarFallback className="bg-slate-800 text-slate-400">
                            <User className="w-6 h-6" />
                         </AvatarFallback>
                      </Avatar>
                      <div className="flex-1">
                         <div className="font-bold text-white text-sm">Seller Info</div>
                         <div className="text-xs text-slate-500">Member since 2024</div>
                      </div>
                      <div className="text-right">
                         <div className="flex items-center text-amber-400 font-bold text-sm gap-1">
                            <Star className="w-4 h-4 fill-current" /> 4.9
                         </div>
                         <div className="text-[10px] text-slate-500">24 Trades</div>
                      </div>
                   </div>
                </div>
             </ScrollArea>

             {/* Action Footer */}
             <div className="p-6 border-t border-slate-800 bg-[#0B1121] z-10 flex gap-3">
                <Button variant="outline" className="flex-1 border-slate-700 hover:bg-slate-800 text-slate-300">
                   <Share2 className="w-4 h-4 mr-2" /> Share
                </Button>
                
                <Button 
                   onClick={() => setIsOfferOpen(true)}
                   disabled={isOwner}
                   className={`flex-[2] font-bold text-lg h-12 ${
                      isOwner 
                      ? 'bg-slate-800 text-slate-500 cursor-not-allowed' 
                      : 'bg-emerald-600 hover:bg-emerald-500 text-white shadow-lg shadow-emerald-500/20'
                   }`}
                >
                   {isOwner ? (
                      'Manage Listing'
                   ) : (
                      <>
                         Make an Offer <ArrowRight className="ml-2 w-5 h-5" />
                      </>
                   )}
                </Button>
             </div>
          </div>
        </DialogContent>
      </Dialog>

      {/* Connection to the Transaction Logic */}
      <MakeOfferDialog 
         isOpen={isOfferOpen} 
         onClose={() => setIsOfferOpen(false)} 
         listing={listing} 
      />
    </>
  );
}

================================================
FILE: D:\barter_verse\frontend\src\components\LocationMatching.tsx
================================================
import React, { useState, useEffect } from 'react';
import { MapPin, Users, Package } from 'lucide-react';

const LocationMatching = () => {
  const [city, setCity] = useState('');
  const [town, setTown] = useState('');
  const [state, setState] = useState('');
  const [country, setCountry] = useState('');
  const [pincode, setPincode] = useState('');
  const [latitude, setLatitude] = useState<number | null>(null);
  const [longitude, setLongitude] = useState<number | null>(null);
  const [category, setCategory] = useState('');
  const [radius, setRadius] = useState(50);
  const [searchType, setSearchType] = useState<'traders' | 'listings'>('traders');
  const [results, setResults] = useState<any[]>([]);
  const [loading, setLoading] = useState(false);
  const [message, setMessage] = useState('');

  const useCurrentLocation = () => {
    if (!navigator.geolocation) {
      setMessage(' Geolocation is not supported by your browser');
      return;
    }

    setLoading(true);
    navigator.geolocation.getCurrentPosition(
      (position) => {
        setLatitude(position.coords.latitude);
        setLongitude(position.coords.longitude);
        setMessage(' Location detected!');
        setLoading(false);
      },
      () => {
        setMessage(' Failed to access your location');
        setLoading(false);
      }
    );
  };

  const updateLocation = async () => {
    if (!country) {
      setMessage(' Please enter at least country and pincode/city');
      return;
    }

    try {
      setLoading(true);
      const response = await fetch('/api/location/update-location', {
        method: 'PUT',
        headers: {
          'Content-Type': 'application/json',
          Authorization: `Bearer ${localStorage.getItem('token')}`,
        },
        body: JSON.stringify({
          city: city || undefined,
          town: town || undefined,
          state: state || undefined,
          country,
          pincode: pincode || undefined,
        }),
      });

      const result = await response.json();
      if (result.success) {
        setMessage(' Location updated successfully!');
      } else {
        setMessage(` ${result.message}`);
      }
    } catch (error: any) {
      setMessage(` Error: ${error.message}`);
    } finally {
      setLoading(false);
    }
  };

  const searchNearby = async () => {
    if (!country) {
      setMessage(' Please set your location first');
      return;
    }

    try {
      setLoading(true);
      const endpoint =
        searchType === 'traders'
          ? `/api/location/nearby-traders`
          : `/api/location/nearby-listings`;

      const response = await fetch(endpoint, {
        headers: { Authorization: `Bearer ${localStorage.getItem('token')}` },
      });

      const result = await response.json();
      if (result.success) {
        setResults(result.data);
        setMessage(` Found ${result.data.length} results in your area`);
      } else {
        setMessage(` ${result.message}`);
      }
    } catch (error: any) {
      setMessage(` Error: ${error.message}`);
    } finally {
      setLoading(false);
    }
  };

  return (
    <div className="max-w-6xl mx-auto p-6">
      <h1 className="text-3xl font-bold mb-8"> Location-Based Matching</h1>

      {message && (
        <div className="mb-6 p-4 rounded-lg bg-blue-50 border border-blue-200">
          {message}
        </div>
      )}

      {/* Location Setup */}
      <div className="bg-white rounded-lg shadow-md p-6 mb-8">
        <h2 className="text-xl font-semibold mb-4"> Set Your Location</h2>

        <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
          <div>
            <label className="block text-sm font-medium mb-2">Pincode</label>
            <input
              type="text"
              value={pincode}
              onChange={(e) => setPincode(e.target.value)}
              placeholder="e.g., 560001"
              className="w-full px-3 py-2 border border-gray-300 rounded-lg"
            />
          </div>

          <div>
            <label className="block text-sm font-medium mb-2">City</label>
            <input
              type="text"
              value={city}
              onChange={(e) => setCity(e.target.value)}
              placeholder="e.g., Bangalore"
              className="w-full px-3 py-2 border border-gray-300 rounded-lg"
            />
          </div>

          <div>
            <label className="block text-sm font-medium mb-2">Town</label>
            <input
              type="text"
              value={town}
              onChange={(e) => setTown(e.target.value)}
              placeholder="e.g., Whitefield"
              className="w-full px-3 py-2 border border-gray-300 rounded-lg"
            />
          </div>
        </div>

        <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
          <div>
            <label className="block text-sm font-medium mb-2">State/Province</label>
            <input
              type="text"
              value={state}
              onChange={(e) => setState(e.target.value)}
              placeholder="e.g., Karnataka"
              className="w-full px-3 py-2 border border-gray-300 rounded-lg"
            />
          </div>

          <div>
            <label className="block text-sm font-medium mb-2">Country *</label>
            <input
              type="text"
              value={country}
              onChange={(e) => setCountry(e.target.value)}
              placeholder="e.g., India"
              className="w-full px-3 py-2 border border-gray-300 rounded-lg font-semibold"
            />
          </div>
        </div>

        <button
          onClick={updateLocation}
          disabled={loading}
          className="w-full bg-green-500 hover:bg-green-600 disabled:bg-gray-400 text-white py-2 rounded-lg font-medium"
        >
          {loading ? ' Saving...' : ' Save Location'}
        </button>
      </div>

      {/* Search Settings */}
      <div className="bg-white rounded-lg shadow-md p-6 mb-8">
        <h2 className="text-xl font-semibold mb-4"> Find Nearby</h2>

        <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
          <div>
            <label className="block text-sm font-medium mb-2">Search Type</label>
            <select
              value={searchType}
              onChange={(e) => setSearchType(e.target.value as 'traders' | 'listings')}
              className="w-full px-3 py-2 border border-gray-300 rounded-lg"
            >
              <option value="traders">Nearby Traders</option>
              <option value="listings">Nearby Listings</option>
            </select>
          </div>

          <div>
            <label className="block text-sm font-medium mb-2">Category (Optional)</label>
            <input
              type="text"
              value={category}
              onChange={(e) => setCategory(e.target.value)}
              placeholder="e.g., photography"
              className="w-full px-3 py-2 border border-gray-300 rounded-lg"
            />
          </div>

          <div>
            <label className="block text-sm font-medium mb-2">Radius (km)</label>
            <input
              type="number"
              value={radius}
              onChange={(e) => setRadius(parseInt(e.target.value) || 50)}
              min="1"
              max="500"
              className="w-full px-3 py-2 border border-gray-300 rounded-lg"
            />
          </div>

          <div className="flex items-end">
            <button
              onClick={searchNearby}
              disabled={loading}
              className="w-full bg-blue-500 hover:bg-blue-600 disabled:bg-gray-400 text-white py-2 rounded-lg font-medium"
            >
              {loading ? ' Searching...' : ' Search'}
            </button>
          </div>
        </div>
      </div>

      {/* Results */}
      {results.length > 0 && (
        <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
          {results.map((result) =>
            searchType === 'traders' ? (
              <div key={result.id} className="bg-white rounded-lg shadow-md p-6">
                <div className="flex items-start gap-4">
                  {result.avatar_url && (
                    <img
                      src={result.avatar_url}
                      alt={result.username}
                      className="w-16 h-16 rounded-full"
                    />
                  )}
                  <div className="flex-1">
                    <h3 className="text-lg font-semibold">{result.username}</h3>
                    <p className="text-gray-600">
                       {result.rating.toFixed(1)}   {result.distance.toFixed(1)} km away
                    </p>
                    {result.city && (
                      <p className="text-sm text-gray-500">
                         {result.city}, {result.country}
                      </p>
                    )}
                    {result.listings.length > 0 && (
                      <div className="mt-3">
                        <p className="text-sm font-medium">Skills:</p>
                        {result.listings.map((listing: any) => (
                          <span
                            key={listing.id}
                            className="inline-block bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded mr-2 mt-1"
                          >
                            {listing.title}
                          </span>
                        ))}
                      </div>
                    )}
                  </div>
                </div>
              </div>
            ) : (
              <div key={result.id} className="bg-white rounded-lg shadow-md p-6">
                {result.image_url && (
                  <img
                    src={result.image_url}
                    alt={result.title}
                    className="w-full h-40 object-cover rounded-lg mb-4"
                  />
                )}
                <h3 className="text-lg font-semibold">{result.title}</h3>
                <p className="text-gray-600 text-sm mt-2">{result.description}</p>
                <div className="mt-4 flex justify-between items-center">
                  <span className="text-sm font-medium text-blue-600">{result.category}</span>
                  <span className="text-sm text-gray-500"> {result.distance.toFixed(1)} km</span>
                </div>
                <div className="mt-3 pt-3 border-t">
                  <p className="text-sm">
                     {result.owner.username} ( {result.owner.rating.toFixed(1)})
                  </p>
                </div>
              </div>
            )
          )}
        </div>
      )}

      {results.length === 0 && !loading && message && (
        <div className="text-center py-12">
          <p className="text-gray-500 text-lg">No results found. Try adjusting your search radius.</p>
        </div>
      )}
    </div>
  );
};

export default LocationMatching;


================================================
FILE: D:\barter_verse\frontend\src\components\MakeOfferDialog.tsx
================================================
import { useState } from 'react';
import { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription, DialogFooter } from '@/components/ui/dialog';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { Label } from '@/components/ui/label';
import { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';
import { useCoins } from '@/contexts/CoinContext';
import { useTrade } from '@/contexts/TradeContext';
import { Loader2, Coins, ArrowLeftRight, Package } from 'lucide-react';
import { toast } from 'sonner';

interface MakeOfferDialogProps {
  isOpen: boolean;
  onClose: () => void;
  listing: any;
}

export default function MakeOfferDialog({ isOpen, onClose, listing }: MakeOfferDialogProps) {
  const { balance } = useCoins();
  const { createTrade } = useTrade();
  const [offerType, setOfferType] = useState('coins');
  const [offerAmount, setOfferAmount] = useState<string>('');
  const [isSubmitting, setIsSubmitting] = useState(false);

  // Safety Check: If no listing data, return null to prevent crash
  if (!listing) return null;

  // Safe Access to price
  const listingPrice = listing.price_bc ?? 0;

  const handleSubmit = async () => {
    setIsSubmitting(true);

    try {
      let tradeData: any = {
        listingId: listing.id,
        responderUserId: listing.owner_id, 
      };

      if (offerType === 'coins') {
        const amount = parseInt(offerAmount);
        if (isNaN(amount) || amount <= 0) {
          throw new Error('Please enter a valid coin amount');
        }
        if (amount > balance) {
          throw new Error(`Insufficient funds. You have ${balance} BC.`);
        }
        tradeData.proposedCoins = amount;
      }

      const success = await createTrade(tradeData);
      if (success) {
        onClose();
        setOfferAmount('');
      }
    } catch (error: any) {
      toast.error(error.message || 'Failed to send offer');
    } finally {
      setIsSubmitting(false);
    }
  };

  return (
    <Dialog open={isOpen} onOpenChange={onClose}>
      <DialogContent className="bg-[#0B1121] border-slate-800 text-white sm:max-w-md">
        <DialogHeader>
          <DialogTitle className="flex items-center gap-2 text-xl">
            <span className="text-emerald-400"></span> Make an Offer
          </DialogTitle>
          <DialogDescription className="text-slate-400">
            You are offering on <strong>{listing.title}</strong> (Listed for {listingPrice} BC)
          </DialogDescription>
        </DialogHeader>

        <Tabs defaultValue="coins" onValueChange={setOfferType} className="w-full mt-4">
          <TabsList className="bg-slate-900 w-full border border-slate-800">
            <TabsTrigger value="coins" className="flex-1 data-[state=active]:bg-emerald-600 text-xs">
               <Coins className="w-3 h-3 mr-2" /> Pay with Coins
            </TabsTrigger>
            <TabsTrigger value="item" className="flex-1 data-[state=active]:bg-blue-600 text-xs disabled:opacity-50" disabled>
               <Package className="w-3 h-3 mr-2" /> Trade an Item (Soon)
            </TabsTrigger>
          </TabsList>

          <TabsContent value="coins" className="space-y-4 py-4">
             <div className="space-y-2">
                <Label className="text-xs text-slate-400 uppercase font-bold">Your Offer (BC)</Label>
                <div className="relative">
                   <Coins className="absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-amber-400" />
                   <Input 
                      type="number" 
                      // FIX: Safe access to string conversion
                      placeholder={listingPrice.toString()} 
                      value={offerAmount}
                      onChange={(e) => setOfferAmount(e.target.value)}
                      className="pl-10 bg-slate-950 border-slate-700 text-white focus:ring-emerald-500/50"
                   />
                </div>
                <div className="flex justify-between text-xs mt-2">
                   <span className="text-slate-500">Asking Price: {listingPrice} BC</span>
                   <span className={`${balance < parseInt(offerAmount || '0') ? 'text-red-400' : 'text-emerald-400'}`}>
                      Your Balance: {balance} BC
                   </span>
                </div>
             </div>
          </TabsContent>
          
          <TabsContent value="item" className="py-8 text-center text-slate-500">
             <Package className="w-12 h-12 mx-auto mb-3 opacity-20" />
             <p>Select an item from your inventory to trade.</p>
          </TabsContent>
        </Tabs>

        <DialogFooter className="mt-4 gap-2 sm:gap-0">
          <Button variant="ghost" onClick={onClose} className="text-slate-400 hover:text-white">Cancel</Button>
          <Button onClick={handleSubmit} disabled={isSubmitting} className="bg-emerald-600 hover:bg-emerald-500 text-white w-full sm:w-auto">
            {isSubmitting ? <Loader2 className="w-4 h-4 animate-spin mr-2" /> : <ArrowLeftRight className="w-4 h-4 mr-2" />}
            Send Offer
          </Button>
        </DialogFooter>
      </DialogContent>
    </Dialog>
  );
}

================================================
FILE: D:\barter_verse\frontend\src\components\Navbar.tsx
================================================
import { useState, useEffect } from 'react';
import { Link, useLocation } from 'react-router-dom';
import { Button } from '@/components/ui/button';
import { useAuth } from '@/contexts/AuthContext';
import { 
  Menu, X, Plus, User, LogOut, LayoutDashboard, 
  Compass, Zap, MessageSquare, Map as MapIcon, 
  Swords, ChevronDown, Bell, Vote, Repeat, CheckCircle
} from 'lucide-react';
import {
  DropdownMenu,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuLabel,
  DropdownMenuSeparator,
  DropdownMenuTrigger,
} from '@/components/ui/dropdown-menu';
import { Avatar, AvatarFallback, AvatarImage } from '@/components/ui/avatar';
// Importing logo from src/logo.png (ensure the file exists there)
import logoImg from '../logo.png'; 

export default function Navbar() {
  const { user, signOut, isAuthenticated } = useAuth();
  const location = useLocation();
  const [isOpen, setIsOpen] = useState(false);
  const [scrolled, setScrolled] = useState(false);

  // Handle scroll effect for glass transition
  useEffect(() => {
    const handleScroll = () => setScrolled(window.scrollY > 20);
    window.addEventListener('scroll', handleScroll);
    return () => window.removeEventListener('scroll', handleScroll);
  }, []);

  // Close mobile menu on route change
  useEffect(() => setIsOpen(false), [location]);

  // Navigation Links
  const navLinks = [
    { name: 'Explore', path: '/explore', icon: <Compass className="w-4 h-4" /> },
    { name: 'Map', path: '/map', icon: <MapIcon className="w-4 h-4" /> },
    { name: 'Skills', path: '/skill-share', icon: <Zap className="w-4 h-4" /> },
    { name: 'Quests', path: '/quests', icon: <Swords className="w-4 h-4" /> },
    { name: 'Community', path: '/community', icon: <MessageSquare className="w-4 h-4" /> },
  ];

  const isActive = (path: string) => location.pathname === path;

  return (
    <nav className={`fixed top-0 w-full z-50 transition-all duration-500 ease-in-out ${
      scrolled 
        ? 'bg-[#020617]/80 backdrop-blur-xl border-b border-white/5 shadow-lg shadow-emerald-900/5 py-2' 
        : 'bg-transparent py-4'
    }`}>
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div className="flex justify-between items-center h-16">
          
          {/* Logo Section */}
          <Link to="/" className="flex items-center gap-3 group relative z-10">
            <div className="relative">
               <div className="absolute inset-0 bg-emerald-500 blur-lg opacity-20 group-hover:opacity-40 transition-opacity" />
               <img src={logoImg} alt="BarterVerse" className="w-9 h-9 object-contain relative z-10 transition-transform duration-300 group-hover:scale-110" />
            </div>
            <span className="text-xl font-bold text-white tracking-tight hidden sm:block">
              Barter<span className="text-emerald-400">Verse</span>
            </span>
          </Link>

          {/* Desktop Navigation */}
          <div className="hidden lg:flex items-center gap-1 bg-white/5 backdrop-blur-md rounded-full px-2 py-1 border border-white/5">
            {navLinks.map((link) => (
              <Link
                key={link.path}
                to={link.path}
                className={`flex items-center gap-2 px-4 py-2 rounded-full text-sm font-medium transition-all duration-300 ${
                  isActive(link.path)
                    ? 'bg-emerald-500 text-white shadow-lg shadow-emerald-500/20'
                    : 'text-slate-400 hover:text-white hover:bg-white/10'
                }`}
              >
                {link.icon}
                {link.name}
              </Link>
            ))}
          </div>

          {/* Right Actions */}
          <div className="hidden md:flex items-center gap-4">
            {isAuthenticated ? (
              <>
                <Link to="/post">
                  <Button size="sm" className="btn-primary rounded-full px-5 h-10 shadow-emerald-500/20 hover:shadow-emerald-500/40 transition-all">
                    <Plus className="w-4 h-4 mr-2" /> Post
                  </Button>
                </Link>

                <div className="h-8 w-px bg-white/10 mx-1" />

                {/* Notification Dropdown */}
                <DropdownMenu>
                  <DropdownMenuTrigger asChild>
                    <button className="relative p-2 text-slate-400 hover:text-white transition-colors outline-none">
                       <Bell className="w-5 h-5" />
                       <span className="absolute top-1.5 right-1.5 w-2 h-2 bg-red-500 rounded-full animate-pulse" />
                    </button>
                  </DropdownMenuTrigger>
                  <DropdownMenuContent align="end" className="w-80 bg-[#0B1121]/95 backdrop-blur-xl border-slate-800 text-slate-200 mt-2 p-0 rounded-xl shadow-2xl overflow-hidden">
                    <div className="px-4 py-3 border-b border-white/10 bg-white/5">
                      <h3 className="font-bold text-sm text-white">Notifications</h3>
                    </div>
                    <div className="max-h-[300px] overflow-y-auto">
                      <DropdownMenuItem className="p-4 cursor-pointer hover:bg-white/5 focus:bg-white/5 gap-3 items-start">
                        <div className="mt-1 p-1.5 bg-emerald-500/20 rounded-full text-emerald-400">
                          <CheckCircle className="w-3 h-3" />
                        </div>
                        <div>
                          <p className="text-sm font-medium text-white">Trade Offer Accepted!</p>
                          <p className="text-xs text-slate-400 mt-1">Your offer for "Vintage Camera" was accepted.</p>
                          <p className="text-[10px] text-slate-500 mt-2">2 mins ago</p>
                        </div>
                      </DropdownMenuItem>
                      <DropdownMenuItem className="p-4 cursor-pointer hover:bg-white/5 focus:bg-white/5 gap-3 items-start border-t border-white/5">
                        <div className="mt-1 p-1.5 bg-blue-500/20 rounded-full text-blue-400">
                          <MessageSquare className="w-3 h-3" />
                        </div>
                        <div>
                          <p className="text-sm font-medium text-white">New Message</p>
                          <p className="text-xs text-slate-400 mt-1">Alex sent you a message regarding your listing.</p>
                          <p className="text-[10px] text-slate-500 mt-2">1 hour ago</p>
                        </div>
                      </DropdownMenuItem>
                    </div>
                    <Link to="/dashboard" className="block p-3 text-center text-xs font-medium text-emerald-400 hover:text-emerald-300 border-t border-white/10 bg-white/5">
                      View all activity
                    </Link>
                  </DropdownMenuContent>
                </DropdownMenu>

                {/* User Dropdown */}
                <DropdownMenu>
                  <DropdownMenuTrigger asChild>
                    <button className="flex items-center gap-2 pl-1 pr-3 py-1 rounded-full bg-slate-900/50 border border-slate-700 hover:border-emerald-500/50 transition-all group">
                      <Avatar className="h-8 w-8 border border-slate-600 group-hover:border-emerald-500 transition-colors">
                        <AvatarImage src={user?.avatar_url} />
                        <AvatarFallback className="bg-slate-800 text-xs text-emerald-400 font-bold">
                          {user?.email?.slice(0, 2).toUpperCase()}
                        </AvatarFallback>
                      </Avatar>
                      <span className="text-sm font-medium text-slate-300 group-hover:text-white truncate max-w-[80px]">
                         {user?.display_name || 'User'}
                      </span>
                      <ChevronDown className="w-3 h-3 text-slate-500 group-hover:text-emerald-400 transition-colors" />
                    </button>
                  </DropdownMenuTrigger>
                  
                  <DropdownMenuContent align="end" className="w-64 bg-[#0B1121]/95 backdrop-blur-xl border-slate-800 text-slate-200 mt-2 p-2 rounded-xl shadow-2xl">
                    <DropdownMenuLabel className="text-xs font-bold text-slate-500 uppercase tracking-wider px-3 py-2">
                       My Account
                    </DropdownMenuLabel>
                    
                    <Link to="/dashboard">
                      <DropdownMenuItem className="focus:bg-emerald-500/10 focus:text-emerald-400 cursor-pointer rounded-lg px-3 py-2.5">
                        <LayoutDashboard className="w-4 h-4 mr-3" /> Dashboard
                      </DropdownMenuItem>
                    </Link>
                    <Link to="/trade-center">
                      <DropdownMenuItem className="focus:bg-emerald-500/10 focus:text-emerald-400 cursor-pointer rounded-lg px-3 py-2.5">
                        <Repeat className="w-4 h-4 mr-3" /> Trade Center
                      </DropdownMenuItem>
                    </Link>
                    <Link to="/profile">
                      <DropdownMenuItem className="focus:bg-emerald-500/10 focus:text-emerald-400 cursor-pointer rounded-lg px-3 py-2.5">
                        <User className="w-4 h-4 mr-3" /> Profile & Settings
                      </DropdownMenuItem>
                    </Link>
                    {/* Fixed: Removed duplicate Link wrapper here */}
                    <Link to="/messages">
                        <DropdownMenuItem className="focus:bg-emerald-500/10 focus:text-emerald-400 cursor-pointer rounded-lg px-3 py-2.5">
                            <MessageSquare className="w-4 h-4 mr-3" /> Messages
                        </DropdownMenuItem>
                    </Link>
                    <Link to="/governance">
                      <DropdownMenuItem className="focus:bg-emerald-500/10 focus:text-emerald-400 cursor-pointer rounded-lg px-3 py-2.5">
                        <Vote className="w-4 h-4 mr-3" /> Governance
                      </DropdownMenuItem>
                    </Link>
                    
                    <DropdownMenuSeparator className="bg-white/10 my-2" />
                    
                    <DropdownMenuItem onClick={signOut} className="text-red-400 focus:text-red-300 focus:bg-red-500/10 cursor-pointer rounded-lg px-3 py-2.5">
                      <LogOut className="w-4 h-4 mr-3" /> Sign out
                    </DropdownMenuItem>
                  </DropdownMenuContent>
                </DropdownMenu>
              </>
            ) : (
              <div className="flex gap-4">
                <Link to="/auth">
                  <Button variant="ghost" className="text-slate-300 hover:text-white hover:bg-white/5 rounded-full">
                    Log in
                  </Button>
                </Link>
                <Link to="/auth">
                  <Button className="bg-white text-black hover:bg-emerald-50 font-semibold rounded-full px-6">
                    Sign up
                  </Button>
                </Link>
              </div>
            )}
          </div>

          {/* Mobile Menu Button */}
          <div className="lg:hidden flex items-center gap-4">
             {isAuthenticated && (
                <Link to="/post">
                   <Button size="icon" className="rounded-full bg-emerald-600 hover:bg-emerald-500 w-9 h-9">
                      <Plus className="w-5 h-5" />
                   </Button>
                </Link>
             )}
            <button
              onClick={() => setIsOpen(!isOpen)}
              className="p-2 rounded-xl text-slate-300 hover:text-white hover:bg-white/10 transition-colors"
            >
              {isOpen ? <X className="w-6 h-6" /> : <Menu className="w-6 h-6" />}
            </button>
          </div>
        </div>
      </div>

      {/* Mobile Menu Overlay */}
      {isOpen && (
        <div className="lg:hidden absolute top-full left-0 w-full bg-[#020617]/95 backdrop-blur-xl border-b border-white/10 shadow-2xl p-4 animate-fade-in-up">
          <div className="grid gap-2">
            {navLinks.map((link) => (
              <Link
                key={link.path}
                to={link.path}
                className={`flex items-center gap-3 px-4 py-3.5 rounded-xl transition-all ${
                  isActive(link.path)
                    ? 'bg-emerald-500/10 text-emerald-400 border border-emerald-500/20'
                    : 'text-slate-400 hover:bg-white/5 hover:text-white'
                }`}
              >
                <div className={`p-1.5 rounded-lg ${isActive(link.path) ? 'bg-emerald-500/20' : 'bg-slate-800'}`}>
                   {link.icon}
                </div>
                <span className="font-medium">{link.name}</span>
              </Link>
            ))}
            
            <Link to="/governance" className="flex items-center gap-3 px-4 py-3.5 rounded-xl text-slate-400 hover:bg-white/5 hover:text-white transition-all">
               <div className="p-1.5 rounded-lg bg-slate-800"><Vote className="w-4 h-4" /></div>
               <span className="font-medium">Governance</span>
            </Link>
          </div>
          
          <div className="pt-4 mt-4 border-t border-white/5">
            {isAuthenticated ? (
              <div className="space-y-3">
                <Link to="/dashboard">
                   <Button variant="ghost" className="w-full justify-start text-slate-300 hover:text-white hover:bg-white/5 h-12 rounded-xl">
                      <LayoutDashboard className="w-5 h-5 mr-3" /> Dashboard
                   </Button>
                </Link>
                <Link to="/trade-center">
                   <Button variant="ghost" className="w-full justify-start text-slate-300 hover:text-white hover:bg-white/5 h-12 rounded-xl">
                      <Repeat className="w-5 h-5 mr-3" /> Trade Center
                   </Button>
                </Link>
                <Button variant="outline" className="w-full border-red-500/20 text-red-400 hover:bg-red-500/10 h-12 rounded-xl justify-start" onClick={signOut}>
                   <LogOut className="w-5 h-5 mr-3" /> Sign Out
                </Button>
              </div>
            ) : (
              <div className="grid grid-cols-2 gap-3">
                <Link to="/auth">
                   <Button variant="outline" className="w-full border-slate-700 text-slate-300 h-12 rounded-xl">Log in</Button>
                </Link>
                <Link to="/auth">
                   <Button className="w-full bg-emerald-600 hover:bg-emerald-500 h-12 rounded-xl">Sign up</Button>
                </Link>
              </div>
            )}
          </div>
        </div>
      )}
    </nav>
  );
}

================================================
FILE: D:\barter_verse\frontend\src\components\PrivacySettings.tsx
================================================
import React, { useState, useEffect } from 'react';
import { AlertCircle, Download, Trash2, LogOut } from 'lucide-react';

const PrivacySettings = () => {
  const [loading, setLoading] = useState(false);
  const [message, setMessage] = useState('');
  const [deletePassword, setDeletePassword] = useState('');
  const [showDeleteConfirm, setShowDeleteConfirm] = useState(false);
  const [auditLogs, setAuditLogs] = useState<any[]>([]);

  const handleExportData = async () => {
    try {
      setLoading(true);
      const response = await fetch('/api/privacy/export', {
        headers: { Authorization: `Bearer ${localStorage.getItem('token')}` },
      });
      const result = await response.json();

      if (result.success) {
        // Create downloadable JSON file
        const dataStr = JSON.stringify(result.data, null, 2);
        const dataBlob = new Blob([dataStr], { type: 'application/json' });
        const url = URL.createObjectURL(dataBlob);
        const link = document.createElement('a');
        link.href = url;
        link.download = `barter_verse_data_${new Date().toISOString().split('T')[0]}.json`;
        link.click();
        setMessage(' Your data has been exported successfully!');
      } else {
        setMessage(` Error: ${result.message}`);
      }
    } catch (error: any) {
      setMessage(` Error: ${error.message}`);
    } finally {
      setLoading(false);
    }
  };

  const handleDeleteAccount = async () => {
    if (!deletePassword) {
      setMessage(' Please enter your password to confirm deletion');
      return;
    }

    try {
      setLoading(true);
      const response = await fetch('/api/privacy/delete-account', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          Authorization: `Bearer ${localStorage.getItem('token')}`,
        },
        body: JSON.stringify({ password: deletePassword }),
      });
      const result = await response.json();

      if (result.success) {
        setMessage(
          ' Account deleted successfully. You will be logged out in 3 seconds...'
        );
        setTimeout(() => {
          localStorage.removeItem('token');
          window.location.href = '/';
        }, 3000);
      } else {
        setMessage(` Error: ${result.message}`);
      }
    } catch (error: any) {
      setMessage(` Error: ${error.message}`);
    } finally {
      setLoading(false);
      setDeletePassword('');
    }
  };

  const fetchAuditLogs = async () => {
    try {
      const response = await fetch('/api/privacy/audit-logs?limit=20', {
        headers: { Authorization: `Bearer ${localStorage.getItem('token')}` },
      });
      const result = await response.json();
      if (result.success) {
        setAuditLogs(result.data);
      }
    } catch (error) {
      console.error('Error fetching audit logs:', error);
    }
  };

  useEffect(() => {
    fetchAuditLogs();
  }, []);

  return (
    <div className="max-w-4xl mx-auto p-6">
      <h1 className="text-3xl font-bold mb-8"> Privacy & Data Protection</h1>

      {message && (
        <div className="mb-6 p-4 rounded-lg bg-blue-50 border border-blue-200">
          {message}
        </div>
      )}

      {/* Data Export Section */}
      <div className="bg-white rounded-lg shadow-md p-6 mb-6">
        <div className="flex items-start gap-4">
          <Download className="text-blue-500 flex-shrink-0 mt-1" />
          <div className="flex-1">
            <h2 className="text-xl font-semibold mb-2"> Export Your Data (GDPR)</h2>
            <p className="text-gray-600 mb-4">
              Download a complete copy of your profile, listings, trades, and transaction history
              in JSON format.
            </p>
            <button
              onClick={handleExportData}
              disabled={loading}
              className="bg-blue-500 hover:bg-blue-600 disabled:bg-gray-400 text-white px-6 py-2 rounded-lg font-medium"
            >
              {loading ? ' Exporting...' : ' Export Data'}
            </button>
          </div>
        </div>
      </div>

      {/* Audit Logs Section */}
      <div className="bg-white rounded-lg shadow-md p-6 mb-6">
        <h2 className="text-xl font-semibold mb-4"> Account Activity Log</h2>
        <div className="overflow-x-auto">
          <table className="w-full text-sm">
            <thead className="bg-gray-50">
              <tr>
                <th className="px-4 py-2 text-left">Action</th>
                <th className="px-4 py-2 text-left">Resource</th>
                <th className="px-4 py-2 text-left">Status</th>
                <th className="px-4 py-2 text-left">Date</th>
              </tr>
            </thead>
            <tbody>
              {auditLogs.map((log) => (
                <tr key={log.userId + log.timestamp} className="border-t">
                  <td className="px-4 py-2">{log.action}</td>
                  <td className="px-4 py-2">{log.resource}</td>
                  <td className="px-4 py-2">
                    <span
                      className={`px-2 py-1 rounded text-xs font-medium ${
                        log.status === 'success'
                          ? 'bg-green-100 text-green-800'
                          : 'bg-red-100 text-red-800'
                      }`}
                    >
                      {log.status}
                    </span>
                  </td>
                  <td className="px-4 py-2 text-gray-500">
                    {new Date(log.timestamp).toLocaleDateString()}
                  </td>
                </tr>
              ))}
            </tbody>
          </table>
        </div>
      </div>

      {/* Delete Account Section */}
      <div className="bg-red-50 border border-red-200 rounded-lg p-6">
        <div className="flex items-start gap-4">
          <AlertCircle className="text-red-500 flex-shrink-0 mt-1" />
          <div className="flex-1">
            <h2 className="text-xl font-semibold mb-2 text-red-700">
               Delete Account (GDPR Right to be Forgotten)
            </h2>
            <p className="text-gray-600 mb-4">
              Your account will be anonymized and all personal information will be removed. This
              action cannot be undone.
            </p>

            {!showDeleteConfirm ? (
              <button
                onClick={() => setShowDeleteConfirm(true)}
                className="bg-red-500 hover:bg-red-600 text-white px-6 py-2 rounded-lg font-medium"
              >
                <Trash2 className="inline mr-2" size={18} />
                Delete Account
              </button>
            ) : (
              <div className="bg-white p-4 rounded-lg border border-red-300">
                <p className="mb-3 font-semibold">Confirm account deletion by entering your password:</p>
                <input
                  type="password"
                  placeholder="Enter your password"
                  value={deletePassword}
                  onChange={(e) => setDeletePassword(e.target.value)}
                  className="w-full px-4 py-2 border border-gray-300 rounded-lg mb-3"
                />
                <div className="flex gap-3">
                  <button
                    onClick={handleDeleteAccount}
                    disabled={loading}
                    className="bg-red-500 hover:bg-red-600 disabled:bg-gray-400 text-white px-6 py-2 rounded-lg font-medium"
                  >
                    {loading ? ' Deleting...' : 'Confirm Deletion'}
                  </button>
                  <button
                    onClick={() => {
                      setShowDeleteConfirm(false);
                      setDeletePassword('');
                    }}
                    className="bg-gray-300 hover:bg-gray-400 text-gray-800 px-6 py-2 rounded-lg font-medium"
                  >
                    Cancel
                  </button>
                </div>
              </div>
            )}
          </div>
        </div>
      </div>

      {/* Privacy Info */}
      <div className="mt-8 p-4 bg-blue-50 border border-blue-200 rounded-lg text-sm text-gray-700">
        <p className="mb-2">
          <strong> Data Protection:</strong> Your password is hashed using bcryptjs. Sensitive
          data is encrypted with AES-256-GCM encryption.
        </p>
        <p>
          <strong> GDPR Compliance:</strong> We support your right to access, export, and delete
          your data at any time.
        </p>
      </div>
    </div>
  );
};

export default PrivacySettings;


================================================
FILE: D:\barter_verse\frontend\src\components\SessionScheduling.tsx
================================================
import React, { useState, useEffect } from 'react';
import { Calendar, Clock, MapPin, Link as LinkIcon, Trash2 } from 'lucide-react';

const SessionScheduling = () => {
  const [sessions, setSessions] = useState<any[]>([]);
  const [loading, setLoading] = useState(false);
  const [message, setMessage] = useState('');
  const [showCreateForm, setShowCreateForm] = useState(false);
  const [activeTab, setActiveTab] = useState<'all' | 'provider' | 'participant'>('all');

  const [formData, setFormData] = useState({
    participant_id: '',
    skill_title: '',
    description: '',
    scheduled_at: '',
    duration_minutes: 60,
    location: '',
    meeting_link: '',
  });

  const [statusUpdate, setStatusUpdate] = useState<{
    sessionId: string;
    status: string;
    feedback?: string;
    rating?: number;
  } | null>(null);

  useEffect(() => {
    fetchSessions();
  }, [activeTab]);

  const fetchSessions = async () => {
    try {
      setLoading(true);
      const roleParam = activeTab === 'all' ? '' : `&role=${activeTab}`;
      const response = await fetch(`/api/sessions/my-sessions?${roleParam}`, {
        headers: { Authorization: `Bearer ${localStorage.getItem('token')}` },
      });
      const result = await response.json();

      if (result.success) {
        setSessions(result.data || []);
      } else {
        setMessage(` ${result.message}`);
      }
    } catch (error: any) {
      setMessage(` Error: ${error.message}`);
    } finally {
      setLoading(false);
    }
  };

  const handleCreateSession = async (e: React.FormEvent) => {
    e.preventDefault();

    if (!formData.participant_id || !formData.skill_title || !formData.scheduled_at) {
      setMessage(' Please fill all required fields');
      return;
    }

    try {
      setLoading(true);
      const response = await fetch('/api/sessions/create', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          Authorization: `Bearer ${localStorage.getItem('token')}`,
        },
        body: JSON.stringify(formData),
      });

      const result = await response.json();

      if (result.success) {
        setMessage(' Session created successfully!');
        setShowCreateForm(false);
        setFormData({
          participant_id: '',
          skill_title: '',
          description: '',
          scheduled_at: '',
          duration_minutes: 60,
          location: '',
          meeting_link: '',
        });
        fetchSessions();
      } else {
        setMessage(` ${result.message}`);
      }
    } catch (error: any) {
      setMessage(` Error: ${error.message}`);
    } finally {
      setLoading(false);
    }
  };

  const handleUpdateStatus = async (sessionId: string, newStatus: string) => {
    try {
      setLoading(true);
      const response = await fetch(`/api/sessions/${sessionId}/status`, {
        method: 'PUT',
        headers: {
          'Content-Type': 'application/json',
          Authorization: `Bearer ${localStorage.getItem('token')}`,
        },
        body: JSON.stringify({
          status: newStatus,
          feedback: statusUpdate?.feedback,
          rating: statusUpdate?.rating,
        }),
      });

      const result = await response.json();

      if (result.success) {
        setMessage(' Session status updated!');
        setStatusUpdate(null);
        fetchSessions();
      } else {
        setMessage(` ${result.message}`);
      }
    } catch (error: any) {
      setMessage(` Error: ${error.message}`);
    } finally {
      setLoading(false);
    }
  };

  const handleDeleteSession = async (sessionId: string) => {
    if (!confirm('Are you sure you want to cancel this session?')) return;

    try {
      setLoading(true);
      const response = await fetch(`/api/sessions/${sessionId}`, {
        method: 'DELETE',
        headers: { Authorization: `Bearer ${localStorage.getItem('token')}` },
      });

      const result = await response.json();

      if (result.success) {
        setMessage(' Session cancelled successfully!');
        fetchSessions();
      } else {
        setMessage(` ${result.message}`);
      }
    } catch (error: any) {
      setMessage(` Error: ${error.message}`);
    } finally {
      setLoading(false);
    }
  };

  const getStatusColor = (status: string) => {
    switch (status) {
      case 'SCHEDULED':
        return 'bg-primary/10 text-primary';
      case 'IN_PROGRESS':
        return 'bg-warning/10 text-warning';
      case 'COMPLETED':
        return 'bg-success/10 text-success';
      case 'CANCELLED':
        return 'bg-destructive/10 text-destructive';
      default:
        return 'bg-muted text-muted-foreground';
    }
  };

  return (
    <div className="max-w-6xl mx-auto p-6">
      <h1 className="text-3xl font-bold mb-8"> Skill Session Scheduling</h1>

      {message && (
        <div className="mb-6 p-4 rounded-lg bg-primary/5 border border-primary/20 text-foreground">
          {message}
        </div>
      )}

      {/* Tabs */}
      <div className="flex gap-4 mb-6 border-b">
        {['all', 'provider', 'participant'].map((tab) => (
          <button
            key={tab}
            onClick={() => setActiveTab(tab as any)}
            className={`px-4 py-2 font-medium capitalize ${
              activeTab === tab
                ? 'border-b-2' + ' border-[hsl(var(--primary))] text-primary'
                : 'text-muted-foreground hover:text-secondary'
            }`}
          >
            {tab === 'all' ? ' All Sessions' : tab === 'provider' ? ' As Provider' : ' As Participant'}
          </button>
        ))}
      </div>

      {/* Create Button */}
      <button
        onClick={() => setShowCreateForm(!showCreateForm)}
        className="mb-6 btn-primary"
      >
        {showCreateForm ? ' Cancel' : ' New Session'}
      </button>

      {/* Create Form */}
      {showCreateForm && (
        <div className="card-upgrade p-6 mb-6">
          <h2 className="text-xl font-semibold mb-4">Create New Session</h2>

          <form onSubmit={handleCreateSession} className="grid grid-cols-1 md:grid-cols-2 gap-4">
            <input
              type="text"
              placeholder="Participant User ID"
              value={formData.participant_id}
              onChange={(e) => setFormData({ ...formData, participant_id: e.target.value })}
              required
              className="px-4 py-2 border border-[hsl(var(--border))] rounded-lg bg-card text-foreground"
            />

            <input
              type="text"
              placeholder="Skill Title (e.g., Photography Basics)"
              value={formData.skill_title}
              onChange={(e) => setFormData({ ...formData, skill_title: e.target.value })}
              required
              className="px-4 py-2 border border-[hsl(var(--border))] rounded-lg bg-card text-foreground"
            />

            <textarea
              placeholder="Description (optional)"
              value={formData.description}
              onChange={(e) => setFormData({ ...formData, description: e.target.value })}
              className="px-4 py-2 border border-[hsl(var(--border))] rounded-lg col-span-1 md:col-span-2 bg-card text-foreground"
              rows={2}
            />

            <input
              type="datetime-local"
              value={formData.scheduled_at}
              onChange={(e) => setFormData({ ...formData, scheduled_at: e.target.value })}
              required
              className="px-4 py-2 border border-[hsl(var(--border))] rounded-lg bg-card text-foreground"
            />

            <input
              type="number"
              placeholder="Duration (minutes)"
              value={formData.duration_minutes}
              onChange={(e) => setFormData({ ...formData, duration_minutes: parseInt(e.target.value) })}
              min="30"
              max="480"
              className="px-4 py-2 border border-[hsl(var(--border))] rounded-lg bg-card text-foreground"
            />

            <input
              type="text"
              placeholder="Location (optional)"
              value={formData.location}
              onChange={(e) => setFormData({ ...formData, location: e.target.value })}
              className="px-4 py-2 border border-[hsl(var(--border))] rounded-lg bg-card text-foreground"
            />

            <input
              type="url"
              placeholder="Meeting Link (optional)"
              value={formData.meeting_link}
              onChange={(e) => setFormData({ ...formData, meeting_link: e.target.value })}
              className="px-4 py-2 border border-[hsl(var(--border))] rounded-lg bg-card text-foreground"
            />

            <button
              type="submit"
              disabled={loading}
              className="col-span-1 md:col-span-2 btn-primary"
            >
              {loading ? ' Creating...' : ' Create Session'}
            </button>
          </form>
        </div>
      )}

      {/* Sessions List */}
      {sessions.length > 0 ? (
        <div className="grid grid-cols-1 gap-4">
          {sessions.map((session) => (
            <div key={session.id} className="bg-white rounded-lg shadow-md p-6">
              <div className="flex items-start justify-between mb-4">
                <div>
                  <h3 className="text-xl font-semibold">{session.skill_title}</h3>
                  <p className="text-gray-600 text-sm mt-1">{session.description}</p>
                </div>
                <span className={`px-3 py-1 rounded-full text-sm font-medium ${getStatusColor(session.status)}`}>
                  {session.status}
                </span>
              </div>

              <div className="grid grid-cols-1 md:grid-cols-2 gap-4 my-4 text-sm">
                <div className="flex items-center gap-2">
                  <Calendar size={18} className="text-primary" />
                  <span>{new Date(session.scheduled_at).toLocaleDateString()}</span>
                </div>
                <div className="flex items-center gap-2">
                  <Clock size={18} className="text-primary" />
                  <span>{new Date(session.scheduled_at).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })} ({session.duration_minutes} min)</span>
                </div>
                {session.location && (
                  <div className="flex items-center gap-2">
                    <MapPin size={18} className="text-destructive" />
                    <span>{session.location}</span>
                  </div>
                )}
                {session.meeting_link && (
                  <a
                    href={session.meeting_link}
                    target="_blank"
                    rel="noopener noreferrer"
                    className="flex items-center gap-2 text-primary hover:underline"
                  >
                    <LinkIcon size={18} />
                    <span>Meeting Link</span>
                  </a>
                )}
              </div>

              <div className="border-t pt-4 mt-4">
                <p className="text-sm text-gray-600">
                   Provider: <span className="font-medium">{session.provider.username}</span>
                  {' '}   Participant: <span className="font-medium">{session.participant.username}</span>
                </p>
              </div>

              {/* Status Update Section */}
              {session.status === 'COMPLETED' && !session.rating && (
                <div className="mt-4 p-4 bg-primary/5 border border-primary/20 rounded-lg text-foreground text-sm">
                  <label className="block text-sm font-medium mb-2">Rate this session (1-5 stars)</label>
                  <input
                    type="number"
                    min="1"
                    max="5"
                    step="0.5"
                    placeholder="Rating"
                    className="w-full px-3 py-2 border border-gray-300 rounded-lg mb-2"
                    onChange={(e) =>
                      setStatusUpdate({
                        sessionId: session.id,
                        status: 'COMPLETED',
                        rating: parseFloat(e.target.value),
                      })
                    }
                  />
                  <textarea
                    placeholder="Feedback (optional)"
                    className="w-full px-3 py-2 border border-gray-300 rounded-lg mb-2"
                    onChange={(e) =>
                      setStatusUpdate({
                        ...statusUpdate!,
                        feedback: e.target.value,
                      })
                    }
                    rows={2}
                  />
                  <button
                    onClick={() => handleUpdateStatus(session.id, 'COMPLETED')}
                    className="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg text-sm"
                  >
                    Submit Feedback
                  </button>
                </div>
              )}

              {session.status !== 'COMPLETED' && session.status !== 'CANCELLED' && (
                <div className="mt-4 flex gap-2 flex-wrap">
                  {session.status === 'SCHEDULED' && (
                    <>
                      <button
                        onClick={() => handleUpdateStatus(session.id, 'IN_PROGRESS')}
                        className="bg-yellow-500 hover:bg-yellow-600 text-white px-4 py-2 rounded-lg text-sm"
                      >
                        Start Session
                      </button>
                      <button
                        onClick={() => handleDeleteSession(session.id)}
                        className="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg text-sm"
                      >
                        <Trash2 size={16} className="inline mr-1" />
                        Cancel
                      </button>
                    </>
                  )}
                  {session.status === 'IN_PROGRESS' && (
                    <button
                      onClick={() => handleUpdateStatus(session.id, 'COMPLETED')}
                      className="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg text-sm"
                    >
                      Mark Complete
                    </button>
                  )}
                </div>
              )}
            </div>
          ))}
        </div>
      ) : (
        <div className="text-center py-12">
          <p className="text-gray-500 text-lg">
            {loading ? ' Loading sessions...' : 'No sessions scheduled yet.'}
          </p>
        </div>
      )}
    </div>
  );
};

export default SessionScheduling;


================================================
FILE: D:\barter_verse\frontend\src\components\ui\accordion.tsx
================================================
import * as React from "react";
import * as AccordionPrimitive from "@radix-ui/react-accordion";
import { ChevronDown } from "lucide-react";

import { cn } from "@/lib/utils";

const Accordion = AccordionPrimitive.Root;

const AccordionItem = React.forwardRef<
  React.ElementRef<typeof AccordionPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>
>(({ className, ...props }, ref) => (
  <AccordionPrimitive.Item ref={ref} className={cn("border-b", className)} {...props} />
));
AccordionItem.displayName = "AccordionItem";

const AccordionTrigger = React.forwardRef<
  React.ElementRef<typeof AccordionPrimitive.Trigger>,
  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>
>(({ className, children, ...props }, ref) => (
  <AccordionPrimitive.Header className="flex">
    <AccordionPrimitive.Trigger
      ref={ref}
      className={cn(
        "flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",
        className,
      )}
      {...props}
    >
      {children}
      <ChevronDown className="h-4 w-4 shrink-0 transition-transform duration-200" />
    </AccordionPrimitive.Trigger>
  </AccordionPrimitive.Header>
));
AccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName;

const AccordionContent = React.forwardRef<
  React.ElementRef<typeof AccordionPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>
>(({ className, children, ...props }, ref) => (
  <AccordionPrimitive.Content
    ref={ref}
    className="overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down"
    {...props}
  >
    <div className={cn("pb-4 pt-0", className)}>{children}</div>
  </AccordionPrimitive.Content>
));

AccordionContent.displayName = AccordionPrimitive.Content.displayName;

export { Accordion, AccordionItem, AccordionTrigger, AccordionContent };


================================================
FILE: D:\barter_verse\frontend\src\components\ui\alert-dialog.tsx
================================================
import * as React from "react";
import * as AlertDialogPrimitive from "@radix-ui/react-alert-dialog";

import { cn } from "@/lib/utils";
import { buttonVariants } from "@/components/ui/button";

const AlertDialog = AlertDialogPrimitive.Root;

const AlertDialogTrigger = AlertDialogPrimitive.Trigger;

const AlertDialogPortal = AlertDialogPrimitive.Portal;

const AlertDialogOverlay = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>
>(({ className, ...props }, ref) => (
  <AlertDialogPrimitive.Overlay
    className={cn(
      "fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",
      className,
    )}
    {...props}
    ref={ref}
  />
));
AlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName;

const AlertDialogContent = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>
>(({ className, ...props }, ref) => (
  <AlertDialogPortal>
    <AlertDialogOverlay />
    <AlertDialogPrimitive.Content
      ref={ref}
      className={cn(
        "fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",
        className,
      )}
      {...props}
    />
  </AlertDialogPortal>
));
AlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName;

const AlertDialogHeader = ({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) => (
  <div className={cn("flex flex-col space-y-2 text-center sm:text-left", className)} {...props} />
);
AlertDialogHeader.displayName = "AlertDialogHeader";

const AlertDialogFooter = ({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) => (
  <div className={cn("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2", className)} {...props} />
);
AlertDialogFooter.displayName = "AlertDialogFooter";

const AlertDialogTitle = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Title>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>
>(({ className, ...props }, ref) => (
  <AlertDialogPrimitive.Title ref={ref} className={cn("text-lg font-semibold", className)} {...props} />
));
AlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName;

const AlertDialogDescription = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Description>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>
>(({ className, ...props }, ref) => (
  <AlertDialogPrimitive.Description ref={ref} className={cn("text-sm text-muted-foreground", className)} {...props} />
));
AlertDialogDescription.displayName = AlertDialogPrimitive.Description.displayName;

const AlertDialogAction = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Action>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>
>(({ className, ...props }, ref) => (
  <AlertDialogPrimitive.Action ref={ref} className={cn(buttonVariants(), className)} {...props} />
));
AlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName;

const AlertDialogCancel = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>
>(({ className, ...props }, ref) => (
  <AlertDialogPrimitive.Cancel
    ref={ref}
    className={cn(buttonVariants({ variant: "outline" }), "mt-2 sm:mt-0", className)}
    {...props}
  />
));
AlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName;

export {
  AlertDialog,
  AlertDialogPortal,
  AlertDialogOverlay,
  AlertDialogTrigger,
  AlertDialogContent,
  AlertDialogHeader,
  AlertDialogFooter,
  AlertDialogTitle,
  AlertDialogDescription,
  AlertDialogAction,
  AlertDialogCancel,
};


================================================
FILE: D:\barter_verse\frontend\src\components\ui\alert.tsx
================================================
import * as React from "react";
import { cva, type VariantProps } from "class-variance-authority";

import { cn } from "@/lib/utils";

const alertVariants = cva(
  "relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",
  {
    variants: {
      variant: {
        default: "bg-background border-border text-foreground",
        destructive: "border-destructive/50 bg-destructive/5 text-destructive [&>svg]:text-destructive",
        success: "border-success/50 bg-success/5 text-success [&>svg]:text-success",
        warning: "border-warning/50 bg-warning/5 text-foreground [&>svg]:text-warning",
      },
    },
    defaultVariants: {
      variant: "default",
    },
  },
);

const Alert = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>
>(({ className, variant, ...props }, ref) => (
  <div ref={ref} role="alert" className={cn(alertVariants({ variant }), className)} {...props} />
));
Alert.displayName = "Alert";

const AlertTitle = React.forwardRef<HTMLParagraphElement, React.HTMLAttributes<HTMLHeadingElement>>(
  ({ className, ...props }, ref) => (
    <h5 ref={ref} className={cn("mb-1 font-medium leading-none tracking-tight", className)} {...props} />
  ),
);
AlertTitle.displayName = "AlertTitle";

const AlertDescription = React.forwardRef<HTMLParagraphElement, React.HTMLAttributes<HTMLParagraphElement>>(
  ({ className, ...props }, ref) => (
    <div ref={ref} className={cn("text-sm [&_p]:leading-relaxed", className)} {...props} />
  ),
);
AlertDescription.displayName = "AlertDescription";

export { Alert, AlertTitle, AlertDescription };


================================================
FILE: D:\barter_verse\frontend\src\components\ui\aspect-ratio.tsx
================================================
import * as AspectRatioPrimitive from "@radix-ui/react-aspect-ratio";

const AspectRatio = AspectRatioPrimitive.Root;

export { AspectRatio };


================================================
FILE: D:\barter_verse\frontend\src\components\ui\avatar.tsx
================================================
import * as React from "react";
import * as AvatarPrimitive from "@radix-ui/react-avatar";

import { cn } from "@/lib/utils";

const Avatar = React.forwardRef<
  React.ElementRef<typeof AvatarPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>
>(({ className, ...props }, ref) => (
  <AvatarPrimitive.Root
    ref={ref}
    className={cn("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full", className)}
    {...props}
  />
));
Avatar.displayName = AvatarPrimitive.Root.displayName;

const AvatarImage = React.forwardRef<
  React.ElementRef<typeof AvatarPrimitive.Image>,
  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>
>(({ className, ...props }, ref) => (
  <AvatarPrimitive.Image ref={ref} className={cn("aspect-square h-full w-full", className)} {...props} />
));
AvatarImage.displayName = AvatarPrimitive.Image.displayName;

const AvatarFallback = React.forwardRef<
  React.ElementRef<typeof AvatarPrimitive.Fallback>,
  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>
>(({ className, ...props }, ref) => (
  <AvatarPrimitive.Fallback
    ref={ref}
    className={cn("flex h-full w-full items-center justify-center rounded-full bg-muted", className)}
    {...props}
  />
));
AvatarFallback.displayName = AvatarPrimitive.Fallback.displayName;

export { Avatar, AvatarImage, AvatarFallback };


================================================
FILE: D:\barter_verse\frontend\src\components\ui\badge.tsx
================================================
import * as React from "react";
import { cva, type VariantProps } from "class-variance-authority";

import { cn } from "@/lib/utils";

const badgeVariants = cva(
  "inline-flex items-center rounded-full border border-transparent px-3 py-1 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",
  {
    variants: {
      variant: {
        default: "bg-primary text-primary-foreground hover:bg-brand-green-dark",
        secondary: "bg-secondary text-secondary-foreground hover:bg-secondary/90",
        destructive: "bg-destructive text-destructive-foreground hover:bg-destructive/90",
        success: "bg-success text-white hover:bg-success/90",
        warning: "bg-warning text-foreground hover:bg-warning/90",
        outline: "border-border text-foreground hover:bg-muted",
      },
    },
    defaultVariants: {
      variant: "default",
    },
  },
);

export interface BadgeProps extends React.HTMLAttributes<HTMLDivElement>, VariantProps<typeof badgeVariants> {}

function Badge({ className, variant, ...props }: BadgeProps) {
  return <div className={cn(badgeVariants({ variant }), className)} {...props} />;
}

export { Badge, badgeVariants };


================================================
FILE: D:\barter_verse\frontend\src\components\ui\breadcrumb.tsx
================================================
import * as React from "react";
import { Slot } from "@radix-ui/react-slot";
import { ChevronRight, MoreHorizontal } from "lucide-react";

import { cn } from "@/lib/utils";

const Breadcrumb = React.forwardRef<
  HTMLElement,
  React.ComponentPropsWithoutRef<"nav"> & {
    separator?: React.ReactNode;
  }
>(({ ...props }, ref) => <nav ref={ref} aria-label="breadcrumb" {...props} />);
Breadcrumb.displayName = "Breadcrumb";

const BreadcrumbList = React.forwardRef<HTMLOListElement, React.ComponentPropsWithoutRef<"ol">>(
  ({ className, ...props }, ref) => (
    <ol
      ref={ref}
      className={cn(
        "flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5",
        className,
      )}
      {...props}
    />
  ),
);
BreadcrumbList.displayName = "BreadcrumbList";

const BreadcrumbItem = React.forwardRef<HTMLLIElement, React.ComponentPropsWithoutRef<"li">>(
  ({ className, ...props }, ref) => (
    <li ref={ref} className={cn("inline-flex items-center gap-1.5", className)} {...props} />
  ),
);
BreadcrumbItem.displayName = "BreadcrumbItem";

const BreadcrumbLink = React.forwardRef<
  HTMLAnchorElement,
  React.ComponentPropsWithoutRef<"a"> & {
    asChild?: boolean;
  }
>(({ asChild, className, ...props }, ref) => {
  const Comp = asChild ? Slot : "a";

  return <Comp ref={ref} className={cn("transition-colors hover:text-foreground", className)} {...props} />;
});
BreadcrumbLink.displayName = "BreadcrumbLink";

const BreadcrumbPage = React.forwardRef<HTMLSpanElement, React.ComponentPropsWithoutRef<"span">>(
  ({ className, ...props }, ref) => (
    <span
      ref={ref}
      role="link"
      aria-disabled="true"
      aria-current="page"
      className={cn("font-normal text-foreground", className)}
      {...props}
    />
  ),
);
BreadcrumbPage.displayName = "BreadcrumbPage";

const BreadcrumbSeparator = ({ children, className, ...props }: React.ComponentProps<"li">) => (
  <li role="presentation" aria-hidden="true" className={cn("[&>svg]:size-3.5", className)} {...props}>
    {children ?? <ChevronRight />}
  </li>
);
BreadcrumbSeparator.displayName = "BreadcrumbSeparator";

const BreadcrumbEllipsis = ({ className, ...props }: React.ComponentProps<"span">) => (
  <span
    role="presentation"
    aria-hidden="true"
    className={cn("flex h-9 w-9 items-center justify-center", className)}
    {...props}
  >
    <MoreHorizontal className="h-4 w-4" />
    <span className="sr-only">More</span>
  </span>
);
BreadcrumbEllipsis.displayName = "BreadcrumbElipssis";

export {
  Breadcrumb,
  BreadcrumbList,
  BreadcrumbItem,
  BreadcrumbLink,
  BreadcrumbPage,
  BreadcrumbSeparator,
  BreadcrumbEllipsis,
};


================================================
FILE: D:\barter_verse\frontend\src\components\ui\button.tsx
================================================
import * as React from "react";
import { Slot } from "@radix-ui/react-slot";
import { cva, type VariantProps } from "class-variance-authority";

import { cn } from "@/lib/utils";

const buttonVariants = cva(
  "inline-flex items-center justify-center gap-2 whitespace-nowrap text-sm font-semibold transition-all duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",
  {
    variants: {
      variant: {
        default: "btn-primary",
        destructive: "bg-destructive text-destructive-foreground shadow-sm hover:shadow-md hover:bg-destructive/90",
        outline: "btn-secondary",
        secondary: "btn-secondary",
        ghost: "text-foreground hover:bg-muted hover:text-foreground",
        link: "text-primary underline-offset-4 hover:underline",
        premium: "btn-premium",
      },
      size: {
        default: "h-10 px-6 py-2 rounded-lg",
        sm: "h-9 rounded-md px-4",
        lg: "h-12 rounded-lg px-8 text-base",
        icon: "h-10 w-10 rounded-lg",
      },
    },
    defaultVariants: {
      variant: "default",
      size: "default",
    },
  },
);

export interface ButtonProps
  extends React.ButtonHTMLAttributes<HTMLButtonElement>,
    VariantProps<typeof buttonVariants> {
  asChild?: boolean;
}

const Button = React.forwardRef<HTMLButtonElement, ButtonProps>(
  ({ className, variant, size, asChild = false, ...props }, ref) => {
    const Comp = asChild ? Slot : "button";
    return <Comp className={cn(buttonVariants({ variant, size, className }))} ref={ref} {...props} />;
  },
);
Button.displayName = "Button";

export { Button, buttonVariants };


================================================
FILE: D:\barter_verse\frontend\src\components\ui\calendar.tsx
================================================
import * as React from "react";
import { ChevronLeft, ChevronRight } from "lucide-react";
import { DayPicker } from "react-day-picker";

import { cn } from "@/lib/utils";
import { buttonVariants } from "@/components/ui/button";

export type CalendarProps = React.ComponentProps<typeof DayPicker>;

function Calendar({ className, classNames, showOutsideDays = true, ...props }: CalendarProps) {
  return (
    <DayPicker
      showOutsideDays={showOutsideDays}
      className={cn("p-3", className)}
      classNames={{
        months: "flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",
        month: "space-y-4",
        caption: "flex justify-center pt-1 relative items-center",
        caption_label: "text-sm font-medium",
        nav: "space-x-1 flex items-center",
        nav_button: cn(
          buttonVariants({ variant: "outline" }),
          "h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100",
        ),
        nav_button_previous: "absolute left-1",
        nav_button_next: "absolute right-1",
        table: "w-full border-collapse space-y-1",
        head_row: "flex",
        head_cell: "text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",
        row: "flex w-full mt-2",
        cell: "h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",
        day: cn(buttonVariants({ variant: "ghost" }), "h-9 w-9 p-0 font-normal aria-selected:opacity-100"),
        day_range_end: "day-range-end",
        day_selected:
          "bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",
        day_today: "bg-accent text-accent-foreground",
        day_outside:
          "day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",
        day_disabled: "text-muted-foreground opacity-50",
        day_range_middle: "aria-selected:bg-accent aria-selected:text-accent-foreground",
        day_hidden: "invisible",
        ...classNames,
      }}
      components={{
        IconLeft: ({ ..._props }) => <ChevronLeft className="h-4 w-4" />,
        IconRight: ({ ..._props }) => <ChevronRight className="h-4 w-4" />,
      }}
      {...props}
    />
  );
}
Calendar.displayName = "Calendar";

export { Calendar };


================================================
FILE: D:\barter_verse\frontend\src\components\ui\card.tsx
================================================
import * as React from "react";

import { cn } from "@/lib/utils";

const Card = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(({ className, ...props }, ref) => (
  <div ref={ref} className={cn("card-upgrade", className)} {...props} />
));
Card.displayName = "Card";

const CardHeader = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(
  ({ className, ...props }, ref) => (
    <div ref={ref} className={cn("flex flex-col space-y-1.5 p-6", className)} {...props} />
  ),
);
CardHeader.displayName = "CardHeader";

const CardTitle = React.forwardRef<HTMLParagraphElement, React.HTMLAttributes<HTMLHeadingElement>>(
  ({ className, ...props }, ref) => (
    <h3 ref={ref} className={cn("text-2xl font-semibold leading-none tracking-tight", className)} {...props} />
  ),
);
CardTitle.displayName = "CardTitle";

const CardDescription = React.forwardRef<HTMLParagraphElement, React.HTMLAttributes<HTMLParagraphElement>>(
  ({ className, ...props }, ref) => (
    <p ref={ref} className={cn("text-sm text-muted-foreground", className)} {...props} />
  ),
);
CardDescription.displayName = "CardDescription";

const CardContent = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(
  ({ className, ...props }, ref) => <div ref={ref} className={cn("p-6 pt-0", className)} {...props} />,
);
CardContent.displayName = "CardContent";

const CardFooter = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(
  ({ className, ...props }, ref) => (
    <div ref={ref} className={cn("flex items-center p-6 pt-0", className)} {...props} />
  ),
);
CardFooter.displayName = "CardFooter";

export { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent };


================================================
FILE: D:\barter_verse\frontend\src\components\ui\carousel.tsx
================================================
import * as React from "react";
import useEmblaCarousel, { type UseEmblaCarouselType } from "embla-carousel-react";
import { ArrowLeft, ArrowRight } from "lucide-react";

import { cn } from "@/lib/utils";
import { Button } from "@/components/ui/button";

type CarouselApi = UseEmblaCarouselType[1];
type UseCarouselParameters = Parameters<typeof useEmblaCarousel>;
type CarouselOptions = UseCarouselParameters[0];
type CarouselPlugin = UseCarouselParameters[1];

type CarouselProps = {
  opts?: CarouselOptions;
  plugins?: CarouselPlugin;
  orientation?: "horizontal" | "vertical";
  setApi?: (api: CarouselApi) => void;
};

type CarouselContextProps = {
  carouselRef: ReturnType<typeof useEmblaCarousel>[0];
  api: ReturnType<typeof useEmblaCarousel>[1];
  scrollPrev: () => void;
  scrollNext: () => void;
  canScrollPrev: boolean;
  canScrollNext: boolean;
} & CarouselProps;

const CarouselContext = React.createContext<CarouselContextProps | null>(null);

function useCarousel() {
  const context = React.useContext(CarouselContext);

  if (!context) {
    throw new Error("useCarousel must be used within a <Carousel />");
  }

  return context;
}

const Carousel = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement> & CarouselProps>(
  ({ orientation = "horizontal", opts, setApi, plugins, className, children, ...props }, ref) => {
    const [carouselRef, api] = useEmblaCarousel(
      {
        ...opts,
        axis: orientation === "horizontal" ? "x" : "y",
      },
      plugins,
    );
    const [canScrollPrev, setCanScrollPrev] = React.useState(false);
    const [canScrollNext, setCanScrollNext] = React.useState(false);

    const onSelect = React.useCallback((api: CarouselApi) => {
      if (!api) {
        return;
      }

      setCanScrollPrev(api.canScrollPrev());
      setCanScrollNext(api.canScrollNext());
    }, []);

    const scrollPrev = React.useCallback(() => {
      api?.scrollPrev();
    }, [api]);

    const scrollNext = React.useCallback(() => {
      api?.scrollNext();
    }, [api]);

    const handleKeyDown = React.useCallback(
      (event: React.KeyboardEvent<HTMLDivElement>) => {
        if (event.key === "ArrowLeft") {
          event.preventDefault();
          scrollPrev();
        } else if (event.key === "ArrowRight") {
          event.preventDefault();
          scrollNext();
        }
      },
      [scrollPrev, scrollNext],
    );

    React.useEffect(() => {
      if (!api || !setApi) {
        return;
      }

      setApi(api);
    }, [api, setApi]);

    React.useEffect(() => {
      if (!api) {
        return;
      }

      onSelect(api);
      api.on("reInit", onSelect);
      api.on("select", onSelect);

      return () => {
        api?.off("select", onSelect);
      };
    }, [api, onSelect]);

    return (
      <CarouselContext.Provider
        value={{
          carouselRef,
          api: api,
          opts,
          orientation: orientation || (opts?.axis === "y" ? "vertical" : "horizontal"),
          scrollPrev,
          scrollNext,
          canScrollPrev,
          canScrollNext,
        }}
      >
        <div
          ref={ref}
          onKeyDownCapture={handleKeyDown}
          className={cn("relative", className)}
          role="region"
          aria-roledescription="carousel"
          {...props}
        >
          {children}
        </div>
      </CarouselContext.Provider>
    );
  },
);
Carousel.displayName = "Carousel";

const CarouselContent = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(
  ({ className, ...props }, ref) => {
    const { carouselRef, orientation } = useCarousel();

    return (
      <div ref={carouselRef} className="overflow-hidden">
        <div
          ref={ref}
          className={cn("flex", orientation === "horizontal" ? "-ml-4" : "-mt-4 flex-col", className)}
          {...props}
        />
      </div>
    );
  },
);
CarouselContent.displayName = "CarouselContent";

const CarouselItem = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(
  ({ className, ...props }, ref) => {
    const { orientation } = useCarousel();

    return (
      <div
        ref={ref}
        role="group"
        aria-roledescription="slide"
        className={cn("min-w-0 shrink-0 grow-0 basis-full", orientation === "horizontal" ? "pl-4" : "pt-4", className)}
        {...props}
      />
    );
  },
);
CarouselItem.displayName = "CarouselItem";

const CarouselPrevious = React.forwardRef<HTMLButtonElement, React.ComponentProps<typeof Button>>(
  ({ className, variant = "outline", size = "icon", ...props }, ref) => {
    const { orientation, scrollPrev, canScrollPrev } = useCarousel();

    return (
      <Button
        ref={ref}
        variant={variant}
        size={size}
        className={cn(
          "absolute h-8 w-8 rounded-full",
          orientation === "horizontal"
            ? "-left-12 top-1/2 -translate-y-1/2"
            : "-top-12 left-1/2 -translate-x-1/2 rotate-90",
          className,
        )}
        disabled={!canScrollPrev}
        onClick={scrollPrev}
        {...props}
      >
        <ArrowLeft className="h-4 w-4" />
        <span className="sr-only">Previous slide</span>
      </Button>
    );
  },
);
CarouselPrevious.displayName = "CarouselPrevious";

const CarouselNext = React.forwardRef<HTMLButtonElement, React.ComponentProps<typeof Button>>(
  ({ className, variant = "outline", size = "icon", ...props }, ref) => {
    const { orientation, scrollNext, canScrollNext } = useCarousel();

    return (
      <Button
        ref={ref}
        variant={variant}
        size={size}
        className={cn(
          "absolute h-8 w-8 rounded-full",
          orientation === "horizontal"
            ? "-right-12 top-1/2 -translate-y-1/2"
            : "-bottom-12 left-1/2 -translate-x-1/2 rotate-90",
          className,
        )}
        disabled={!canScrollNext}
        onClick={scrollNext}
        {...props}
      >
        <ArrowRight className="h-4 w-4" />
        <span className="sr-only">Next slide</span>
      </Button>
    );
  },
);
CarouselNext.displayName = "CarouselNext";

export { type CarouselApi, Carousel, CarouselContent, CarouselItem, CarouselPrevious, CarouselNext };


================================================
FILE: D:\barter_verse\frontend\src\components\ui\chart.tsx
================================================
import * as React from "react";
import * as RechartsPrimitive from "recharts";

import { cn } from "@/lib/utils";

// Format: { THEME_NAME: CSS_SELECTOR }
const THEMES = { light: "", dark: ".dark" } as const;

export type ChartConfig = {
  [k in string]: {
    label?: React.ReactNode;
    icon?: React.ComponentType;
  } & ({ color?: string; theme?: never } | { color?: never; theme: Record<keyof typeof THEMES, string> });
};

type ChartContextProps = {
  config: ChartConfig;
};

const ChartContext = React.createContext<ChartContextProps | null>(null);

function useChart() {
  const context = React.useContext(ChartContext);

  if (!context) {
    throw new Error("useChart must be used within a <ChartContainer />");
  }

  return context;
}

const ChartContainer = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<"div"> & {
    config: ChartConfig;
    children: React.ComponentProps<typeof RechartsPrimitive.ResponsiveContainer>["children"];
  }
>(({ id, className, children, config, ...props }, ref) => {
  const uniqueId = React.useId();
  const chartId = `chart-${id || uniqueId.replace(/:/g, "")}`;

  return (
    <ChartContext.Provider value={{ config }}>
      <div
        data-chart={chartId}
        ref={ref}
        className={cn(
          "flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none",
          className,
        )}
        {...props}
      >
        <ChartStyle id={chartId} config={config} />
        <RechartsPrimitive.ResponsiveContainer>{children}</RechartsPrimitive.ResponsiveContainer>
      </div>
    </ChartContext.Provider>
  );
});
ChartContainer.displayName = "Chart";

const ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {
  const colorConfig = Object.entries(config).filter(([_, config]) => config.theme || config.color);

  if (!colorConfig.length) {
    return null;
  }

  return (
    <style
      dangerouslySetInnerHTML={{
        __html: Object.entries(THEMES)
          .map(
            ([theme, prefix]) => `
${prefix} [data-chart=${id}] {
${colorConfig
  .map(([key, itemConfig]) => {
    const color = itemConfig.theme?.[theme as keyof typeof itemConfig.theme] || itemConfig.color;
    return color ? `  --color-${key}: ${color};` : null;
  })
  .join("\n")}
}
`,
          )
          .join("\n"),
      }}
    />
  );
};

const ChartTooltip = RechartsPrimitive.Tooltip;

const ChartTooltipContent = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<typeof RechartsPrimitive.Tooltip> &
    React.ComponentProps<"div"> & {
      hideLabel?: boolean;
      hideIndicator?: boolean;
      indicator?: "line" | "dot" | "dashed";
      nameKey?: string;
      labelKey?: string;
    }
>(
  (
    {
      active,
      payload,
      className,
      indicator = "dot",
      hideLabel = false,
      hideIndicator = false,
      label,
      labelFormatter,
      labelClassName,
      formatter,
      color,
      nameKey,
      labelKey,
    },
    ref,
  ) => {
    const { config } = useChart();

    const tooltipLabel = React.useMemo(() => {
      if (hideLabel || !payload?.length) {
        return null;
      }

      const [item] = payload;
      const key = `${labelKey || item.dataKey || item.name || "value"}`;
      const itemConfig = getPayloadConfigFromPayload(config, item, key);
      const value =
        !labelKey && typeof label === "string"
          ? config[label as keyof typeof config]?.label || label
          : itemConfig?.label;

      if (labelFormatter) {
        return <div className={cn("font-medium", labelClassName)}>{labelFormatter(value, payload)}</div>;
      }

      if (!value) {
        return null;
      }

      return <div className={cn("font-medium", labelClassName)}>{value}</div>;
    }, [label, labelFormatter, payload, hideLabel, labelClassName, config, labelKey]);

    if (!active || !payload?.length) {
      return null;
    }

    const nestLabel = payload.length === 1 && indicator !== "dot";

    return (
      <div
        ref={ref}
        className={cn(
          "grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl",
          className,
        )}
      >
        {!nestLabel ? tooltipLabel : null}
        <div className="grid gap-1.5">
          {payload.map((item, index) => {
            const key = `${nameKey || item.name || item.dataKey || "value"}`;
            const itemConfig = getPayloadConfigFromPayload(config, item, key);
            const indicatorColor = color || item.payload.fill || item.color;

            return (
              <div
                key={item.dataKey}
                className={cn(
                  "flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground",
                  indicator === "dot" && "items-center",
                )}
              >
                {formatter && item?.value !== undefined && item.name ? (
                  formatter(item.value, item.name, item, index, item.payload)
                ) : (
                  <>
                    {itemConfig?.icon ? (
                      <itemConfig.icon />
                    ) : (
                      !hideIndicator && (
                        <div
                          className={cn("shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]", {
                            "h-2.5 w-2.5": indicator === "dot",
                            "w-1": indicator === "line",
                            "w-0 border-[1.5px] border-dashed bg-transparent": indicator === "dashed",
                            "my-0.5": nestLabel && indicator === "dashed",
                          })}
                          style={
                            {
                              "--color-bg": indicatorColor,
                              "--color-border": indicatorColor,
                            } as React.CSSProperties
                          }
                        />
                      )
                    )}
                    <div
                      className={cn(
                        "flex flex-1 justify-between leading-none",
                        nestLabel ? "items-end" : "items-center",
                      )}
                    >
                      <div className="grid gap-1.5">
                        {nestLabel ? tooltipLabel : null}
                        <span className="text-muted-foreground">{itemConfig?.label || item.name}</span>
                      </div>
                      {item.value && (
                        <span className="font-mono font-medium tabular-nums text-foreground">
                          {item.value.toLocaleString()}
                        </span>
                      )}
                    </div>
                  </>
                )}
              </div>
            );
          })}
        </div>
      </div>
    );
  },
);
ChartTooltipContent.displayName = "ChartTooltip";

const ChartLegend = RechartsPrimitive.Legend;

const ChartLegendContent = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<"div"> &
    Pick<RechartsPrimitive.LegendProps, "payload" | "verticalAlign"> & {
      hideIcon?: boolean;
      nameKey?: string;
    }
>(({ className, hideIcon = false, payload, verticalAlign = "bottom", nameKey }, ref) => {
  const { config } = useChart();

  if (!payload?.length) {
    return null;
  }

  return (
    <div
      ref={ref}
      className={cn("flex items-center justify-center gap-4", verticalAlign === "top" ? "pb-3" : "pt-3", className)}
    >
      {payload.map((item) => {
        const key = `${nameKey || item.dataKey || "value"}`;
        const itemConfig = getPayloadConfigFromPayload(config, item, key);

        return (
          <div
            key={item.value}
            className={cn("flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground")}
          >
            {itemConfig?.icon && !hideIcon ? (
              <itemConfig.icon />
            ) : (
              <div
                className="h-2 w-2 shrink-0 rounded-[2px]"
                style={{
                  backgroundColor: item.color,
                }}
              />
            )}
            {itemConfig?.label}
          </div>
        );
      })}
    </div>
  );
});
ChartLegendContent.displayName = "ChartLegend";

// Helper to extract item config from a payload.
function getPayloadConfigFromPayload(config: ChartConfig, payload: unknown, key: string) {
  if (typeof payload !== "object" || payload === null) {
    return undefined;
  }

  const payloadPayload =
    "payload" in payload && typeof payload.payload === "object" && payload.payload !== null
      ? payload.payload
      : undefined;

  let configLabelKey: string = key;

  if (key in payload && typeof payload[key as keyof typeof payload] === "string") {
    configLabelKey = payload[key as keyof typeof payload] as string;
  } else if (
    payloadPayload &&
    key in payloadPayload &&
    typeof payloadPayload[key as keyof typeof payloadPayload] === "string"
  ) {
    configLabelKey = payloadPayload[key as keyof typeof payloadPayload] as string;
  }

  return configLabelKey in config ? config[configLabelKey] : config[key as keyof typeof config];
}

export { ChartContainer, ChartTooltip, ChartTooltipContent, ChartLegend, ChartLegendContent, ChartStyle };


================================================
FILE: D:\barter_verse\frontend\src\components\ui\checkbox.tsx
================================================
import * as React from "react";
import * as CheckboxPrimitive from "@radix-ui/react-checkbox";
import { Check } from "lucide-react";

import { cn } from "@/lib/utils";

const Checkbox = React.forwardRef<
  React.ElementRef<typeof CheckboxPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>
>(({ className, ...props }, ref) => (
  <CheckboxPrimitive.Root
    ref={ref}
    className={cn(
      "peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",
      className,
    )}
    {...props}
  >
    <CheckboxPrimitive.Indicator className={cn("flex items-center justify-center text-current")}>
      <Check className="h-4 w-4" />
    </CheckboxPrimitive.Indicator>
  </CheckboxPrimitive.Root>
));
Checkbox.displayName = CheckboxPrimitive.Root.displayName;

export { Checkbox };


================================================
FILE: D:\barter_verse\frontend\src\components\ui\collapsible.tsx
================================================
import * as CollapsiblePrimitive from "@radix-ui/react-collapsible";

const Collapsible = CollapsiblePrimitive.Root;

const CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger;

const CollapsibleContent = CollapsiblePrimitive.CollapsibleContent;

export { Collapsible, CollapsibleTrigger, CollapsibleContent };


================================================
FILE: D:\barter_verse\frontend\src\components\ui\command.tsx
================================================
import * as React from "react";
import { type DialogProps } from "@radix-ui/react-dialog";
import { Command as CommandPrimitive } from "cmdk";
import { Search } from "lucide-react";

import { cn } from "@/lib/utils";
import { Dialog, DialogContent } from "@/components/ui/dialog";

const Command = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive>
>(({ className, ...props }, ref) => (
  <CommandPrimitive
    ref={ref}
    className={cn(
      "flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",
      className,
    )}
    {...props}
  />
));
Command.displayName = CommandPrimitive.displayName;

interface CommandDialogProps extends DialogProps {}

const CommandDialog = ({ children, ...props }: CommandDialogProps) => {
  return (
    <Dialog {...props}>
      <DialogContent className="overflow-hidden p-0 shadow-lg">
        <Command className="[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5">
          {children}
        </Command>
      </DialogContent>
    </Dialog>
  );
};

const CommandInput = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive.Input>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>
>(({ className, ...props }, ref) => (
  <div className="flex items-center border-b px-3" cmdk-input-wrapper="">
    <Search className="mr-2 h-4 w-4 shrink-0 opacity-50" />
    <CommandPrimitive.Input
      ref={ref}
      className={cn(
        "flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",
        className,
      )}
      {...props}
    />
  </div>
));

CommandInput.displayName = CommandPrimitive.Input.displayName;

const CommandList = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive.List>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>
>(({ className, ...props }, ref) => (
  <CommandPrimitive.List
    ref={ref}
    className={cn("max-h-[300px] overflow-y-auto overflow-x-hidden", className)}
    {...props}
  />
));

CommandList.displayName = CommandPrimitive.List.displayName;

const CommandEmpty = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive.Empty>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>
>((props, ref) => <CommandPrimitive.Empty ref={ref} className="py-6 text-center text-sm" {...props} />);

CommandEmpty.displayName = CommandPrimitive.Empty.displayName;

const CommandGroup = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive.Group>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>
>(({ className, ...props }, ref) => (
  <CommandPrimitive.Group
    ref={ref}
    className={cn(
      "overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",
      className,
    )}
    {...props}
  />
));

CommandGroup.displayName = CommandPrimitive.Group.displayName;

const CommandSeparator = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive.Separator>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>
>(({ className, ...props }, ref) => (
  <CommandPrimitive.Separator ref={ref} className={cn("-mx-1 h-px bg-border", className)} {...props} />
));
CommandSeparator.displayName = CommandPrimitive.Separator.displayName;

const CommandItem = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>
>(({ className, ...props }, ref) => (
  <CommandPrimitive.Item
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50",
      className,
    )}
    {...props}
  />
));

CommandItem.displayName = CommandPrimitive.Item.displayName;

const CommandShortcut = ({ className, ...props }: React.HTMLAttributes<HTMLSpanElement>) => {
  return <span className={cn("ml-auto text-xs tracking-widest text-muted-foreground", className)} {...props} />;
};
CommandShortcut.displayName = "CommandShortcut";

export {
  Command,
  CommandDialog,
  CommandInput,
  CommandList,
  CommandEmpty,
  CommandGroup,
  CommandItem,
  CommandShortcut,
  CommandSeparator,
};


================================================
FILE: D:\barter_verse\frontend\src\components\ui\context-menu.tsx
================================================
import * as React from "react";
import * as ContextMenuPrimitive from "@radix-ui/react-context-menu";
import { Check, ChevronRight, Circle } from "lucide-react";

import { cn } from "@/lib/utils";

const ContextMenu = ContextMenuPrimitive.Root;

const ContextMenuTrigger = ContextMenuPrimitive.Trigger;

const ContextMenuGroup = ContextMenuPrimitive.Group;

const ContextMenuPortal = ContextMenuPrimitive.Portal;

const ContextMenuSub = ContextMenuPrimitive.Sub;

const ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup;

const ContextMenuSubTrigger = React.forwardRef<
  React.ElementRef<typeof ContextMenuPrimitive.SubTrigger>,
  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubTrigger> & {
    inset?: boolean;
  }
>(({ className, inset, children, ...props }, ref) => (
  <ContextMenuPrimitive.SubTrigger
    ref={ref}
    className={cn(
      "flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[state=open]:bg-accent data-[state=open]:text-accent-foreground focus:bg-accent focus:text-accent-foreground",
      inset && "pl-8",
      className,
    )}
    {...props}
  >
    {children}
    <ChevronRight className="ml-auto h-4 w-4" />
  </ContextMenuPrimitive.SubTrigger>
));
ContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName;

const ContextMenuSubContent = React.forwardRef<
  React.ElementRef<typeof ContextMenuPrimitive.SubContent>,
  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubContent>
>(({ className, ...props }, ref) => (
  <ContextMenuPrimitive.SubContent
    ref={ref}
    className={cn(
      "z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
      className,
    )}
    {...props}
  />
));
ContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName;

const ContextMenuContent = React.forwardRef<
  React.ElementRef<typeof ContextMenuPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Content>
>(({ className, ...props }, ref) => (
  <ContextMenuPrimitive.Portal>
    <ContextMenuPrimitive.Content
      ref={ref}
      className={cn(
        "z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
        className,
      )}
      {...props}
    />
  </ContextMenuPrimitive.Portal>
));
ContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName;

const ContextMenuItem = React.forwardRef<
  React.ElementRef<typeof ContextMenuPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Item> & {
    inset?: boolean;
  }
>(({ className, inset, ...props }, ref) => (
  <ContextMenuPrimitive.Item
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",
      inset && "pl-8",
      className,
    )}
    {...props}
  />
));
ContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName;

const ContextMenuCheckboxItem = React.forwardRef<
  React.ElementRef<typeof ContextMenuPrimitive.CheckboxItem>,
  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.CheckboxItem>
>(({ className, children, checked, ...props }, ref) => (
  <ContextMenuPrimitive.CheckboxItem
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",
      className,
    )}
    checked={checked}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <ContextMenuPrimitive.ItemIndicator>
        <Check className="h-4 w-4" />
      </ContextMenuPrimitive.ItemIndicator>
    </span>
    {children}
  </ContextMenuPrimitive.CheckboxItem>
));
ContextMenuCheckboxItem.displayName = ContextMenuPrimitive.CheckboxItem.displayName;

const ContextMenuRadioItem = React.forwardRef<
  React.ElementRef<typeof ContextMenuPrimitive.RadioItem>,
  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.RadioItem>
>(({ className, children, ...props }, ref) => (
  <ContextMenuPrimitive.RadioItem
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",
      className,
    )}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <ContextMenuPrimitive.ItemIndicator>
        <Circle className="h-2 w-2 fill-current" />
      </ContextMenuPrimitive.ItemIndicator>
    </span>
    {children}
  </ContextMenuPrimitive.RadioItem>
));
ContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName;

const ContextMenuLabel = React.forwardRef<
  React.ElementRef<typeof ContextMenuPrimitive.Label>,
  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Label> & {
    inset?: boolean;
  }
>(({ className, inset, ...props }, ref) => (
  <ContextMenuPrimitive.Label
    ref={ref}
    className={cn("px-2 py-1.5 text-sm font-semibold text-foreground", inset && "pl-8", className)}
    {...props}
  />
));
ContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName;

const ContextMenuSeparator = React.forwardRef<
  React.ElementRef<typeof ContextMenuPrimitive.Separator>,
  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Separator>
>(({ className, ...props }, ref) => (
  <ContextMenuPrimitive.Separator ref={ref} className={cn("-mx-1 my-1 h-px bg-border", className)} {...props} />
));
ContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName;

const ContextMenuShortcut = ({ className, ...props }: React.HTMLAttributes<HTMLSpanElement>) => {
  return <span className={cn("ml-auto text-xs tracking-widest text-muted-foreground", className)} {...props} />;
};
ContextMenuShortcut.displayName = "ContextMenuShortcut";

export {
  ContextMenu,
  ContextMenuTrigger,
  ContextMenuContent,
  ContextMenuItem,
  ContextMenuCheckboxItem,
  ContextMenuRadioItem,
  ContextMenuLabel,
  ContextMenuSeparator,
  ContextMenuShortcut,
  ContextMenuGroup,
  ContextMenuPortal,
  ContextMenuSub,
  ContextMenuSubContent,
  ContextMenuSubTrigger,
  ContextMenuRadioGroup,
};


================================================
FILE: D:\barter_verse\frontend\src\components\ui\dialog.tsx
================================================
import * as React from "react";
import * as DialogPrimitive from "@radix-ui/react-dialog";
import { X } from "lucide-react";

import { cn } from "@/lib/utils";

const Dialog = DialogPrimitive.Root;

const DialogTrigger = DialogPrimitive.Trigger;

const DialogPortal = DialogPrimitive.Portal;

const DialogClose = DialogPrimitive.Close;

const DialogOverlay = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Overlay>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>
>(({ className, ...props }, ref) => (
  <DialogPrimitive.Overlay
    ref={ref}
    className={cn(
      "fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",
      className,
    )}
    {...props}
  />
));
DialogOverlay.displayName = DialogPrimitive.Overlay.displayName;

const DialogContent = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>
>(({ className, children, ...props }, ref) => (
  <DialogPortal>
    <DialogOverlay />
    <DialogPrimitive.Content
      ref={ref}
      className={cn(
        "fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",
        className,
      )}
      {...props}
    >
      {children}
      <DialogPrimitive.Close className="absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity data-[state=open]:bg-accent data-[state=open]:text-muted-foreground hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none">
        <X className="h-4 w-4" />
        <span className="sr-only">Close</span>
      </DialogPrimitive.Close>
    </DialogPrimitive.Content>
  </DialogPortal>
));
DialogContent.displayName = DialogPrimitive.Content.displayName;

const DialogHeader = ({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) => (
  <div className={cn("flex flex-col space-y-1.5 text-center sm:text-left", className)} {...props} />
);
DialogHeader.displayName = "DialogHeader";

const DialogFooter = ({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) => (
  <div className={cn("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2", className)} {...props} />
);
DialogFooter.displayName = "DialogFooter";

const DialogTitle = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Title>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>
>(({ className, ...props }, ref) => (
  <DialogPrimitive.Title
    ref={ref}
    className={cn("text-lg font-semibold leading-none tracking-tight", className)}
    {...props}
  />
));
DialogTitle.displayName = DialogPrimitive.Title.displayName;

const DialogDescription = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Description>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>
>(({ className, ...props }, ref) => (
  <DialogPrimitive.Description ref={ref} className={cn("text-sm text-muted-foreground", className)} {...props} />
));
DialogDescription.displayName = DialogPrimitive.Description.displayName;

export {
  Dialog,
  DialogPortal,
  DialogOverlay,
  DialogClose,
  DialogTrigger,
  DialogContent,
  DialogHeader,
  DialogFooter,
  DialogTitle,
  DialogDescription,
};


================================================
FILE: D:\barter_verse\frontend\src\components\ui\drawer.tsx
================================================
import * as React from "react";
import { Drawer as DrawerPrimitive } from "vaul";

import { cn } from "@/lib/utils";

const Drawer = ({ shouldScaleBackground = true, ...props }: React.ComponentProps<typeof DrawerPrimitive.Root>) => (
  <DrawerPrimitive.Root shouldScaleBackground={shouldScaleBackground} {...props} />
);
Drawer.displayName = "Drawer";

const DrawerTrigger = DrawerPrimitive.Trigger;

const DrawerPortal = DrawerPrimitive.Portal;

const DrawerClose = DrawerPrimitive.Close;

const DrawerOverlay = React.forwardRef<
  React.ElementRef<typeof DrawerPrimitive.Overlay>,
  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>
>(({ className, ...props }, ref) => (
  <DrawerPrimitive.Overlay ref={ref} className={cn("fixed inset-0 z-50 bg-black/80", className)} {...props} />
));
DrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName;

const DrawerContent = React.forwardRef<
  React.ElementRef<typeof DrawerPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>
>(({ className, children, ...props }, ref) => (
  <DrawerPortal>
    <DrawerOverlay />
    <DrawerPrimitive.Content
      ref={ref}
      className={cn(
        "fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background",
        className,
      )}
      {...props}
    >
      <div className="mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted" />
      {children}
    </DrawerPrimitive.Content>
  </DrawerPortal>
));
DrawerContent.displayName = "DrawerContent";

const DrawerHeader = ({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) => (
  <div className={cn("grid gap-1.5 p-4 text-center sm:text-left", className)} {...props} />
);
DrawerHeader.displayName = "DrawerHeader";

const DrawerFooter = ({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) => (
  <div className={cn("mt-auto flex flex-col gap-2 p-4", className)} {...props} />
);
DrawerFooter.displayName = "DrawerFooter";

const DrawerTitle = React.forwardRef<
  React.ElementRef<typeof DrawerPrimitive.Title>,
  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>
>(({ className, ...props }, ref) => (
  <DrawerPrimitive.Title
    ref={ref}
    className={cn("text-lg font-semibold leading-none tracking-tight", className)}
    {...props}
  />
));
DrawerTitle.displayName = DrawerPrimitive.Title.displayName;

const DrawerDescription = React.forwardRef<
  React.ElementRef<typeof DrawerPrimitive.Description>,
  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>
>(({ className, ...props }, ref) => (
  <DrawerPrimitive.Description ref={ref} className={cn("text-sm text-muted-foreground", className)} {...props} />
));
DrawerDescription.displayName = DrawerPrimitive.Description.displayName;

export {
  Drawer,
  DrawerPortal,
  DrawerOverlay,
  DrawerTrigger,
  DrawerClose,
  DrawerContent,
  DrawerHeader,
  DrawerFooter,
  DrawerTitle,
  DrawerDescription,
};


================================================
FILE: D:\barter_verse\frontend\src\components\ui\dropdown-menu.tsx
================================================
import * as React from "react";
import * as DropdownMenuPrimitive from "@radix-ui/react-dropdown-menu";
import { Check, ChevronRight, Circle } from "lucide-react";

import { cn } from "@/lib/utils";

const DropdownMenu = DropdownMenuPrimitive.Root;

const DropdownMenuTrigger = DropdownMenuPrimitive.Trigger;

const DropdownMenuGroup = DropdownMenuPrimitive.Group;

const DropdownMenuPortal = DropdownMenuPrimitive.Portal;

const DropdownMenuSub = DropdownMenuPrimitive.Sub;

const DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup;

const DropdownMenuSubTrigger = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {
    inset?: boolean;
  }
>(({ className, inset, children, ...props }, ref) => (
  <DropdownMenuPrimitive.SubTrigger
    ref={ref}
    className={cn(
      "flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[state=open]:bg-accent focus:bg-accent",
      inset && "pl-8",
      className,
    )}
    {...props}
  >
    {children}
    <ChevronRight className="ml-auto h-4 w-4" />
  </DropdownMenuPrimitive.SubTrigger>
));
DropdownMenuSubTrigger.displayName = DropdownMenuPrimitive.SubTrigger.displayName;

const DropdownMenuSubContent = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>
>(({ className, ...props }, ref) => (
  <DropdownMenuPrimitive.SubContent
    ref={ref}
    className={cn(
      "z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
      className,
    )}
    {...props}
  />
));
DropdownMenuSubContent.displayName = DropdownMenuPrimitive.SubContent.displayName;

const DropdownMenuContent = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>
>(({ className, sideOffset = 4, ...props }, ref) => (
  <DropdownMenuPrimitive.Portal>
    <DropdownMenuPrimitive.Content
      ref={ref}
      sideOffset={sideOffset}
      className={cn(
        "z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
        className,
      )}
      {...props}
    />
  </DropdownMenuPrimitive.Portal>
));
DropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName;

const DropdownMenuItem = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {
    inset?: boolean;
  }
>(({ className, inset, ...props }, ref) => (
  <DropdownMenuPrimitive.Item
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",
      inset && "pl-8",
      className,
    )}
    {...props}
  />
));
DropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName;

const DropdownMenuCheckboxItem = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>
>(({ className, children, checked, ...props }, ref) => (
  <DropdownMenuPrimitive.CheckboxItem
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",
      className,
    )}
    checked={checked}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <DropdownMenuPrimitive.ItemIndicator>
        <Check className="h-4 w-4" />
      </DropdownMenuPrimitive.ItemIndicator>
    </span>
    {children}
  </DropdownMenuPrimitive.CheckboxItem>
));
DropdownMenuCheckboxItem.displayName = DropdownMenuPrimitive.CheckboxItem.displayName;

const DropdownMenuRadioItem = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>
>(({ className, children, ...props }, ref) => (
  <DropdownMenuPrimitive.RadioItem
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",
      className,
    )}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <DropdownMenuPrimitive.ItemIndicator>
        <Circle className="h-2 w-2 fill-current" />
      </DropdownMenuPrimitive.ItemIndicator>
    </span>
    {children}
  </DropdownMenuPrimitive.RadioItem>
));
DropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName;

const DropdownMenuLabel = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.Label>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {
    inset?: boolean;
  }
>(({ className, inset, ...props }, ref) => (
  <DropdownMenuPrimitive.Label
    ref={ref}
    className={cn("px-2 py-1.5 text-sm font-semibold", inset && "pl-8", className)}
    {...props}
  />
));
DropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName;

const DropdownMenuSeparator = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>
>(({ className, ...props }, ref) => (
  <DropdownMenuPrimitive.Separator ref={ref} className={cn("-mx-1 my-1 h-px bg-muted", className)} {...props} />
));
DropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName;

const DropdownMenuShortcut = ({ className, ...props }: React.HTMLAttributes<HTMLSpanElement>) => {
  return <span className={cn("ml-auto text-xs tracking-widest opacity-60", className)} {...props} />;
};
DropdownMenuShortcut.displayName = "DropdownMenuShortcut";

export {
  DropdownMenu,
  DropdownMenuTrigger,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuCheckboxItem,
  DropdownMenuRadioItem,
  DropdownMenuLabel,
  DropdownMenuSeparator,
  DropdownMenuShortcut,
  DropdownMenuGroup,
  DropdownMenuPortal,
  DropdownMenuSub,
  DropdownMenuSubContent,
  DropdownMenuSubTrigger,
  DropdownMenuRadioGroup,
};


================================================
FILE: D:\barter_verse\frontend\src\components\ui\form.tsx
================================================
import * as React from "react";
import * as LabelPrimitive from "@radix-ui/react-label";
import { Slot } from "@radix-ui/react-slot";
import { Controller, ControllerProps, FieldPath, FieldValues, FormProvider, useFormContext } from "react-hook-form";

import { cn } from "@/lib/utils";
import { Label } from "@/components/ui/label";

const Form = FormProvider;

type FormFieldContextValue<
  TFieldValues extends FieldValues = FieldValues,
  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>,
> = {
  name: TName;
};

const FormFieldContext = React.createContext<FormFieldContextValue>({} as FormFieldContextValue);

const FormField = <
  TFieldValues extends FieldValues = FieldValues,
  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>,
>({
  ...props
}: ControllerProps<TFieldValues, TName>) => {
  return (
    <FormFieldContext.Provider value={{ name: props.name }}>
      <Controller {...props} />
    </FormFieldContext.Provider>
  );
};

const useFormField = () => {
  const fieldContext = React.useContext(FormFieldContext);
  const itemContext = React.useContext(FormItemContext);
  const { getFieldState, formState } = useFormContext();

  const fieldState = getFieldState(fieldContext.name, formState);

  if (!fieldContext) {
    throw new Error("useFormField should be used within <FormField>");
  }

  const { id } = itemContext;

  return {
    id,
    name: fieldContext.name,
    formItemId: `${id}-form-item`,
    formDescriptionId: `${id}-form-item-description`,
    formMessageId: `${id}-form-item-message`,
    ...fieldState,
  };
};

type FormItemContextValue = {
  id: string;
};

const FormItemContext = React.createContext<FormItemContextValue>({} as FormItemContextValue);

const FormItem = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(
  ({ className, ...props }, ref) => {
    const id = React.useId();

    return (
      <FormItemContext.Provider value={{ id }}>
        <div ref={ref} className={cn("space-y-2", className)} {...props} />
      </FormItemContext.Provider>
    );
  },
);
FormItem.displayName = "FormItem";

const FormLabel = React.forwardRef<
  React.ElementRef<typeof LabelPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>
>(({ className, ...props }, ref) => {
  const { error, formItemId } = useFormField();

  return <Label ref={ref} className={cn(error && "text-destructive", className)} htmlFor={formItemId} {...props} />;
});
FormLabel.displayName = "FormLabel";

const FormControl = React.forwardRef<React.ElementRef<typeof Slot>, React.ComponentPropsWithoutRef<typeof Slot>>(
  ({ ...props }, ref) => {
    const { error, formItemId, formDescriptionId, formMessageId } = useFormField();

    return (
      <Slot
        ref={ref}
        id={formItemId}
        aria-describedby={!error ? `${formDescriptionId}` : `${formDescriptionId} ${formMessageId}`}
        aria-invalid={!!error}
        {...props}
      />
    );
  },
);
FormControl.displayName = "FormControl";

const FormDescription = React.forwardRef<HTMLParagraphElement, React.HTMLAttributes<HTMLParagraphElement>>(
  ({ className, ...props }, ref) => {
    const { formDescriptionId } = useFormField();

    return <p ref={ref} id={formDescriptionId} className={cn("text-sm text-muted-foreground", className)} {...props} />;
  },
);
FormDescription.displayName = "FormDescription";

const FormMessage = React.forwardRef<HTMLParagraphElement, React.HTMLAttributes<HTMLParagraphElement>>(
  ({ className, children, ...props }, ref) => {
    const { error, formMessageId } = useFormField();
    const body = error ? String(error?.message) : children;

    if (!body) {
      return null;
    }

    return (
      <p ref={ref} id={formMessageId} className={cn("text-sm font-medium text-destructive", className)} {...props}>
        {body}
      </p>
    );
  },
);
FormMessage.displayName = "FormMessage";

export { useFormField, Form, FormItem, FormLabel, FormControl, FormDescription, FormMessage, FormField };


================================================
FILE: D:\barter_verse\frontend\src\components\ui\hover-card.tsx
================================================
import * as React from "react";
import * as HoverCardPrimitive from "@radix-ui/react-hover-card";

import { cn } from "@/lib/utils";

const HoverCard = HoverCardPrimitive.Root;

const HoverCardTrigger = HoverCardPrimitive.Trigger;

const HoverCardContent = React.forwardRef<
  React.ElementRef<typeof HoverCardPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof HoverCardPrimitive.Content>
>(({ className, align = "center", sideOffset = 4, ...props }, ref) => (
  <HoverCardPrimitive.Content
    ref={ref}
    align={align}
    sideOffset={sideOffset}
    className={cn(
      "z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
      className,
    )}
    {...props}
  />
));
HoverCardContent.displayName = HoverCardPrimitive.Content.displayName;

export { HoverCard, HoverCardTrigger, HoverCardContent };


================================================
FILE: D:\barter_verse\frontend\src\components\ui\input-otp.tsx
================================================
import * as React from "react";
import { OTPInput, OTPInputContext } from "input-otp";
import { Dot } from "lucide-react";

import { cn } from "@/lib/utils";

const InputOTP = React.forwardRef<React.ElementRef<typeof OTPInput>, React.ComponentPropsWithoutRef<typeof OTPInput>>(
  ({ className, containerClassName, ...props }, ref) => (
    <OTPInput
      ref={ref}
      containerClassName={cn("flex items-center gap-2 has-[:disabled]:opacity-50", containerClassName)}
      className={cn("disabled:cursor-not-allowed", className)}
      {...props}
    />
  ),
);
InputOTP.displayName = "InputOTP";

const InputOTPGroup = React.forwardRef<React.ElementRef<"div">, React.ComponentPropsWithoutRef<"div">>(
  ({ className, ...props }, ref) => <div ref={ref} className={cn("flex items-center", className)} {...props} />,
);
InputOTPGroup.displayName = "InputOTPGroup";

const InputOTPSlot = React.forwardRef<
  React.ElementRef<"div">,
  React.ComponentPropsWithoutRef<"div"> & { index: number }
>(({ index, className, ...props }, ref) => {
  const inputOTPContext = React.useContext(OTPInputContext);
  const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index];

  return (
    <div
      ref={ref}
      className={cn(
        "relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md",
        isActive && "z-10 ring-2 ring-ring ring-offset-background",
        className,
      )}
      {...props}
    >
      {char}
      {hasFakeCaret && (
        <div className="pointer-events-none absolute inset-0 flex items-center justify-center">
          <div className="animate-caret-blink h-4 w-px bg-foreground duration-1000" />
        </div>
      )}
    </div>
  );
});
InputOTPSlot.displayName = "InputOTPSlot";

const InputOTPSeparator = React.forwardRef<React.ElementRef<"div">, React.ComponentPropsWithoutRef<"div">>(
  ({ ...props }, ref) => (
    <div ref={ref} role="separator" {...props}>
      <Dot />
    </div>
  ),
);
InputOTPSeparator.displayName = "InputOTPSeparator";

export { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator };


================================================
FILE: D:\barter_verse\frontend\src\components\ui\input.tsx
================================================
import * as React from "react";

import { cn } from "@/lib/utils";

const Input = React.forwardRef<HTMLInputElement, React.ComponentProps<"input">>(
  ({ className, type, ...props }, ref) => {
    return (
      <input
        type={type}
        className={cn(
          "flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",
          className,
        )}
        ref={ref}
        {...props}
      />
    );
  },
);
Input.displayName = "Input";

export { Input };


================================================
FILE: D:\barter_verse\frontend\src\components\ui\label.tsx
================================================
import * as React from "react";
import * as LabelPrimitive from "@radix-ui/react-label";
import { cva, type VariantProps } from "class-variance-authority";

import { cn } from "@/lib/utils";

const labelVariants = cva("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70");

const Label = React.forwardRef<
  React.ElementRef<typeof LabelPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> & VariantProps<typeof labelVariants>
>(({ className, ...props }, ref) => (
  <LabelPrimitive.Root ref={ref} className={cn(labelVariants(), className)} {...props} />
));
Label.displayName = LabelPrimitive.Root.displayName;

export { Label };


================================================
FILE: D:\barter_verse\frontend\src\components\ui\menubar.tsx
================================================
import * as React from "react";
import * as MenubarPrimitive from "@radix-ui/react-menubar";
import { Check, ChevronRight, Circle } from "lucide-react";

import { cn } from "@/lib/utils";

const MenubarMenu = MenubarPrimitive.Menu;

const MenubarGroup = MenubarPrimitive.Group;

const MenubarPortal = MenubarPrimitive.Portal;

const MenubarSub = MenubarPrimitive.Sub;

const MenubarRadioGroup = MenubarPrimitive.RadioGroup;

const Menubar = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>
>(({ className, ...props }, ref) => (
  <MenubarPrimitive.Root
    ref={ref}
    className={cn("flex h-10 items-center space-x-1 rounded-md border bg-background p-1", className)}
    {...props}
  />
));
Menubar.displayName = MenubarPrimitive.Root.displayName;

const MenubarTrigger = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.Trigger>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>
>(({ className, ...props }, ref) => (
  <MenubarPrimitive.Trigger
    ref={ref}
    className={cn(
      "flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none data-[state=open]:bg-accent data-[state=open]:text-accent-foreground focus:bg-accent focus:text-accent-foreground",
      className,
    )}
    {...props}
  />
));
MenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName;

const MenubarSubTrigger = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {
    inset?: boolean;
  }
>(({ className, inset, children, ...props }, ref) => (
  <MenubarPrimitive.SubTrigger
    ref={ref}
    className={cn(
      "flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[state=open]:bg-accent data-[state=open]:text-accent-foreground focus:bg-accent focus:text-accent-foreground",
      inset && "pl-8",
      className,
    )}
    {...props}
  >
    {children}
    <ChevronRight className="ml-auto h-4 w-4" />
  </MenubarPrimitive.SubTrigger>
));
MenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName;

const MenubarSubContent = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.SubContent>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>
>(({ className, ...props }, ref) => (
  <MenubarPrimitive.SubContent
    ref={ref}
    className={cn(
      "z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
      className,
    )}
    {...props}
  />
));
MenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName;

const MenubarContent = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>
>(({ className, align = "start", alignOffset = -4, sideOffset = 8, ...props }, ref) => (
  <MenubarPrimitive.Portal>
    <MenubarPrimitive.Content
      ref={ref}
      align={align}
      alignOffset={alignOffset}
      sideOffset={sideOffset}
      className={cn(
        "z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
        className,
      )}
      {...props}
    />
  </MenubarPrimitive.Portal>
));
MenubarContent.displayName = MenubarPrimitive.Content.displayName;

const MenubarItem = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {
    inset?: boolean;
  }
>(({ className, inset, ...props }, ref) => (
  <MenubarPrimitive.Item
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",
      inset && "pl-8",
      className,
    )}
    {...props}
  />
));
MenubarItem.displayName = MenubarPrimitive.Item.displayName;

const MenubarCheckboxItem = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>
>(({ className, children, checked, ...props }, ref) => (
  <MenubarPrimitive.CheckboxItem
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",
      className,
    )}
    checked={checked}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <MenubarPrimitive.ItemIndicator>
        <Check className="h-4 w-4" />
      </MenubarPrimitive.ItemIndicator>
    </span>
    {children}
  </MenubarPrimitive.CheckboxItem>
));
MenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName;

const MenubarRadioItem = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.RadioItem>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>
>(({ className, children, ...props }, ref) => (
  <MenubarPrimitive.RadioItem
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",
      className,
    )}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <MenubarPrimitive.ItemIndicator>
        <Circle className="h-2 w-2 fill-current" />
      </MenubarPrimitive.ItemIndicator>
    </span>
    {children}
  </MenubarPrimitive.RadioItem>
));
MenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName;

const MenubarLabel = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.Label>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {
    inset?: boolean;
  }
>(({ className, inset, ...props }, ref) => (
  <MenubarPrimitive.Label
    ref={ref}
    className={cn("px-2 py-1.5 text-sm font-semibold", inset && "pl-8", className)}
    {...props}
  />
));
MenubarLabel.displayName = MenubarPrimitive.Label.displayName;

const MenubarSeparator = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.Separator>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>
>(({ className, ...props }, ref) => (
  <MenubarPrimitive.Separator ref={ref} className={cn("-mx-1 my-1 h-px bg-muted", className)} {...props} />
));
MenubarSeparator.displayName = MenubarPrimitive.Separator.displayName;

const MenubarShortcut = ({ className, ...props }: React.HTMLAttributes<HTMLSpanElement>) => {
  return <span className={cn("ml-auto text-xs tracking-widest text-muted-foreground", className)} {...props} />;
};
MenubarShortcut.displayname = "MenubarShortcut";

export {
  Menubar,
  MenubarMenu,
  MenubarTrigger,
  MenubarContent,
  MenubarItem,
  MenubarSeparator,
  MenubarLabel,
  MenubarCheckboxItem,
  MenubarRadioGroup,
  MenubarRadioItem,
  MenubarPortal,
  MenubarSubContent,
  MenubarSubTrigger,
  MenubarGroup,
  MenubarSub,
  MenubarShortcut,
};


================================================
FILE: D:\barter_verse\frontend\src\components\ui\navigation-menu.tsx
================================================
import * as React from "react";
import * as NavigationMenuPrimitive from "@radix-ui/react-navigation-menu";
import { cva } from "class-variance-authority";
import { ChevronDown } from "lucide-react";

import { cn } from "@/lib/utils";

const NavigationMenu = React.forwardRef<
  React.ElementRef<typeof NavigationMenuPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>
>(({ className, children, ...props }, ref) => (
  <NavigationMenuPrimitive.Root
    ref={ref}
    className={cn("relative z-10 flex max-w-max flex-1 items-center justify-center", className)}
    {...props}
  >
    {children}
    <NavigationMenuViewport />
  </NavigationMenuPrimitive.Root>
));
NavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName;

const NavigationMenuList = React.forwardRef<
  React.ElementRef<typeof NavigationMenuPrimitive.List>,
  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>
>(({ className, ...props }, ref) => (
  <NavigationMenuPrimitive.List
    ref={ref}
    className={cn("group flex flex-1 list-none items-center justify-center space-x-1", className)}
    {...props}
  />
));
NavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName;

const NavigationMenuItem = NavigationMenuPrimitive.Item;

const navigationMenuTriggerStyle = cva(
  "group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[active]:bg-accent/50 data-[state=open]:bg-accent/50",
);

const NavigationMenuTrigger = React.forwardRef<
  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,
  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>
>(({ className, children, ...props }, ref) => (
  <NavigationMenuPrimitive.Trigger
    ref={ref}
    className={cn(navigationMenuTriggerStyle(), "group", className)}
    {...props}
  >
    {children}{" "}
    <ChevronDown
      className="relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180"
      aria-hidden="true"
    />
  </NavigationMenuPrimitive.Trigger>
));
NavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName;

const NavigationMenuContent = React.forwardRef<
  React.ElementRef<typeof NavigationMenuPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>
>(({ className, ...props }, ref) => (
  <NavigationMenuPrimitive.Content
    ref={ref}
    className={cn(
      "left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto",
      className,
    )}
    {...props}
  />
));
NavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName;

const NavigationMenuLink = NavigationMenuPrimitive.Link;

const NavigationMenuViewport = React.forwardRef<
  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,
  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>
>(({ className, ...props }, ref) => (
  <div className={cn("absolute left-0 top-full flex justify-center")}>
    <NavigationMenuPrimitive.Viewport
      className={cn(
        "origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]",
        className,
      )}
      ref={ref}
      {...props}
    />
  </div>
));
NavigationMenuViewport.displayName = NavigationMenuPrimitive.Viewport.displayName;

const NavigationMenuIndicator = React.forwardRef<
  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,
  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>
>(({ className, ...props }, ref) => (
  <NavigationMenuPrimitive.Indicator
    ref={ref}
    className={cn(
      "top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in",
      className,
    )}
    {...props}
  >
    <div className="relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md" />
  </NavigationMenuPrimitive.Indicator>
));
NavigationMenuIndicator.displayName = NavigationMenuPrimitive.Indicator.displayName;

export {
  navigationMenuTriggerStyle,
  NavigationMenu,
  NavigationMenuList,
  NavigationMenuItem,
  NavigationMenuContent,
  NavigationMenuTrigger,
  NavigationMenuLink,
  NavigationMenuIndicator,
  NavigationMenuViewport,
};


================================================
FILE: D:\barter_verse\frontend\src\components\ui\pagination.tsx
================================================
import * as React from "react";
import { ChevronLeft, ChevronRight, MoreHorizontal } from "lucide-react";

import { cn } from "@/lib/utils";
import { ButtonProps, buttonVariants } from "@/components/ui/button";

const Pagination = ({ className, ...props }: React.ComponentProps<"nav">) => (
  <nav
    role="navigation"
    aria-label="pagination"
    className={cn("mx-auto flex w-full justify-center", className)}
    {...props}
  />
);
Pagination.displayName = "Pagination";

const PaginationContent = React.forwardRef<HTMLUListElement, React.ComponentProps<"ul">>(
  ({ className, ...props }, ref) => (
    <ul ref={ref} className={cn("flex flex-row items-center gap-1", className)} {...props} />
  ),
);
PaginationContent.displayName = "PaginationContent";

const PaginationItem = React.forwardRef<HTMLLIElement, React.ComponentProps<"li">>(({ className, ...props }, ref) => (
  <li ref={ref} className={cn("", className)} {...props} />
));
PaginationItem.displayName = "PaginationItem";

type PaginationLinkProps = {
  isActive?: boolean;
} & Pick<ButtonProps, "size"> &
  React.ComponentProps<"a">;

const PaginationLink = ({ className, isActive, size = "icon", ...props }: PaginationLinkProps) => (
  <a
    aria-current={isActive ? "page" : undefined}
    className={cn(
      buttonVariants({
        variant: isActive ? "outline" : "ghost",
        size,
      }),
      className,
    )}
    {...props}
  />
);
PaginationLink.displayName = "PaginationLink";

const PaginationPrevious = ({ className, ...props }: React.ComponentProps<typeof PaginationLink>) => (
  <PaginationLink aria-label="Go to previous page" size="default" className={cn("gap-1 pl-2.5", className)} {...props}>
    <ChevronLeft className="h-4 w-4" />
    <span>Previous</span>
  </PaginationLink>
);
PaginationPrevious.displayName = "PaginationPrevious";

const PaginationNext = ({ className, ...props }: React.ComponentProps<typeof PaginationLink>) => (
  <PaginationLink aria-label="Go to next page" size="default" className={cn("gap-1 pr-2.5", className)} {...props}>
    <span>Next</span>
    <ChevronRight className="h-4 w-4" />
  </PaginationLink>
);
PaginationNext.displayName = "PaginationNext";

const PaginationEllipsis = ({ className, ...props }: React.ComponentProps<"span">) => (
  <span aria-hidden className={cn("flex h-9 w-9 items-center justify-center", className)} {...props}>
    <MoreHorizontal className="h-4 w-4" />
    <span className="sr-only">More pages</span>
  </span>
);
PaginationEllipsis.displayName = "PaginationEllipsis";

export {
  Pagination,
  PaginationContent,
  PaginationEllipsis,
  PaginationItem,
  PaginationLink,
  PaginationNext,
  PaginationPrevious,
};


================================================
FILE: D:\barter_verse\frontend\src\components\ui\popover.tsx
================================================
import * as React from "react";
import * as PopoverPrimitive from "@radix-ui/react-popover";

import { cn } from "@/lib/utils";

const Popover = PopoverPrimitive.Root;

const PopoverTrigger = PopoverPrimitive.Trigger;

const PopoverContent = React.forwardRef<
  React.ElementRef<typeof PopoverPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>
>(({ className, align = "center", sideOffset = 4, ...props }, ref) => (
  <PopoverPrimitive.Portal>
    <PopoverPrimitive.Content
      ref={ref}
      align={align}
      sideOffset={sideOffset}
      className={cn(
        "z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
        className,
      )}
      {...props}
    />
  </PopoverPrimitive.Portal>
));
PopoverContent.displayName = PopoverPrimitive.Content.displayName;

export { Popover, PopoverTrigger, PopoverContent };


================================================
FILE: D:\barter_verse\frontend\src\components\ui\progress.tsx
================================================
import * as React from "react";
import * as ProgressPrimitive from "@radix-ui/react-progress";

import { cn } from "@/lib/utils";

const Progress = React.forwardRef<
  React.ElementRef<typeof ProgressPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>
>(({ className, value, ...props }, ref) => (
  <ProgressPrimitive.Root
    ref={ref}
    className={cn("relative h-4 w-full overflow-hidden rounded-full bg-secondary", className)}
    {...props}
  >
    <ProgressPrimitive.Indicator
      className="h-full w-full flex-1 bg-primary transition-all"
      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}
    />
  </ProgressPrimitive.Root>
));
Progress.displayName = ProgressPrimitive.Root.displayName;

export { Progress };


================================================
FILE: D:\barter_verse\frontend\src\components\ui\radio-group.tsx
================================================
import * as React from "react";
import * as RadioGroupPrimitive from "@radix-ui/react-radio-group";
import { Circle } from "lucide-react";

import { cn } from "@/lib/utils";

const RadioGroup = React.forwardRef<
  React.ElementRef<typeof RadioGroupPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>
>(({ className, ...props }, ref) => {
  return <RadioGroupPrimitive.Root className={cn("grid gap-2", className)} {...props} ref={ref} />;
});
RadioGroup.displayName = RadioGroupPrimitive.Root.displayName;

const RadioGroupItem = React.forwardRef<
  React.ElementRef<typeof RadioGroupPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>
>(({ className, ...props }, ref) => {
  return (
    <RadioGroupPrimitive.Item
      ref={ref}
      className={cn(
        "aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",
        className,
      )}
      {...props}
    >
      <RadioGroupPrimitive.Indicator className="flex items-center justify-center">
        <Circle className="h-2.5 w-2.5 fill-current text-current" />
      </RadioGroupPrimitive.Indicator>
    </RadioGroupPrimitive.Item>
  );
});
RadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName;

export { RadioGroup, RadioGroupItem };


================================================
FILE: D:\barter_verse\frontend\src\components\ui\resizable.tsx
================================================
import { GripVertical } from "lucide-react";
import * as ResizablePrimitive from "react-resizable-panels";

import { cn } from "@/lib/utils";

const ResizablePanelGroup = ({ className, ...props }: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) => (
  <ResizablePrimitive.PanelGroup
    className={cn("flex h-full w-full data-[panel-group-direction=vertical]:flex-col", className)}
    {...props}
  />
);

const ResizablePanel = ResizablePrimitive.Panel;

const ResizableHandle = ({
  withHandle,
  className,
  ...props
}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {
  withHandle?: boolean;
}) => (
  <ResizablePrimitive.PanelResizeHandle
    className={cn(
      "relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 [&[data-panel-group-direction=vertical]>div]:rotate-90",
      className,
    )}
    {...props}
  >
    {withHandle && (
      <div className="z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border">
        <GripVertical className="h-2.5 w-2.5" />
      </div>
    )}
  </ResizablePrimitive.PanelResizeHandle>
);

export { ResizablePanelGroup, ResizablePanel, ResizableHandle };


================================================
FILE: D:\barter_verse\frontend\src\components\ui\scroll-area.tsx
================================================
import * as React from "react";
import * as ScrollAreaPrimitive from "@radix-ui/react-scroll-area";

import { cn } from "@/lib/utils";

const ScrollArea = React.forwardRef<
  React.ElementRef<typeof ScrollAreaPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>
>(({ className, children, ...props }, ref) => (
  <ScrollAreaPrimitive.Root ref={ref} className={cn("relative overflow-hidden", className)} {...props}>
    <ScrollAreaPrimitive.Viewport className="h-full w-full rounded-[inherit]">{children}</ScrollAreaPrimitive.Viewport>
    <ScrollBar />
    <ScrollAreaPrimitive.Corner />
  </ScrollAreaPrimitive.Root>
));
ScrollArea.displayName = ScrollAreaPrimitive.Root.displayName;

const ScrollBar = React.forwardRef<
  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,
  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>
>(({ className, orientation = "vertical", ...props }, ref) => (
  <ScrollAreaPrimitive.ScrollAreaScrollbar
    ref={ref}
    orientation={orientation}
    className={cn(
      "flex touch-none select-none transition-colors",
      orientation === "vertical" && "h-full w-2.5 border-l border-l-transparent p-[1px]",
      orientation === "horizontal" && "h-2.5 flex-col border-t border-t-transparent p-[1px]",
      className,
    )}
    {...props}
  >
    <ScrollAreaPrimitive.ScrollAreaThumb className="relative flex-1 rounded-full bg-border" />
  </ScrollAreaPrimitive.ScrollAreaScrollbar>
));
ScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName;

export { ScrollArea, ScrollBar };


================================================
FILE: D:\barter_verse\frontend\src\components\ui\select.tsx
================================================
import * as React from "react";
import * as SelectPrimitive from "@radix-ui/react-select";
import { Check, ChevronDown, ChevronUp } from "lucide-react";

import { cn } from "@/lib/utils";

const Select = SelectPrimitive.Root;

const SelectGroup = SelectPrimitive.Group;

const SelectValue = SelectPrimitive.Value;

const SelectTrigger = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Trigger>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>
>(({ className, children, ...props }, ref) => (
  <SelectPrimitive.Trigger
    ref={ref}
    className={cn(
      "flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",
      className,
    )}
    {...props}
  >
    {children}
    <SelectPrimitive.Icon asChild>
      <ChevronDown className="h-4 w-4 opacity-50" />
    </SelectPrimitive.Icon>
  </SelectPrimitive.Trigger>
));
SelectTrigger.displayName = SelectPrimitive.Trigger.displayName;

const SelectScrollUpButton = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>
>(({ className, ...props }, ref) => (
  <SelectPrimitive.ScrollUpButton
    ref={ref}
    className={cn("flex cursor-default items-center justify-center py-1", className)}
    {...props}
  >
    <ChevronUp className="h-4 w-4" />
  </SelectPrimitive.ScrollUpButton>
));
SelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName;

const SelectScrollDownButton = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>
>(({ className, ...props }, ref) => (
  <SelectPrimitive.ScrollDownButton
    ref={ref}
    className={cn("flex cursor-default items-center justify-center py-1", className)}
    {...props}
  >
    <ChevronDown className="h-4 w-4" />
  </SelectPrimitive.ScrollDownButton>
));
SelectScrollDownButton.displayName = SelectPrimitive.ScrollDownButton.displayName;

const SelectContent = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>
>(({ className, children, position = "popper", ...props }, ref) => (
  <SelectPrimitive.Portal>
    <SelectPrimitive.Content
      ref={ref}
      className={cn(
        "relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
        position === "popper" &&
          "data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",
        className,
      )}
      position={position}
      {...props}
    >
      <SelectScrollUpButton />
      <SelectPrimitive.Viewport
        className={cn(
          "p-1",
          position === "popper" &&
            "h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]",
        )}
      >
        {children}
      </SelectPrimitive.Viewport>
      <SelectScrollDownButton />
    </SelectPrimitive.Content>
  </SelectPrimitive.Portal>
));
SelectContent.displayName = SelectPrimitive.Content.displayName;

const SelectLabel = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Label>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>
>(({ className, ...props }, ref) => (
  <SelectPrimitive.Label ref={ref} className={cn("py-1.5 pl-8 pr-2 text-sm font-semibold", className)} {...props} />
));
SelectLabel.displayName = SelectPrimitive.Label.displayName;

const SelectItem = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>
>(({ className, children, ...props }, ref) => (
  <SelectPrimitive.Item
    ref={ref}
    className={cn(
      "relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",
      className,
    )}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <SelectPrimitive.ItemIndicator>
        <Check className="h-4 w-4" />
      </SelectPrimitive.ItemIndicator>
    </span>

    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>
  </SelectPrimitive.Item>
));
SelectItem.displayName = SelectPrimitive.Item.displayName;

const SelectSeparator = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Separator>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>
>(({ className, ...props }, ref) => (
  <SelectPrimitive.Separator ref={ref} className={cn("-mx-1 my-1 h-px bg-muted", className)} {...props} />
));
SelectSeparator.displayName = SelectPrimitive.Separator.displayName;

export {
  Select,
  SelectGroup,
  SelectValue,
  SelectTrigger,
  SelectContent,
  SelectLabel,
  SelectItem,
  SelectSeparator,
  SelectScrollUpButton,
  SelectScrollDownButton,
};


================================================
FILE: D:\barter_verse\frontend\src\components\ui\separator.tsx
================================================
import * as React from "react";
import * as SeparatorPrimitive from "@radix-ui/react-separator";

import { cn } from "@/lib/utils";

const Separator = React.forwardRef<
  React.ElementRef<typeof SeparatorPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>
>(({ className, orientation = "horizontal", decorative = true, ...props }, ref) => (
  <SeparatorPrimitive.Root
    ref={ref}
    decorative={decorative}
    orientation={orientation}
    className={cn("shrink-0 bg-border", orientation === "horizontal" ? "h-[1px] w-full" : "h-full w-[1px]", className)}
    {...props}
  />
));
Separator.displayName = SeparatorPrimitive.Root.displayName;

export { Separator };


================================================
FILE: D:\barter_verse\frontend\src\components\ui\sheet.tsx
================================================
import * as SheetPrimitive from "@radix-ui/react-dialog";
import { cva, type VariantProps } from "class-variance-authority";
import { X } from "lucide-react";
import * as React from "react";

import { cn } from "@/lib/utils";

const Sheet = SheetPrimitive.Root;

const SheetTrigger = SheetPrimitive.Trigger;

const SheetClose = SheetPrimitive.Close;

const SheetPortal = SheetPrimitive.Portal;

const SheetOverlay = React.forwardRef<
  React.ElementRef<typeof SheetPrimitive.Overlay>,
  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>
>(({ className, ...props }, ref) => (
  <SheetPrimitive.Overlay
    className={cn(
      "fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",
      className,
    )}
    {...props}
    ref={ref}
  />
));
SheetOverlay.displayName = SheetPrimitive.Overlay.displayName;

const sheetVariants = cva(
  "fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",
  {
    variants: {
      side: {
        top: "inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",
        bottom:
          "inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",
        left: "inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",
        right:
          "inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm",
      },
    },
    defaultVariants: {
      side: "right",
    },
  },
);

interface SheetContentProps
  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,
    VariantProps<typeof sheetVariants> {}

const SheetContent = React.forwardRef<React.ElementRef<typeof SheetPrimitive.Content>, SheetContentProps>(
  ({ side = "right", className, children, ...props }, ref) => (
    <SheetPortal>
      <SheetOverlay />
      <SheetPrimitive.Content ref={ref} className={cn(sheetVariants({ side }), className)} {...props}>
        {children}
        <SheetPrimitive.Close className="absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity data-[state=open]:bg-secondary hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none">
          <X className="h-4 w-4" />
          <span className="sr-only">Close</span>
        </SheetPrimitive.Close>
      </SheetPrimitive.Content>
    </SheetPortal>
  ),
);
SheetContent.displayName = SheetPrimitive.Content.displayName;

const SheetHeader = ({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) => (
  <div className={cn("flex flex-col space-y-2 text-center sm:text-left", className)} {...props} />
);
SheetHeader.displayName = "SheetHeader";

const SheetFooter = ({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) => (
  <div className={cn("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2", className)} {...props} />
);
SheetFooter.displayName = "SheetFooter";

const SheetTitle = React.forwardRef<
  React.ElementRef<typeof SheetPrimitive.Title>,
  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>
>(({ className, ...props }, ref) => (
  <SheetPrimitive.Title ref={ref} className={cn("text-lg font-semibold text-foreground", className)} {...props} />
));
SheetTitle.displayName = SheetPrimitive.Title.displayName;

const SheetDescription = React.forwardRef<
  React.ElementRef<typeof SheetPrimitive.Description>,
  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>
>(({ className, ...props }, ref) => (
  <SheetPrimitive.Description ref={ref} className={cn("text-sm text-muted-foreground", className)} {...props} />
));
SheetDescription.displayName = SheetPrimitive.Description.displayName;

export {
  Sheet,
  SheetClose,
  SheetContent,
  SheetDescription,
  SheetFooter,
  SheetHeader,
  SheetOverlay,
  SheetPortal,
  SheetTitle,
  SheetTrigger,
};


================================================
FILE: D:\barter_verse\frontend\src\components\ui\sidebar.tsx
================================================
import * as React from "react";
import { Slot } from "@radix-ui/react-slot";
import { VariantProps, cva } from "class-variance-authority";
import { PanelLeft } from "lucide-react";

import { useIsMobile } from "@/hooks/use-mobile";
import { cn } from "@/lib/utils";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Separator } from "@/components/ui/separator";
import { Sheet, SheetContent } from "@/components/ui/sheet";
import { Skeleton } from "@/components/ui/skeleton";
import { Tooltip, TooltipContent, TooltipProvider, TooltipTrigger } from "@/components/ui/tooltip";

const SIDEBAR_COOKIE_NAME = "sidebar:state";
const SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7;
const SIDEBAR_WIDTH = "16rem";
const SIDEBAR_WIDTH_MOBILE = "18rem";
const SIDEBAR_WIDTH_ICON = "3rem";
const SIDEBAR_KEYBOARD_SHORTCUT = "b";

type SidebarContext = {
  state: "expanded" | "collapsed";
  open: boolean;
  setOpen: (open: boolean) => void;
  openMobile: boolean;
  setOpenMobile: (open: boolean) => void;
  isMobile: boolean;
  toggleSidebar: () => void;
};

const SidebarContext = React.createContext<SidebarContext | null>(null);

function useSidebar() {
  const context = React.useContext(SidebarContext);
  if (!context) {
    throw new Error("useSidebar must be used within a SidebarProvider.");
  }

  return context;
}

const SidebarProvider = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<"div"> & {
    defaultOpen?: boolean;
    open?: boolean;
    onOpenChange?: (open: boolean) => void;
  }
>(({ defaultOpen = true, open: openProp, onOpenChange: setOpenProp, className, style, children, ...props }, ref) => {
  const isMobile = useIsMobile();
  const [openMobile, setOpenMobile] = React.useState(false);

  // This is the internal state of the sidebar.
  // We use openProp and setOpenProp for control from outside the component.
  const [_open, _setOpen] = React.useState(defaultOpen);
  const open = openProp ?? _open;
  const setOpen = React.useCallback(
    (value: boolean | ((value: boolean) => boolean)) => {
      const openState = typeof value === "function" ? value(open) : value;
      if (setOpenProp) {
        setOpenProp(openState);
      } else {
        _setOpen(openState);
      }

      // This sets the cookie to keep the sidebar state.
      document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`;
    },
    [setOpenProp, open],
  );

  // Helper to toggle the sidebar.
  const toggleSidebar = React.useCallback(() => {
    return isMobile ? setOpenMobile((open) => !open) : setOpen((open) => !open);
  }, [isMobile, setOpen, setOpenMobile]);

  // Adds a keyboard shortcut to toggle the sidebar.
  React.useEffect(() => {
    const handleKeyDown = (event: KeyboardEvent) => {
      if (event.key === SIDEBAR_KEYBOARD_SHORTCUT && (event.metaKey || event.ctrlKey)) {
        event.preventDefault();
        toggleSidebar();
      }
    };

    window.addEventListener("keydown", handleKeyDown);
    return () => window.removeEventListener("keydown", handleKeyDown);
  }, [toggleSidebar]);

  // We add a state so that we can do data-state="expanded" or "collapsed".
  // This makes it easier to style the sidebar with Tailwind classes.
  const state = open ? "expanded" : "collapsed";

  const contextValue = React.useMemo<SidebarContext>(
    () => ({
      state,
      open,
      setOpen,
      isMobile,
      openMobile,
      setOpenMobile,
      toggleSidebar,
    }),
    [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar],
  );

  return (
    <SidebarContext.Provider value={contextValue}>
      <TooltipProvider delayDuration={0}>
        <div
          style={
            {
              "--sidebar-width": SIDEBAR_WIDTH,
              "--sidebar-width-icon": SIDEBAR_WIDTH_ICON,
              ...style,
            } as React.CSSProperties
          }
          className={cn("group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar", className)}
          ref={ref}
          {...props}
        >
          {children}
        </div>
      </TooltipProvider>
    </SidebarContext.Provider>
  );
});
SidebarProvider.displayName = "SidebarProvider";

const Sidebar = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<"div"> & {
    side?: "left" | "right";
    variant?: "sidebar" | "floating" | "inset";
    collapsible?: "offcanvas" | "icon" | "none";
  }
>(({ side = "left", variant = "sidebar", collapsible = "offcanvas", className, children, ...props }, ref) => {
  const { isMobile, state, openMobile, setOpenMobile } = useSidebar();

  if (collapsible === "none") {
    return (
      <div
        className={cn("flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground", className)}
        ref={ref}
        {...props}
      >
        {children}
      </div>
    );
  }

  if (isMobile) {
    return (
      <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>
        <SheetContent
          data-sidebar="sidebar"
          data-mobile="true"
          className="w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden"
          style={
            {
              "--sidebar-width": SIDEBAR_WIDTH_MOBILE,
            } as React.CSSProperties
          }
          side={side}
        >
          <div className="flex h-full w-full flex-col">{children}</div>
        </SheetContent>
      </Sheet>
    );
  }

  return (
    <div
      ref={ref}
      className="group peer hidden text-sidebar-foreground md:block"
      data-state={state}
      data-collapsible={state === "collapsed" ? collapsible : ""}
      data-variant={variant}
      data-side={side}
    >
      {/* This is what handles the sidebar gap on desktop */}
      <div
        className={cn(
          "relative h-svh w-[--sidebar-width] bg-transparent transition-[width] duration-200 ease-linear",
          "group-data-[collapsible=offcanvas]:w-0",
          "group-data-[side=right]:rotate-180",
          variant === "floating" || variant === "inset"
            ? "group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]"
            : "group-data-[collapsible=icon]:w-[--sidebar-width-icon]",
        )}
      />
      <div
        className={cn(
          "fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] duration-200 ease-linear md:flex",
          side === "left"
            ? "left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]"
            : "right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]",
          // Adjust the padding for floating and inset variants.
          variant === "floating" || variant === "inset"
            ? "p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]"
            : "group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l",
          className,
        )}
        {...props}
      >
        <div
          data-sidebar="sidebar"
          className="flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow"
        >
          {children}
        </div>
      </div>
    </div>
  );
});
Sidebar.displayName = "Sidebar";

const SidebarTrigger = React.forwardRef<React.ElementRef<typeof Button>, React.ComponentProps<typeof Button>>(
  ({ className, onClick, ...props }, ref) => {
    const { toggleSidebar } = useSidebar();

    return (
      <Button
        ref={ref}
        data-sidebar="trigger"
        variant="ghost"
        size="icon"
        className={cn("h-7 w-7", className)}
        onClick={(event) => {
          onClick?.(event);
          toggleSidebar();
        }}
        {...props}
      >
        <PanelLeft />
        <span className="sr-only">Toggle Sidebar</span>
      </Button>
    );
  },
);
SidebarTrigger.displayName = "SidebarTrigger";

const SidebarRail = React.forwardRef<HTMLButtonElement, React.ComponentProps<"button">>(
  ({ className, ...props }, ref) => {
    const { toggleSidebar } = useSidebar();

    return (
      <button
        ref={ref}
        data-sidebar="rail"
        aria-label="Toggle Sidebar"
        tabIndex={-1}
        onClick={toggleSidebar}
        title="Toggle Sidebar"
        className={cn(
          "absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] group-data-[side=left]:-right-4 group-data-[side=right]:left-0 hover:after:bg-sidebar-border sm:flex",
          "[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize",
          "[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize",
          "group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar",
          "[[data-side=left][data-collapsible=offcanvas]_&]:-right-2",
          "[[data-side=right][data-collapsible=offcanvas]_&]:-left-2",
          className,
        )}
        {...props}
      />
    );
  },
);
SidebarRail.displayName = "SidebarRail";

const SidebarInset = React.forwardRef<HTMLDivElement, React.ComponentProps<"main">>(({ className, ...props }, ref) => {
  return (
    <main
      ref={ref}
      className={cn(
        "relative flex min-h-svh flex-1 flex-col bg-background",
        "peer-data-[variant=inset]:min-h-[calc(100svh-theme(spacing.4))] md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow",
        className,
      )}
      {...props}
    />
  );
});
SidebarInset.displayName = "SidebarInset";

const SidebarInput = React.forwardRef<React.ElementRef<typeof Input>, React.ComponentProps<typeof Input>>(
  ({ className, ...props }, ref) => {
    return (
      <Input
        ref={ref}
        data-sidebar="input"
        className={cn(
          "h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring",
          className,
        )}
        {...props}
      />
    );
  },
);
SidebarInput.displayName = "SidebarInput";

const SidebarHeader = React.forwardRef<HTMLDivElement, React.ComponentProps<"div">>(({ className, ...props }, ref) => {
  return <div ref={ref} data-sidebar="header" className={cn("flex flex-col gap-2 p-2", className)} {...props} />;
});
SidebarHeader.displayName = "SidebarHeader";

const SidebarFooter = React.forwardRef<HTMLDivElement, React.ComponentProps<"div">>(({ className, ...props }, ref) => {
  return <div ref={ref} data-sidebar="footer" className={cn("flex flex-col gap-2 p-2", className)} {...props} />;
});
SidebarFooter.displayName = "SidebarFooter";

const SidebarSeparator = React.forwardRef<React.ElementRef<typeof Separator>, React.ComponentProps<typeof Separator>>(
  ({ className, ...props }, ref) => {
    return (
      <Separator
        ref={ref}
        data-sidebar="separator"
        className={cn("mx-2 w-auto bg-sidebar-border", className)}
        {...props}
      />
    );
  },
);
SidebarSeparator.displayName = "SidebarSeparator";

const SidebarContent = React.forwardRef<HTMLDivElement, React.ComponentProps<"div">>(({ className, ...props }, ref) => {
  return (
    <div
      ref={ref}
      data-sidebar="content"
      className={cn(
        "flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden",
        className,
      )}
      {...props}
    />
  );
});
SidebarContent.displayName = "SidebarContent";

const SidebarGroup = React.forwardRef<HTMLDivElement, React.ComponentProps<"div">>(({ className, ...props }, ref) => {
  return (
    <div
      ref={ref}
      data-sidebar="group"
      className={cn("relative flex w-full min-w-0 flex-col p-2", className)}
      {...props}
    />
  );
});
SidebarGroup.displayName = "SidebarGroup";

const SidebarGroupLabel = React.forwardRef<HTMLDivElement, React.ComponentProps<"div"> & { asChild?: boolean }>(
  ({ className, asChild = false, ...props }, ref) => {
    const Comp = asChild ? Slot : "div";

    return (
      <Comp
        ref={ref}
        data-sidebar="group-label"
        className={cn(
          "flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opa] duration-200 ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0",
          "group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0",
          className,
        )}
        {...props}
      />
    );
  },
);
SidebarGroupLabel.displayName = "SidebarGroupLabel";

const SidebarGroupAction = React.forwardRef<HTMLButtonElement, React.ComponentProps<"button"> & { asChild?: boolean }>(
  ({ className, asChild = false, ...props }, ref) => {
    const Comp = asChild ? Slot : "button";

    return (
      <Comp
        ref={ref}
        data-sidebar="group-action"
        className={cn(
          "absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0",
          // Increases the hit area of the button on mobile.
          "after:absolute after:-inset-2 after:md:hidden",
          "group-data-[collapsible=icon]:hidden",
          className,
        )}
        {...props}
      />
    );
  },
);
SidebarGroupAction.displayName = "SidebarGroupAction";

const SidebarGroupContent = React.forwardRef<HTMLDivElement, React.ComponentProps<"div">>(
  ({ className, ...props }, ref) => (
    <div ref={ref} data-sidebar="group-content" className={cn("w-full text-sm", className)} {...props} />
  ),
);
SidebarGroupContent.displayName = "SidebarGroupContent";

const SidebarMenu = React.forwardRef<HTMLUListElement, React.ComponentProps<"ul">>(({ className, ...props }, ref) => (
  <ul ref={ref} data-sidebar="menu" className={cn("flex w-full min-w-0 flex-col gap-1", className)} {...props} />
));
SidebarMenu.displayName = "SidebarMenu";

const SidebarMenuItem = React.forwardRef<HTMLLIElement, React.ComponentProps<"li">>(({ className, ...props }, ref) => (
  <li ref={ref} data-sidebar="menu-item" className={cn("group/menu-item relative", className)} {...props} />
));
SidebarMenuItem.displayName = "SidebarMenuItem";

const sidebarMenuButtonVariants = cva(
  "peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",
  {
    variants: {
      variant: {
        default: "hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",
        outline:
          "bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]",
      },
      size: {
        default: "h-8 text-sm",
        sm: "h-7 text-xs",
        lg: "h-12 text-sm group-data-[collapsible=icon]:!p-0",
      },
    },
    defaultVariants: {
      variant: "default",
      size: "default",
    },
  },
);

const SidebarMenuButton = React.forwardRef<
  HTMLButtonElement,
  React.ComponentProps<"button"> & {
    asChild?: boolean;
    isActive?: boolean;
    tooltip?: string | React.ComponentProps<typeof TooltipContent>;
  } & VariantProps<typeof sidebarMenuButtonVariants>
>(({ asChild = false, isActive = false, variant = "default", size = "default", tooltip, className, ...props }, ref) => {
  const Comp = asChild ? Slot : "button";
  const { isMobile, state } = useSidebar();

  const button = (
    <Comp
      ref={ref}
      data-sidebar="menu-button"
      data-size={size}
      data-active={isActive}
      className={cn(sidebarMenuButtonVariants({ variant, size }), className)}
      {...props}
    />
  );

  if (!tooltip) {
    return button;
  }

  if (typeof tooltip === "string") {
    tooltip = {
      children: tooltip,
    };
  }

  return (
    <Tooltip>
      <TooltipTrigger asChild>{button}</TooltipTrigger>
      <TooltipContent side="right" align="center" hidden={state !== "collapsed" || isMobile} {...tooltip} />
    </Tooltip>
  );
});
SidebarMenuButton.displayName = "SidebarMenuButton";

const SidebarMenuAction = React.forwardRef<
  HTMLButtonElement,
  React.ComponentProps<"button"> & {
    asChild?: boolean;
    showOnHover?: boolean;
  }
>(({ className, asChild = false, showOnHover = false, ...props }, ref) => {
  const Comp = asChild ? Slot : "button";

  return (
    <Comp
      ref={ref}
      data-sidebar="menu-action"
      className={cn(
        "absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform peer-hover/menu-button:text-sidebar-accent-foreground hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0",
        // Increases the hit area of the button on mobile.
        "after:absolute after:-inset-2 after:md:hidden",
        "peer-data-[size=sm]/menu-button:top-1",
        "peer-data-[size=default]/menu-button:top-1.5",
        "peer-data-[size=lg]/menu-button:top-2.5",
        "group-data-[collapsible=icon]:hidden",
        showOnHover &&
          "group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0",
        className,
      )}
      {...props}
    />
  );
});
SidebarMenuAction.displayName = "SidebarMenuAction";

const SidebarMenuBadge = React.forwardRef<HTMLDivElement, React.ComponentProps<"div">>(
  ({ className, ...props }, ref) => (
    <div
      ref={ref}
      data-sidebar="menu-badge"
      className={cn(
        "pointer-events-none absolute right-1 flex h-5 min-w-5 select-none items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground",
        "peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground",
        "peer-data-[size=sm]/menu-button:top-1",
        "peer-data-[size=default]/menu-button:top-1.5",
        "peer-data-[size=lg]/menu-button:top-2.5",
        "group-data-[collapsible=icon]:hidden",
        className,
      )}
      {...props}
    />
  ),
);
SidebarMenuBadge.displayName = "SidebarMenuBadge";

const SidebarMenuSkeleton = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<"div"> & {
    showIcon?: boolean;
  }
>(({ className, showIcon = false, ...props }, ref) => {
  // Random width between 50 to 90%.
  const width = React.useMemo(() => {
    return `${Math.floor(Math.random() * 40) + 50}%`;
  }, []);

  return (
    <div
      ref={ref}
      data-sidebar="menu-skeleton"
      className={cn("flex h-8 items-center gap-2 rounded-md px-2", className)}
      {...props}
    >
      {showIcon && <Skeleton className="size-4 rounded-md" data-sidebar="menu-skeleton-icon" />}
      <Skeleton
        className="h-4 max-w-[--skeleton-width] flex-1"
        data-sidebar="menu-skeleton-text"
        style={
          {
            "--skeleton-width": width,
          } as React.CSSProperties
        }
      />
    </div>
  );
});
SidebarMenuSkeleton.displayName = "SidebarMenuSkeleton";

const SidebarMenuSub = React.forwardRef<HTMLUListElement, React.ComponentProps<"ul">>(
  ({ className, ...props }, ref) => (
    <ul
      ref={ref}
      data-sidebar="menu-sub"
      className={cn(
        "mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5",
        "group-data-[collapsible=icon]:hidden",
        className,
      )}
      {...props}
    />
  ),
);
SidebarMenuSub.displayName = "SidebarMenuSub";

const SidebarMenuSubItem = React.forwardRef<HTMLLIElement, React.ComponentProps<"li">>(({ ...props }, ref) => (
  <li ref={ref} {...props} />
));
SidebarMenuSubItem.displayName = "SidebarMenuSubItem";

const SidebarMenuSubButton = React.forwardRef<
  HTMLAnchorElement,
  React.ComponentProps<"a"> & {
    asChild?: boolean;
    size?: "sm" | "md";
    isActive?: boolean;
  }
>(({ asChild = false, size = "md", isActive, className, ...props }, ref) => {
  const Comp = asChild ? Slot : "a";

  return (
    <Comp
      ref={ref}
      data-sidebar="menu-sub-button"
      data-size={size}
      data-active={isActive}
      className={cn(
        "flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring aria-disabled:pointer-events-none aria-disabled:opacity-50 hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground",
        "data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground",
        size === "sm" && "text-xs",
        size === "md" && "text-sm",
        "group-data-[collapsible=icon]:hidden",
        className,
      )}
      {...props}
    />
  );
});
SidebarMenuSubButton.displayName = "SidebarMenuSubButton";

export {
  Sidebar,
  SidebarContent,
  SidebarFooter,
  SidebarGroup,
  SidebarGroupAction,
  SidebarGroupContent,
  SidebarGroupLabel,
  SidebarHeader,
  SidebarInput,
  SidebarInset,
  SidebarMenu,
  SidebarMenuAction,
  SidebarMenuBadge,
  SidebarMenuButton,
  SidebarMenuItem,
  SidebarMenuSkeleton,
  SidebarMenuSub,
  SidebarMenuSubButton,
  SidebarMenuSubItem,
  SidebarProvider,
  SidebarRail,
  SidebarSeparator,
  SidebarTrigger,
  useSidebar,
};


================================================
FILE: D:\barter_verse\frontend\src\components\ui\skeleton.tsx
================================================
import { cn } from "@/lib/utils";

function Skeleton({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) {
  return <div className={cn("animate-pulse rounded-md bg-muted", className)} {...props} />;
}

export { Skeleton };


================================================
FILE: D:\barter_verse\frontend\src\components\ui\slider.tsx
================================================
import * as React from "react";
import * as SliderPrimitive from "@radix-ui/react-slider";

import { cn } from "@/lib/utils";

const Slider = React.forwardRef<
  React.ElementRef<typeof SliderPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>
>(({ className, ...props }, ref) => (
  <SliderPrimitive.Root
    ref={ref}
    className={cn("relative flex w-full touch-none select-none items-center", className)}
    {...props}
  >
    <SliderPrimitive.Track className="relative h-2 w-full grow overflow-hidden rounded-full bg-secondary">
      <SliderPrimitive.Range className="absolute h-full bg-primary" />
    </SliderPrimitive.Track>
    <SliderPrimitive.Thumb className="block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50" />
  </SliderPrimitive.Root>
));
Slider.displayName = SliderPrimitive.Root.displayName;

export { Slider };


================================================
FILE: D:\barter_verse\frontend\src\components\ui\sonner.tsx
================================================
import { useTheme } from "next-themes";
import { Toaster as Sonner, toast } from "sonner";

type ToasterProps = React.ComponentProps<typeof Sonner>;

const Toaster = ({ ...props }: ToasterProps) => {
  const { theme = "system" } = useTheme();

  return (
    <Sonner
      theme={theme as ToasterProps["theme"]}
      className="toaster group"
      toastOptions={{
        classNames: {
          toast:
            "group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",
          description: "group-[.toast]:text-muted-foreground",
          actionButton: "group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",
          cancelButton: "group-[.toast]:bg-muted group-[.toast]:text-muted-foreground",
        },
      }}
      {...props}
    />
  );
};

export { Toaster, toast };


================================================
FILE: D:\barter_verse\frontend\src\components\ui\switch.tsx
================================================
import * as React from "react";
import * as SwitchPrimitives from "@radix-ui/react-switch";

import { cn } from "@/lib/utils";

const Switch = React.forwardRef<
  React.ElementRef<typeof SwitchPrimitives.Root>,
  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>
>(({ className, ...props }, ref) => (
  <SwitchPrimitives.Root
    className={cn(
      "peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50",
      className,
    )}
    {...props}
    ref={ref}
  >
    <SwitchPrimitives.Thumb
      className={cn(
        "pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0",
      )}
    />
  </SwitchPrimitives.Root>
));
Switch.displayName = SwitchPrimitives.Root.displayName;

export { Switch };


================================================
FILE: D:\barter_verse\frontend\src\components\ui\table.tsx
================================================
import * as React from "react";

import { cn } from "@/lib/utils";

const Table = React.forwardRef<HTMLTableElement, React.HTMLAttributes<HTMLTableElement>>(
  ({ className, ...props }, ref) => (
    <div className="relative w-full overflow-auto">
      <table ref={ref} className={cn("w-full caption-bottom text-sm", className)} {...props} />
    </div>
  ),
);
Table.displayName = "Table";

const TableHeader = React.forwardRef<HTMLTableSectionElement, React.HTMLAttributes<HTMLTableSectionElement>>(
  ({ className, ...props }, ref) => <thead ref={ref} className={cn("[&_tr]:border-b", className)} {...props} />,
);
TableHeader.displayName = "TableHeader";

const TableBody = React.forwardRef<HTMLTableSectionElement, React.HTMLAttributes<HTMLTableSectionElement>>(
  ({ className, ...props }, ref) => (
    <tbody ref={ref} className={cn("[&_tr:last-child]:border-0", className)} {...props} />
  ),
);
TableBody.displayName = "TableBody";

const TableFooter = React.forwardRef<HTMLTableSectionElement, React.HTMLAttributes<HTMLTableSectionElement>>(
  ({ className, ...props }, ref) => (
    <tfoot ref={ref} className={cn("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0", className)} {...props} />
  ),
);
TableFooter.displayName = "TableFooter";

const TableRow = React.forwardRef<HTMLTableRowElement, React.HTMLAttributes<HTMLTableRowElement>>(
  ({ className, ...props }, ref) => (
    <tr
      ref={ref}
      className={cn("border-b transition-colors data-[state=selected]:bg-muted hover:bg-muted/50", className)}
      {...props}
    />
  ),
);
TableRow.displayName = "TableRow";

const TableHead = React.forwardRef<HTMLTableCellElement, React.ThHTMLAttributes<HTMLTableCellElement>>(
  ({ className, ...props }, ref) => (
    <th
      ref={ref}
      className={cn(
        "h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",
        className,
      )}
      {...props}
    />
  ),
);
TableHead.displayName = "TableHead";

const TableCell = React.forwardRef<HTMLTableCellElement, React.TdHTMLAttributes<HTMLTableCellElement>>(
  ({ className, ...props }, ref) => (
    <td ref={ref} className={cn("p-4 align-middle [&:has([role=checkbox])]:pr-0", className)} {...props} />
  ),
);
TableCell.displayName = "TableCell";

const TableCaption = React.forwardRef<HTMLTableCaptionElement, React.HTMLAttributes<HTMLTableCaptionElement>>(
  ({ className, ...props }, ref) => (
    <caption ref={ref} className={cn("mt-4 text-sm text-muted-foreground", className)} {...props} />
  ),
);
TableCaption.displayName = "TableCaption";

export { Table, TableHeader, TableBody, TableFooter, TableHead, TableRow, TableCell, TableCaption };


================================================
FILE: D:\barter_verse\frontend\src\components\ui\tabs.tsx
================================================
import * as React from "react";
import * as TabsPrimitive from "@radix-ui/react-tabs";

import { cn } from "@/lib/utils";

const Tabs = TabsPrimitive.Root;

const TabsList = React.forwardRef<
  React.ElementRef<typeof TabsPrimitive.List>,
  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>
>(({ className, ...props }, ref) => (
  <TabsPrimitive.List
    ref={ref}
    className={cn(
      "inline-flex h-10 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground border border-border",
      className,
    )}
    {...props}
  />
));
TabsList.displayName = TabsPrimitive.List.displayName;

const TabsTrigger = React.forwardRef<
  React.ElementRef<typeof TabsPrimitive.Trigger>,
  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>
>(({ className, ...props }, ref) => (
  <TabsPrimitive.Trigger
    ref={ref}
    className={cn(
      "inline-flex items-center justify-center whitespace-nowrap rounded-md px-4 py-2 text-sm font-medium ring-offset-background transition-all data-[state=active]:bg-card data-[state=active]:text-primary data-[state=active]:shadow-sm data-[state=active]:border-b-2 data-[state=active]:border-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 hover:text-foreground",
      className,
    )}
    {...props}
  />
));
TabsTrigger.displayName = TabsPrimitive.Trigger.displayName;

const TabsContent = React.forwardRef<
  React.ElementRef<typeof TabsPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>
>(({ className, ...props }, ref) => (
  <TabsPrimitive.Content
    ref={ref}
    className={cn(
      "mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",
      className,
    )}
    {...props}
  />
));
TabsContent.displayName = TabsPrimitive.Content.displayName;

export { Tabs, TabsList, TabsTrigger, TabsContent };


================================================
FILE: D:\barter_verse\frontend\src\components\ui\textarea.tsx
================================================
import * as React from "react";

import { cn } from "@/lib/utils";

export interface TextareaProps extends React.TextareaHTMLAttributes<HTMLTextAreaElement> {}

const Textarea = React.forwardRef<HTMLTextAreaElement, TextareaProps>(({ className, ...props }, ref) => {
  return (
    <textarea
      className={cn(
        "flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",
        className,
      )}
      ref={ref}
      {...props}
    />
  );
});
Textarea.displayName = "Textarea";

export { Textarea };


================================================
FILE: D:\barter_verse\frontend\src\components\ui\toast.tsx
================================================
import * as React from "react";
import * as ToastPrimitives from "@radix-ui/react-toast";
import { cva, type VariantProps } from "class-variance-authority";
import { X } from "lucide-react";

import { cn } from "@/lib/utils";

const ToastProvider = ToastPrimitives.Provider;

const ToastViewport = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Viewport>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>
>(({ className, ...props }, ref) => (
  <ToastPrimitives.Viewport
    ref={ref}
    className={cn(
      "fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",
      className,
    )}
    {...props}
  />
));
ToastViewport.displayName = ToastPrimitives.Viewport.displayName;

const toastVariants = cva(
  "group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",
  {
    variants: {
      variant: {
        default: "border bg-background text-foreground",
        destructive: "destructive group border-destructive bg-destructive text-destructive-foreground",
      },
    },
    defaultVariants: {
      variant: "default",
    },
  },
);

const Toast = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Root>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> & VariantProps<typeof toastVariants>
>(({ className, variant, ...props }, ref) => {
  return <ToastPrimitives.Root ref={ref} className={cn(toastVariants({ variant }), className)} {...props} />;
});
Toast.displayName = ToastPrimitives.Root.displayName;

const ToastAction = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Action>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>
>(({ className, ...props }, ref) => (
  <ToastPrimitives.Action
    ref={ref}
    className={cn(
      "inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors group-[.destructive]:border-muted/40 hover:bg-secondary group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 group-[.destructive]:focus:ring-destructive disabled:pointer-events-none disabled:opacity-50",
      className,
    )}
    {...props}
  />
));
ToastAction.displayName = ToastPrimitives.Action.displayName;

const ToastClose = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Close>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>
>(({ className, ...props }, ref) => (
  <ToastPrimitives.Close
    ref={ref}
    className={cn(
      "absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity group-hover:opacity-100 group-[.destructive]:text-destructive group-[.destructive]:opacity-100 hover:text-foreground group-[.destructive]:hover:text-destructive focus:opacity-100 focus:outline-none focus:ring-2 group-[.destructive]:focus:ring-destructive group-[.destructive]:focus:ring-offset-2",
      className,
    )}
    toast-close=""
    {...props}
  >
    <X className="h-4 w-4" />
  </ToastPrimitives.Close>
));
ToastClose.displayName = ToastPrimitives.Close.displayName;

const ToastTitle = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Title>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>
>(({ className, ...props }, ref) => (
  <ToastPrimitives.Title ref={ref} className={cn("text-sm font-semibold", className)} {...props} />
));
ToastTitle.displayName = ToastPrimitives.Title.displayName;

const ToastDescription = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Description>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>
>(({ className, ...props }, ref) => (
  <ToastPrimitives.Description ref={ref} className={cn("text-sm opacity-90", className)} {...props} />
));
ToastDescription.displayName = ToastPrimitives.Description.displayName;

type ToastProps = React.ComponentPropsWithoutRef<typeof Toast>;

type ToastActionElement = React.ReactElement<typeof ToastAction>;

export {
  type ToastProps,
  type ToastActionElement,
  ToastProvider,
  ToastViewport,
  Toast,
  ToastTitle,
  ToastDescription,
  ToastClose,
  ToastAction,
};


================================================
FILE: D:\barter_verse\frontend\src\components\ui\toaster.tsx
================================================
import { useToast } from "@/hooks/use-toast";
import { Toast, ToastClose, ToastDescription, ToastProvider, ToastTitle, ToastViewport } from "@/components/ui/toast";

export function Toaster() {
  const { toasts } = useToast();

  return (
    <ToastProvider>
      {toasts.map(function ({ id, title, description, action, ...props }) {
        return (
          <Toast key={id} {...props}>
            <div className="grid gap-1">
              {title && <ToastTitle>{title}</ToastTitle>}
              {description && <ToastDescription>{description}</ToastDescription>}
            </div>
            {action}
            <ToastClose />
          </Toast>
        );
      })}
      <ToastViewport />
    </ToastProvider>
  );
}


================================================
FILE: D:\barter_verse\frontend\src\components\ui\toggle-group.tsx
================================================
import * as React from "react";
import * as ToggleGroupPrimitive from "@radix-ui/react-toggle-group";
import { type VariantProps } from "class-variance-authority";

import { cn } from "@/lib/utils";
import { toggleVariants } from "@/components/ui/toggle";

const ToggleGroupContext = React.createContext<VariantProps<typeof toggleVariants>>({
  size: "default",
  variant: "default",
});

const ToggleGroup = React.forwardRef<
  React.ElementRef<typeof ToggleGroupPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> & VariantProps<typeof toggleVariants>
>(({ className, variant, size, children, ...props }, ref) => (
  <ToggleGroupPrimitive.Root ref={ref} className={cn("flex items-center justify-center gap-1", className)} {...props}>
    <ToggleGroupContext.Provider value={{ variant, size }}>{children}</ToggleGroupContext.Provider>
  </ToggleGroupPrimitive.Root>
));

ToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName;

const ToggleGroupItem = React.forwardRef<
  React.ElementRef<typeof ToggleGroupPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> & VariantProps<typeof toggleVariants>
>(({ className, children, variant, size, ...props }, ref) => {
  const context = React.useContext(ToggleGroupContext);

  return (
    <ToggleGroupPrimitive.Item
      ref={ref}
      className={cn(
        toggleVariants({
          variant: context.variant || variant,
          size: context.size || size,
        }),
        className,
      )}
      {...props}
    >
      {children}
    </ToggleGroupPrimitive.Item>
  );
});

ToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName;

export { ToggleGroup, ToggleGroupItem };


================================================
FILE: D:\barter_verse\frontend\src\components\ui\toggle.tsx
================================================
import * as React from "react";
import * as TogglePrimitive from "@radix-ui/react-toggle";
import { cva, type VariantProps } from "class-variance-authority";

import { cn } from "@/lib/utils";

const toggleVariants = cva(
  "inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground",
  {
    variants: {
      variant: {
        default: "bg-transparent",
        outline: "border border-input bg-transparent hover:bg-accent hover:text-accent-foreground",
      },
      size: {
        default: "h-10 px-3",
        sm: "h-9 px-2.5",
        lg: "h-11 px-5",
      },
    },
    defaultVariants: {
      variant: "default",
      size: "default",
    },
  },
);

const Toggle = React.forwardRef<
  React.ElementRef<typeof TogglePrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> & VariantProps<typeof toggleVariants>
>(({ className, variant, size, ...props }, ref) => (
  <TogglePrimitive.Root ref={ref} className={cn(toggleVariants({ variant, size, className }))} {...props} />
));

Toggle.displayName = TogglePrimitive.Root.displayName;

export { Toggle, toggleVariants };


================================================
FILE: D:\barter_verse\frontend\src\components\ui\tooltip.tsx
================================================
import * as React from "react";
import * as TooltipPrimitive from "@radix-ui/react-tooltip";

import { cn } from "@/lib/utils";

const TooltipProvider = TooltipPrimitive.Provider;

const Tooltip = TooltipPrimitive.Root;

const TooltipTrigger = TooltipPrimitive.Trigger;

const TooltipContent = React.forwardRef<
  React.ElementRef<typeof TooltipPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>
>(({ className, sideOffset = 4, ...props }, ref) => (
  <TooltipPrimitive.Content
    ref={ref}
    sideOffset={sideOffset}
    className={cn(
      "z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
      className,
    )}
    {...props}
  />
));
TooltipContent.displayName = TooltipPrimitive.Content.displayName;

export { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider };


================================================
FILE: D:\barter_verse\frontend\src\components\ui\use-toast.ts
================================================
import { useToast, toast } from "@/hooks/use-toast";

export { useToast, toast };


================================================
FILE: D:\barter_verse\frontend\src\contexts\AuthContext.tsx
================================================
import { createContext, useContext, useEffect, useState, useRef } from 'react';
import { useNavigate } from 'react-router-dom';
import { api } from '@/lib/api';

interface User {
  id: string;
  email: string;
  display_name?: string;
  bio?: string;
  rating?: number;
  coins?: number;
  created_at?: string;
}

interface AuthContextType {
  user: User | null;
  token: string | null;
  signUp: (email: string, password: string) => Promise<{ error: any }>;
  signIn: (email: string, password: string) => Promise<{ error: any }>;
  signOut: () => Promise<void>;
  loading: boolean;
  isAuthenticated: boolean;
}

const AuthContext = createContext<AuthContextType | undefined>(undefined);

export function AuthProvider({ children }: { children: React.ReactNode }) {
  const [user, setUser] = useState<User | null>(null);
  const [token, setToken] = useState<string | null>(null);
  const [loading, setLoading] = useState(true);
  const navigate = useNavigate();
  const initializeRef = useRef(false);

  // Initialize auth from localStorage - do this synchronously
  if (!initializeRef.current) {
    const storedToken = localStorage.getItem('auth_token');
    const storedUser = localStorage.getItem('user');
    
    console.log(' AuthContext init - storedToken:', storedToken ? `${storedToken.substring(0, 20)}...` : 'null');
    console.log(' AuthContext init - storedUser:', storedUser ? 'exists' : 'null');
    
    if (storedToken && storedUser) {
      try {
        // Set token on api client IMMEDIATELY
        api.setToken(storedToken);
        setToken(storedToken);
        setUser(JSON.parse(storedUser));
        console.log(' Auth restored from localStorage');
      } catch (error) {
        console.error(' Failed to restore auth from localStorage:', error);
        localStorage.removeItem('auth_token');
        localStorage.removeItem('user');
        api.setToken(null);
      }
    } else {
      // No stored auth, clear api token
      api.setToken(null);
      console.log(' No stored auth in localStorage');
    }
    
    initializeRef.current = true;
    setLoading(false);
  }

  const signUp = async (email: string, password: string) => {
    try {
      const response = await api.signup(email, password);
      const { token: newToken, user: newUser } = response.data.data;
      
      setToken(newToken);
      setUser(newUser);
      api.setToken(newToken);
      
      // Store in localStorage
      localStorage.setItem('auth_token', newToken);
      localStorage.setItem('user', JSON.stringify(newUser));
      
      navigate('/dashboard');
      return { error: null };
    } catch (error: any) {
      const errorMessage = error.response?.data?.message || 'Sign up failed';
      return { error: { message: errorMessage } };
    }
  };

  const signIn = async (email: string, password: string) => {
    try {
      const response = await api.signin(email, password);
      const { token: newToken, user: newUser } = response.data.data;
      
      setToken(newToken);
      setUser(newUser);
      api.setToken(newToken);
      
      // Store in localStorage
      localStorage.setItem('auth_token', newToken);
      localStorage.setItem('user', JSON.stringify(newUser));
      
      navigate('/dashboard');
      return { error: null };
    } catch (error: any) {
      const errorMessage = error.response?.data?.message || 'Sign in failed';
      return { error: { message: errorMessage } };
    }
  };

  const signOut = async () => {
    try {
      await api.logout();
      setToken(null);
      setUser(null);
      api.setToken(null);
      
      // Clear localStorage
      localStorage.removeItem('auth_token');
      localStorage.removeItem('user');
      
      navigate('/auth');
    } catch (error) {
      console.error('Sign out error:', error);
    }
  };

  return (
    <AuthContext.Provider
      value={{
        user,
        token,
        signUp,
        signIn,
        signOut,
        loading,
        isAuthenticated: !!token && !!user,
      }}
    >
      {children}
    </AuthContext.Provider>
  );
}

export function useAuth() {
  const context = useContext(AuthContext);
  if (context === undefined) {
    throw new Error('useAuth must be used within an AuthProvider');
  }
  return context;
}

================================================
FILE: D:\barter_verse\frontend\src\contexts\CoinContext.tsx
================================================
import { createContext, useContext, useState, useEffect, ReactNode } from 'react';
import { api } from '@/lib/api';
import { useAuth } from './AuthContext';
import { useToast } from '@/hooks/use-toast';

interface CoinContextType {
  balance: number;
  isLoading: boolean;
  transactions: CoinTransaction[];
  fetchBalance: () => Promise<void>;
  fetchTransactions: () => Promise<void>;
  addCoins: (amount: number, reason?: string) => Promise<boolean>;
  spendCoins: (amount: number, reason?: string) => Promise<boolean>;
  transferCoins: (toUserId: string, amount: number) => Promise<boolean>;
}

interface CoinTransaction {
  id: string;
  amount: number;
  type: string;
  description?: string;
  createdAt: string;
}

const CoinContext = createContext<CoinContextType | undefined>(undefined);

export function CoinProvider({ children }: { children: ReactNode }) {
  const [balance, setBalance] = useState(0);
  const [isLoading, setIsLoading] = useState(false);
  const [transactions, setTransactions] = useState<CoinTransaction[]>([]);
  const { user, loading: authLoading } = useAuth();
  const { toast } = useToast();

  const fetchBalance = async () => {
    if (!user) {
      setBalance(0);
      setIsLoading(false);
      return;
    }

    try {
      const response = await Promise.race([
        api.getBalance(),
        new Promise((_, reject) => setTimeout(() => reject(new Error('Timeout')), 5000))
      ]);
      // backend returns { coins: number }
      setBalance(response.data?.coins ?? 0);
    } catch (error) {
      console.error('Error fetching balance:', error);
      setBalance(0);
    } finally {
      setIsLoading(false);
    }
  };

  const fetchTransactions = async () => {
    if (!user) return;

    try {
      const response = await api.getTransactionHistory(50);
      setTransactions(response.data?.data || response.data || []);
    } catch (error) {
      console.error('Error fetching transactions:', error);
      setTransactions([]);
    }
  };

  const addCoins = async (amount: number, reason?: string): Promise<boolean> => {
    if (!user) return false;

    try {
      const response = await api.addCoins(amount, reason);
      setBalance(response.data?.data?.new_balance || response.data?.new_balance || 0);
      await fetchTransactions();
      toast({
        title: 'Success',
        description: `Added ${amount} coins`,
      });
      return true;
    } catch (error: any) {
      console.error('Error adding coins:', error);
      toast({
        title: 'Error',
        description: error.response?.data?.message || 'Failed to add coins',
        variant: 'destructive',
      });
      return false;
    }
  };

  const spendCoins = async (amount: number, reason?: string): Promise<boolean> => {
    if (!user) return false;

    try {
      const response = await api.spendCoins(amount, reason);
      setBalance(response.data?.data?.new_balance || response.data?.new_balance || 0);
      await fetchTransactions();
      toast({
        title: 'Success',
        description: `Spent ${amount} coins`,
      });
      return true;
    } catch (error: any) {
      console.error('Error spending coins:', error);
      toast({
        title: 'Insufficient Coins',
        description: error.response?.data?.message || 'Failed to spend coins',
        variant: 'destructive',
      });
      return false;
    }
  };

  const transferCoins = async (toUserId: string, amount: number): Promise<boolean> => {
    if (!user) return false;

    try {
      const response = await api.transferCoins(toUserId, amount);
      setBalance(response.data?.data?.senderBalance || response.data?.senderBalance || 0);
      await fetchTransactions();
      toast({
        title: 'Success',
        description: `Transferred ${amount} coins`,
      });
      return true;
    } catch (error: any) {
      console.error('Error transferring coins:', error);
      toast({
        title: 'Error',
        description: error.response?.data?.message || 'Failed to transfer coins',
        variant: 'destructive',
      });
      return false;
    }
  };

  // Fetch balance when user logs in (but not until auth is done loading)
  useEffect(() => {
    if (authLoading) return;
    if (user) {
      fetchBalance();
      fetchTransactions();
    }
  }, [user, authLoading]);

  // Poll for updates every 30 seconds
  useEffect(() => {
    if (!user) return;

    const interval = setInterval(() => {
      fetchBalance();
      fetchTransactions();
    }, 30000);

    return () => clearInterval(interval);
  }, [user]);

  return (
    <CoinContext.Provider
      value={{
        balance,
        isLoading,
        transactions,
        fetchBalance,
        fetchTransactions,
        addCoins,
        spendCoins,
        transferCoins,
      }}
    >
      {children}
    </CoinContext.Provider>
  );
}

export function useCoins() {
  const context = useContext(CoinContext);
  if (!context) throw new Error('useCoins must be used within CoinProvider');
  return context;
}


================================================
FILE: D:\barter_verse\frontend\src\contexts\ListingsContext.tsx
================================================
import { createContext, useContext, useState, useEffect, ReactNode } from 'react';
import { api } from '@/lib/api';
import { useAuth } from './AuthContext';

export interface Listing {
  id: string;
  title: string;
  category?: string;
  description?: string;
  status: 'ACTIVE' | 'TRADED' | 'ARCHIVED';
  ownerId: string;
  owner?: {
    id: string;
    email: string;
    display_name?: string;
    rating?: number;
  };
  createdAt?: string;
  updatedAt?: string;
}

interface ListingsContextType {
  listings: Listing[];
  wishlist: string[];
  isLoading: boolean;
  fetchListings: (page?: number, category?: string, search?: string) => Promise<void>;
  createListing: (data: any) => Promise<Listing | null>;
  updateListing: (id: string, data: any) => Promise<Listing | null>;
  deleteListing: (id: string) => Promise<boolean>;
  archiveListing: (id: string) => Promise<boolean>;
  toggleWishlist: (id: string) => void;
  isInWishlist: (id: string) => boolean;
}

const ListingsContext = createContext<ListingsContextType | undefined>(undefined);

export function ListingsProvider({ children }: { children: ReactNode }) {
  const [listings, setListings] = useState<Listing[]>([]);
  const [wishlist, setWishlist] = useState<string[]>([]);
  const [isLoading, setIsLoading] = useState(false);
  const { user } = useAuth();

  const fetchListings = async (page = 1, category?: string, search?: string) => {
    try {
      setIsLoading(true);
      const response = await api.getListings(page, 10, category, search);
      // Handle both response structures: { success, data: { listings, pagination } } and { data: listings[] }
      const responseData = response.data;
      let listingsArray = [];
      
      if (responseData.data?.listings) {
        // Response structure: { data: { listings: [], pagination: {} } }
        listingsArray = responseData.data.listings;
      } else if (responseData.listings) {
        // Response structure: { listings: [], pagination: {} }
        listingsArray = responseData.listings;
      } else if (Array.isArray(responseData.data)) {
        // Response structure: { data: [] }
        listingsArray = responseData.data;
      } else if (Array.isArray(responseData)) {
        // Response structure: []
        listingsArray = responseData;
      }
      
      setListings(Array.isArray(listingsArray) ? listingsArray : []);
    } catch (error) {
      console.error('Error fetching listings:', error);
      setListings([]);
    } finally {
      setIsLoading(false);
    }
  };

  const createListing = async (data: any): Promise<Listing | null> => {
    try {
      const response = await api.createListing(data);
      const newListing = response.data.data;
      await fetchListings();
      return newListing;
    } catch (error) {
      console.error('Error creating listing:', error);
      return null;
    }
  };

  const updateListing = async (id: string, data: any): Promise<Listing | null> => {
    try {
      const response = await api.updateListing(id, data);
      const updatedListing = response.data.data;
      await fetchListings();
      return updatedListing;
    } catch (error) {
      console.error('Error updating listing:', error);
      return null;
    }
  };

  const deleteListing = async (id: string): Promise<boolean> => {
    try {
      await api.deleteListing(id);
      await fetchListings();
      return true;
    } catch (error) {
      console.error('Error deleting listing:', error);
      return false;
    }
  };

  const archiveListing = async (id: string): Promise<boolean> => {
    try {
      await api.archiveListing(id);
      await fetchListings();
      return true;
    } catch (error) {
      console.error('Error archiving listing:', error);
      return false;
    }
  };

  const toggleWishlist = (id: string) => {
    setWishlist(prev =>
      prev.includes(id) ? prev.filter(i => i !== id) : [...prev, id]
    );
  };

  const isInWishlist = (id: string) => wishlist.includes(id);

  useEffect(() => {
    try {
      fetchListings();
    } catch (error) {
      console.error('Error in useEffect:', error);
      setListings([]);
      setIsLoading(false);
    }
  }, []);

  // Poll for updates every 30 seconds instead of real-time subscription
  useEffect(() => {
    const interval = setInterval(() => {
      try {
        fetchListings();
      } catch (error) {
        console.error('Error in polling interval:', error);
      }
    }, 30000);

    return () => clearInterval(interval);
  }, []);

  return (
    <ListingsContext.Provider
      value={{
        listings,
        wishlist,
        isLoading,
        fetchListings,
        createListing,
        updateListing,
        deleteListing,
        archiveListing,
        toggleWishlist,
        isInWishlist,
      }}
    >
      {children}
    </ListingsContext.Provider>
  );
}

export function useListings() {
  const context = useContext(ListingsContext);
  if (!context) throw new Error('useListings must be used within ListingsProvider');
  return context;
}


================================================
FILE: D:\barter_verse\frontend\src\contexts\ThemeContext.tsx
================================================
import { createContext, useContext, useEffect, useState, ReactNode } from 'react';

type Theme = 'dark' | 'light';

interface ThemeContextType {
  theme: Theme;
  toggleTheme: () => void;
}

const ThemeContext = createContext<ThemeContextType | undefined>(undefined);

export function ThemeProvider({ children }: { children: ReactNode }) {
  const [theme, setTheme] = useState<Theme>('dark');

  useEffect(() => {
    const saved = localStorage.getItem('theme') as Theme;
    if (saved) {
      setTheme(saved);
    }
  }, []);

  useEffect(() => {
    localStorage.setItem('theme', theme);
    document.documentElement.classList.toggle('dark', theme === 'dark');
  }, [theme]);

  const toggleTheme = () => {
    setTheme(prev => prev === 'dark' ? 'light' : 'dark');
  };

  return (
    <ThemeContext.Provider value={{ theme, toggleTheme }}>
      {children}
    </ThemeContext.Provider>
  );
}

export function useTheme() {
  const context = useContext(ThemeContext);
  if (!context) throw new Error('useTheme must be used within ThemeProvider');
  return context;
}


================================================
FILE: D:\barter_verse\frontend\src\contexts\TradeContext.tsx
================================================
import { createContext, useContext, useState, useEffect, ReactNode } from 'react';
import { api } from '@/lib/api';
import { useAuth } from './AuthContext';
import { useCoins } from './CoinContext';
import { useToast } from '@/hooks/use-toast';

export interface Trade {
  id: string;
  initiatorId: string;
  responderUserId?: string;
  listingId: string;
  proposedListingId?: string;
  proposedCoins?: number;
  // Enhanced Status State Machine
  status: 'PENDING' | 'ESCROW_LOCKED' | 'DELIVERED' | 'COMPLETED' | 'REJECTED' | 'DISPUTED';
  direction: 'incoming' | 'outgoing';
  createdAt: string;
  initiator?: {
    id: string;
    email: string;
    display_name?: string;
    avatar_url?: string;
    reputation_score?: number; // Added for Trust Logic
  };
  responder?: {
    id: string;
    email: string;
    display_name?: string;
    avatar_url?: string;
  };
  listing?: {
    id: string;
    title: string;
    price_bc: number;
    images?: string[];
  };
}

interface TradeContextType {
  trades: Trade[];
  isLoading: boolean;
  activeEscrowAmount: number; // New: Track locked coins
  createTrade: (data: any) => Promise<boolean>;
  acceptTrade: (id: string) => Promise<boolean>;
  rejectTrade: (id: string) => Promise<boolean>;
  confirmDelivery: (id: string) => Promise<boolean>; // New: Step 2 of Escrow
  completeTrade: (id: string) => Promise<boolean>;   // New: Final Release
  cancelTrade: (id: string) => Promise<boolean>;
  fetchTrades: () => Promise<void>;
}

const TradeContext = createContext<TradeContextType | undefined>(undefined);

export function TradeProvider({ children }: { children: ReactNode }) {
  const [trades, setTrades] = useState<Trade[]>([]);
  const [isLoading, setIsLoading] = useState(false);
  const { user, loading: authLoading } = useAuth();
  const { toast } = useToast();
  const coinContext = useCoins();

  // Calculated value: Total coins currently locked in escrow
  const activeEscrowAmount = trades
    .filter(t => t.status === 'ESCROW_LOCKED' && t.direction === 'outgoing')
    .reduce((acc, t) => acc + (t.proposedCoins || 0), 0);

  const fetchTrades = async () => {
    if (!user) {
      setTrades([]);
      setIsLoading(false);
      return;
    }

    try {
      setIsLoading(true);
      const response = await api.getTrades();
      const data = response.data?.data || response.data || [];

      // Process trades to add direction
      const processedTrades = (Array.isArray(data) ? data : []).map((trade: any) => ({
        ...trade,
        direction: trade.responder_id === user.id || trade.responderUserId === user.id ? 'incoming' : 'outgoing',
      }));

      // Sort by status priority (Action Required -> Active -> Completed)
      const sortedTrades = processedTrades.sort((a: Trade, b: Trade) => {
        const priority = { 'PENDING': 1, 'ESCROW_LOCKED': 2, 'DELIVERED': 3, 'COMPLETED': 4, 'REJECTED': 5, 'DISPUTED': 0 };
        return (priority[a.status] || 99) - (priority[b.status] || 99);
      });

      setTrades(sortedTrades);
    } catch (error) {
      console.error('Error fetching trades:', error);
      // Silent fail on fetch to avoid spamming toasts
    } finally {
      setIsLoading(false);
    }
  };

  // 1. INITIATE: Propose a trade (Coins are checked but not locked yet)
  const createTrade = async (data: any): Promise<boolean> => {
    if (!user) return false;

    // Safety Check: Do they have enough coins?
    if (data.proposedCoins && coinContext.balance < data.proposedCoins) {
        toast({ title: 'Insufficient Funds', description: 'You need more Barter Coins to make this offer.', variant: 'destructive' });
        return false;
    }

    try {
      await api.createTrade({ ...data, initiatorId: user.id });
      await fetchTrades();
      toast({
        title: 'Offer Sent',
        description: 'Waiting for the seller to accept. Your coins will be locked when they accept.',
      });
      return true;
    } catch (error: any) {
      toast({
        title: 'Error',
        description: error.response?.data?.message || 'Failed to send offer',
        variant: 'destructive',
      });
      return false;
    }
  };

  // 2. ACCEPT: This triggers the ESCROW LOCK
  const acceptTrade = async (id: string): Promise<boolean> => {
    try {
      // API call should handle the coin locking on the backend
      await api.confirmTrade(id, 'accept'); 
      await fetchTrades();
      
      // Update local balance UI
      try { await coinContext.fetchBalance(); } catch {}
      
      toast({
        title: 'Trade Accepted',
        description: 'Escrow initiated. Coins are now LOCKED until completion.',
        className: 'bg-emerald-500 text-white border-none',
      });
      return true;
    } catch (error: any) {
      toast({ title: 'Error', description: 'Could not accept trade.', variant: 'destructive' });
      return false;
    }
  };

  const rejectTrade = async (id: string): Promise<boolean> => {
    try {
      await api.confirmTrade(id, 'reject');
      await fetchTrades();
      toast({ title: 'Trade Rejected', description: 'The offer has been declined.' });
      return true;
    } catch (error) {
      return false;
    }
  };

  // 3. CONFIRM DELIVERY: Seller says "I have sent the item"
  const confirmDelivery = async (id: string): Promise<boolean> => {
    try {
        // In a real backend, this updates status to 'DELIVERED'
        // For now, we might simulate this or use a specific API endpoint
        // await api.updateTradeStatus(id, 'DELIVERED'); 
        
        toast({
            title: 'Delivery Confirmed',
            description: 'Buyer has been notified to verify receipt.',
        });
        await fetchTrades();
        return true;
    } catch (error) {
        return false;
    }
  };

  // 4. COMPLETE: Buyer confirms receipt -> Coins Released to Seller
  const completeTrade = async (id: string): Promise<boolean> => {
    try {
      await api.completeTrade(id);
      await fetchTrades();
      
      // Coins move from Escrow -> Seller Wallet
      try { await coinContext.fetchBalance(); await coinContext.fetchTransactions(); } catch {}
      
      toast({
        title: 'Trade Completed! ',
        description: 'Funds released. Please rate your partner.',
        className: 'bg-blue-600 text-white border-none',
      });
      return true;
    } catch (error: any) {
      toast({ title: 'Error', description: 'Failed to complete trade.', variant: 'destructive' });
      return false;
    }
  };

  const cancelTrade = async (id: string): Promise<boolean> => {
    try {
      await api.cancelTrade(id);
      await fetchTrades();
      toast({ title: 'Trade Cancelled', description: 'Any locked funds have been returned.' });
      return true;
    } catch (error) {
      return false;
    }
  };

  useEffect(() => {
    if (authLoading) return;
    if (user) fetchTrades();
  }, [user, authLoading]);

  // Poll for status updates (Crucial for Escrow states)
  useEffect(() => {
    if (!user) return;
    const interval = setInterval(fetchTrades, 15000); // 15s poll
    return () => clearInterval(interval);
  }, [user]);

  return (
    <TradeContext.Provider
      value={{
        trades,
        isLoading,
        activeEscrowAmount,
        createTrade,
        acceptTrade,
        rejectTrade,
        confirmDelivery,
        completeTrade,
        cancelTrade,
        fetchTrades,
      }}
    >
      {children}
    </TradeContext.Provider>
  );
}

export function useTrade() {
  const context = useContext(TradeContext);
  if (!context) throw new Error('useTrade must be used within TradeProvider');
  return context;
}

================================================
FILE: D:\barter_verse\frontend\src\hooks\use-mobile.tsx
================================================
import * as React from "react";

const MOBILE_BREAKPOINT = 768;

export function useIsMobile() {
  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined);

  React.useEffect(() => {
    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`);
    const onChange = () => {
      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT);
    };
    mql.addEventListener("change", onChange);
    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT);
    return () => mql.removeEventListener("change", onChange);
  }, []);

  return !!isMobile;
}


================================================
FILE: D:\barter_verse\frontend\src\hooks\use-toast.ts
================================================
import * as React from "react";

import type { ToastActionElement, ToastProps } from "@/components/ui/toast";

const TOAST_LIMIT = 1;
const TOAST_REMOVE_DELAY = 1000000;

type ToasterToast = ToastProps & {
  id: string;
  title?: React.ReactNode;
  description?: React.ReactNode;
  action?: ToastActionElement;
};

const actionTypes = {
  ADD_TOAST: "ADD_TOAST",
  UPDATE_TOAST: "UPDATE_TOAST",
  DISMISS_TOAST: "DISMISS_TOAST",
  REMOVE_TOAST: "REMOVE_TOAST",
} as const;

let count = 0;

function genId() {
  count = (count + 1) % Number.MAX_SAFE_INTEGER;
  return count.toString();
}

type ActionType = typeof actionTypes;

type Action =
  | {
      type: ActionType["ADD_TOAST"];
      toast: ToasterToast;
    }
  | {
      type: ActionType["UPDATE_TOAST"];
      toast: Partial<ToasterToast>;
    }
  | {
      type: ActionType["DISMISS_TOAST"];
      toastId?: ToasterToast["id"];
    }
  | {
      type: ActionType["REMOVE_TOAST"];
      toastId?: ToasterToast["id"];
    };

interface State {
  toasts: ToasterToast[];
}

const toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>();

const addToRemoveQueue = (toastId: string) => {
  if (toastTimeouts.has(toastId)) {
    return;
  }

  const timeout = setTimeout(() => {
    toastTimeouts.delete(toastId);
    dispatch({
      type: "REMOVE_TOAST",
      toastId: toastId,
    });
  }, TOAST_REMOVE_DELAY);

  toastTimeouts.set(toastId, timeout);
};

export const reducer = (state: State, action: Action): State => {
  switch (action.type) {
    case "ADD_TOAST":
      return {
        ...state,
        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),
      };

    case "UPDATE_TOAST":
      return {
        ...state,
        toasts: state.toasts.map((t) => (t.id === action.toast.id ? { ...t, ...action.toast } : t)),
      };

    case "DISMISS_TOAST": {
      const { toastId } = action;

      // ! Side effects ! - This could be extracted into a dismissToast() action,
      // but I'll keep it here for simplicity
      if (toastId) {
        addToRemoveQueue(toastId);
      } else {
        state.toasts.forEach((toast) => {
          addToRemoveQueue(toast.id);
        });
      }

      return {
        ...state,
        toasts: state.toasts.map((t) =>
          t.id === toastId || toastId === undefined
            ? {
                ...t,
                open: false,
              }
            : t,
        ),
      };
    }
    case "REMOVE_TOAST":
      if (action.toastId === undefined) {
        return {
          ...state,
          toasts: [],
        };
      }
      return {
        ...state,
        toasts: state.toasts.filter((t) => t.id !== action.toastId),
      };
  }
};

const listeners: Array<(state: State) => void> = [];

let memoryState: State = { toasts: [] };

function dispatch(action: Action) {
  memoryState = reducer(memoryState, action);
  listeners.forEach((listener) => {
    listener(memoryState);
  });
}

type Toast = Omit<ToasterToast, "id">;

function toast({ ...props }: Toast) {
  const id = genId();

  const update = (props: ToasterToast) =>
    dispatch({
      type: "UPDATE_TOAST",
      toast: { ...props, id },
    });
  const dismiss = () => dispatch({ type: "DISMISS_TOAST", toastId: id });

  dispatch({
    type: "ADD_TOAST",
    toast: {
      ...props,
      id,
      open: true,
      onOpenChange: (open) => {
        if (!open) dismiss();
      },
    },
  });

  return {
    id: id,
    dismiss,
    update,
  };
}

function useToast() {
  const [state, setState] = React.useState<State>(memoryState);

  React.useEffect(() => {
    listeners.push(setState);
    return () => {
      const index = listeners.indexOf(setState);
      if (index > -1) {
        listeners.splice(index, 1);
      }
    };
  }, [state]);

  return {
    ...state,
    toast,
    dismiss: (toastId?: string) => dispatch({ type: "DISMISS_TOAST", toastId }),
  };
}

export { useToast, toast };


================================================
FILE: D:\barter_verse\frontend\src\index.css
================================================
@tailwind base;
@tailwind components;
@tailwind utilities;
 
@layer base {
  :root {
    --background: 222.2 84% 4.9%;
    --foreground: 210 40% 98%;
 
    --card: 222.2 84% 4.9%;
    --card-foreground: 210 40% 98%;
 
    --popover: 222.2 84% 4.9%;
    --popover-foreground: 210 40% 98%;
 
    --primary: 142.1 76.2% 36.3%;
    --primary-foreground: 355.7 100% 97.3%;
 
    --secondary: 217.2 32.6% 17.5%;
    --secondary-foreground: 210 40% 98%;
 
    --muted: 217.2 32.6% 17.5%;
    --muted-foreground: 215 20.2% 65.1%;
 
    --accent: 217.2 32.6% 17.5%;
    --accent-foreground: 210 40% 98%;
 
    --destructive: 0 62.8% 30.6%;
    --destructive-foreground: 210 40% 98%;
 
    --border: 217.2 32.6% 17.5%;
    --input: 217.2 32.6% 17.5%;
    --ring: 142.4 71.8% 29.2%;
 
    --radius: 0.5rem;
  }
}
 
@layer base {
  * {
    @apply border-border;
  }
  body {
    @apply bg-background text-foreground;
  }
}

/* Custom Animations */
@keyframes blob {
  0% { transform: translate(0px, 0px) scale(1); }
  33% { transform: translate(30px, -50px) scale(1.1); }
  66% { transform: translate(-20px, 20px) scale(0.9); }
  100% { transform: translate(0px, 0px) scale(1); }
}
.animate-blob {
  animation: blob 7s infinite;
}
.animation-delay-2000 {
  animation-delay: 2s;
}
.animation-delay-4000 {
  animation-delay: 4s;
}

================================================
FILE: D:\barter_verse\frontend\src\lib\admin-api.ts
================================================
// Admin API Client Methods
// Add these methods to src/lib/api.ts or create a separate admin api file

import axios from "axios";

export const adminApi = {
  // User Management
  getAllUsers: async (token: string) => {
    return axios.get("/admin/users", {
      headers: { Authorization: `Bearer ${token}` },
    });
  },

  getUserById: async (userId: string, token: string) => {
    return axios.get(`/admin/users/${userId}`, {
      headers: { Authorization: `Bearer ${token}` },
    });
  },

  updateUserRole: async (
    userId: string,
    role: string,
    token: string
  ) => {
    return axios.put(
      `/admin/users/${userId}/role`,
      { role },
      {
        headers: { Authorization: `Bearer ${token}` },
      }
    );
  },

  // Coin Management
  addCoins: async (
    userId: string,
    amount: number,
    reason: string,
    token: string
  ) => {
    return axios.post(
      "/admin/coins/add",
      { userId, amount, reason },
      {
        headers: { Authorization: `Bearer ${token}` },
      }
    );
  },

  removeCoins: async (
    userId: string,
    amount: number,
    reason: string,
    token: string
  ) => {
    return axios.post(
      "/admin/coins/remove",
      { userId, amount, reason },
      {
        headers: { Authorization: `Bearer ${token}` },
      }
    );
  },

  // Trade Management
  getAllTrades: async (status?: string, token?: string) => {
    const url = status ? `/admin/trades?status=${status}` : "/admin/trades";
    return axios.get(url, {
      headers: { Authorization: `Bearer ${token}` },
    });
  },

  getTradeById: async (tradeId: string, token: string) => {
    return axios.get(`/admin/trades/${tradeId}`, {
      headers: { Authorization: `Bearer ${token}` },
    });
  },

  acceptTrade: async (tradeId: string, token: string) => {
    return axios.put(
      `/admin/trades/${tradeId}/accept`,
      {},
      {
        headers: { Authorization: `Bearer ${token}` },
      }
    );
  },

  rejectTrade: async (tradeId: string, reason: string, token: string) => {
    return axios.put(
      `/admin/trades/${tradeId}/reject`,
      { reason },
      {
        headers: { Authorization: `Bearer ${token}` },
      }
    );
  },

  completeTrade: async (tradeId: string, token: string) => {
    return axios.put(
      `/admin/trades/${tradeId}/complete`,
      {},
      {
        headers: { Authorization: `Bearer ${token}` },
      }
    );
  },

  cancelTrade: async (
    tradeId: string,
    reason: string,
    token: string
  ) => {
    return axios.put(
      `/admin/trades/${tradeId}/cancel`,
      { reason },
      {
        headers: { Authorization: `Bearer ${token}` },
      }
    );
  },

  // Admin Stats
  getAdminStats: async (token: string) => {
    return axios.get("/admin/stats/overview", {
      headers: { Authorization: `Bearer ${token}` },
    });
  },
};


================================================
FILE: D:\barter_verse\frontend\src\lib\api.ts
================================================
import axios, { AxiosInstance } from 'axios';

const API_BASE_URL = 'http://localhost:5000/api';

class ApiClient {
  private client: AxiosInstance;
  private token: string | null = null;

  constructor() {
    this.client = axios.create({
      baseURL: API_BASE_URL,
      headers: {
        'Content-Type': 'application/json',
      },
    });

    this.client.interceptors.request.use((config) => {
      if (this.token) {
        config.headers.Authorization = `Bearer ${this.token}`;
        console.log(` Request to ${config.url} with token`);
      } else {
        console.log(` Request to ${config.url} WITHOUT token`);
      }
      return config;
    });
  }

  setToken(token: string | null) {
    this.token = token;
    console.log('API token set to:', token ? `${token.substring(0, 20)}...` : 'null');
  }

  // --- Auth & User Management ---
  async signup(email: string, password: string) {
    return this.client.post('/auth/signup', { email, password });
  }

  async signin(email: string, password: string) {
    return this.client.post('/auth/signin', { email, password });
  }

  async logout() {
    this.token = null;
  }

  // NEW: Added for Profile.tsx
  async updateProfile(data: { display_name?: string; bio?: string; avatar_url?: string }) {
    return this.client.patch('/users/profile', data);
  }

  async getUserProfile(userId: string) {
    return this.client.get(`/users/${userId}`);
  }

  // --- Listings ---
  async getListings(page = 1, limit = 10, category?: string, search?: string) {
    const params: any = { page, limit };
    if (category && category !== 'all') params.category = category;
    if (search) params.search = search;
    return this.client.get('/listings', { params });
  }

  async getListingById(id: string) {
    return this.client.get(`/listings/${id}`);
  }

  async getUserListings(userId: string) {
    return this.client.get(`/listings/user/${userId}`);
  }

  async createListing(data: any) {
    return this.client.post('/listings', data);
  }

  async updateListing(id: string, data: any) {
    return this.client.patch(`/listings/${id}`, data);
  }

  async deleteListing(id: string) {
    return this.client.delete(`/listings/${id}`);
  }

  async archiveListing(id: string) {
    return this.client.patch(`/listings/${id}`, { status: 'ARCHIVED' });
  }

  // --- Barter Coins (Wallet) ---
  async getBalance() {
    return this.client.get('/coins');
  }

  async addCoins(amount: number, reason?: string) {
    return this.client.post('/coins/add', { amount, reason });
  }

  async spendCoins(amount: number, reason?: string) {
    return this.client.post('/coins/spend', { amount, reason });
  }

  async transferCoins(toUserId: string, amount: number) {
    return this.client.post('/coins/transfer', { toUserId, amount });
  }

  async getTransactionHistory(limit = 50) {
    return this.client.get('/coins/transactions', { params: { limit } });
  }

  // --- Trading System (The Trust Protocol) ---
  async getTrades(direction?: 'incoming' | 'outgoing') {
    const params: any = {};
    if (direction) params.direction = direction;
    return this.client.get('/trades', { params });
  }

  async getTradeById(id: string) {
    return this.client.get(`/trades/${id}`);
  }

  async createTrade(data: any) {
    // data should include: listingId, responderUserId, proposedCoins OR proposedListingId
    return this.client.post('/trades', data);
  }

  // Handles 'accept' (Locks Escrow) or 'reject'
  async confirmTrade(id: string, action: 'accept' | 'reject') {
    return this.client.patch(`/trades/${id}/confirm`, { action });
  }

  // Handles 'complete' (Releases Escrow)
  async completeTrade(id: string) {
    return this.client.patch(`/trades/${id}/complete`, {});
  }

  async cancelTrade(id: string) {
    return this.client.patch(`/trades/${id}/cancel`, {});
  }

  // --- Reviews & Reputation ---
  async createReview(data: any) {
    return this.client.post('/reviews', data);
  }

  async getReviews(userId: string) {
    return this.client.get(`/reviews/user/${userId}`);
  }

  async getMyReviews() {
    return this.client.get('/reviews/my-reviews/given');
  }

  async deleteReview(id: string) {
    return this.client.delete(`/reviews/${id}`);
  }

  async health() {
    return this.client.get('/health');
  }
}

export const api = new ApiClient();

================================================
FILE: D:\barter_verse\frontend\src\lib\utils.ts
================================================
import { clsx, type ClassValue } from "clsx";
import { twMerge } from "tailwind-merge";

export function cn(...inputs: ClassValue[]) {
  return twMerge(clsx(inputs));
}


================================================
FILE: D:\barter_verse\frontend\src\main.tsx
================================================
import { createRoot } from "react-dom/client";
import App from "./App.tsx";
import "./index.css";

const rootElement = document.getElementById("root");
if (!rootElement) {
  throw new Error("Root element not found in DOM");
}

try {
  createRoot(rootElement).render(<App />);
} catch (error) {
  const errorMessage = error instanceof Error ? error.message : String(error);
  console.error("Failed to render app:", error);
  rootElement.innerHTML = `
    <div style="
      padding: 40px; 
      color: #ff6b6b; 
      font-family: monospace; 
      background: #1a1a1a; 
      min-height: 100vh;
      overflow-y: auto;
    ">
      <h1 style="color: #ff8787;">Error Loading App</h1>
      <p>Check the browser console (F12) for details.</p>
      <pre style="
        background: #0a0a0a; 
        padding: 20px; 
        border-radius: 8px; 
        overflow-x: auto;
        border: 1px solid #ff6b6b;
      ">${errorMessage}\n\n${error instanceof Error ? error.stack : ''}</pre>
      <p style="margin-top: 20px; color: #aaa;">Try refreshing the page or clearing browser cache.</p>
    </div>
  `;
}



================================================
FILE: D:\barter_verse\frontend\src\pages\Admin.tsx
================================================
import React, { useState, useEffect } from 'react';
import { Users, TrendingUp, AlertCircle, CheckCircle, Trash2 } from 'lucide-react';

const Admin = () => {
  const [stats, setStats] = useState<any>(null);
  const [loading, setLoading] = useState(true);
  const [message, setMessage] = useState('');

  useEffect(() => {
    fetchAdminStats();
  }, []);

  const fetchAdminStats = async () => {
    try {
      setLoading(true);
      // Admin stats endpoint not yet implemented - show placeholder
      setStats({
        total_users: 0,
        total_listings: 0,
        total_trades: 0,
        total_coins_distributed: 0,
      });
      setMessage('Admin dashboard loaded (stats not yet implemented)');
    } catch (error: any) {
      setMessage(`Error: ${error.message}`);
    } finally {
      setLoading(false);
    }
  };

  if (loading) {
    return <div className="p-6 text-center">Loading admin dashboard...</div>;
  }

  return (
    <div className="max-w-6xl mx-auto p-6">
      <h1 className="text-3xl font-bold mb-8"> Admin Dashboard</h1>

      {message && (
        <div className="mb-6 p-4 rounded-lg" style={{ background: 'hsl(var(--section-background))', border: '1px solid hsl(var(--border))' }}>
          {message}
        </div>
      )}

      {/* Stats Grid */}
      {stats && (
        <div className="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
          {/* Total Users */}
          <div className="card-upgrade p-6">
            <div className="flex items-center justify-between">
              <div>
                <p className="text-muted-foreground text-sm">Total Users</p>
                <p className="text-3xl font-bold text-primary">{stats.totalUsers || 0}</p>
              </div>
              <Users className="text-primary" size={32} />
            </div>
          </div>

          {/* Total Listings */}
          <div className="card-upgrade p-6">
            <div className="flex items-center justify-between">
              <div>
                <p className="text-muted-foreground text-sm">Total Listings</p>
                <p className="text-3xl font-bold text-secondary">{stats.totalListings || 0}</p>
              </div>
              <TrendingUp className="text-secondary" size={32} />
            </div>
          </div>

          {/* Active Trades */}
          <div className="card-upgrade p-6">
            <div className="flex items-center justify-between">
              <div>
                <p className="text-muted-foreground text-sm">Active Trades</p>
                <p className="text-3xl font-bold text-primary">{stats.activeTrades || 0}</p>
              </div>
              <CheckCircle className="text-primary" size={32} />
            </div>
          </div>

          {/* Total Coins Traded */}
          <div className="card-upgrade p-6">
            <div className="flex items-center justify-between">
              <div>
                <p className="text-muted-foreground text-sm">Total Coins</p>
                <p className="text-3xl font-bold" style={{ color: 'hsl(var(--gold-primary))' }}>{stats.totalCoinsTraded || 0}</p>
              </div>
              <AlertCircle className="text-[hsl(var(--gold-primary))]" size={32} />
            </div>
          </div>
        </div>
      )}

      {/* Admin Actions */}
      <div className="card-upgrade p-6">
        <h2 className="text-2xl font-bold mb-4"> Admin Actions</h2>

        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
          <button className="btn-primary px-6 py-3">
            View All Users
          </button>
          <button className="btn-secondary px-6 py-3">
            Manage Listings
          </button>
          <button className="btn-primary px-6 py-3">
            Review Trades
          </button>
          <button className="btn-secondary px-6 py-3">
            System Settings
          </button>
        </div>
      </div>

      {/* Info Message */}
      <div className="mt-8 p-4" style={{ background: 'hsl(var(--section-background))', border: '1px solid hsl(var(--border))', borderRadius: '8px' }}>
        <p className="text-sm text-muted-foreground">
          Admin panel features: User management, listing moderation, trade monitoring, and system configuration.
        </p>
      </div>
    </div>
  );
};

export default Admin;


================================================
FILE: D:\barter_verse\frontend\src\pages\Analytics.tsx
================================================
import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';
import { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';
import { BarChart, Bar, PieChart, Pie, Cell, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, AreaChart, Area } from 'recharts';
import { TrendingUp, Activity, PieChart as PieIcon, ArrowUpRight, DollarSign, Clock } from 'lucide-react';

const tradeData = [
  { month: 'Jan', completed: 12, pending: 3 },
  { month: 'Feb', completed: 19, pending: 5 },
  { month: 'Mar', completed: 15, pending: 2 },
  { month: 'Apr', completed: 28, pending: 4 },
  { month: 'May', completed: 22, pending: 6 },
  { month: 'Jun', completed: 35, pending: 8 },
];

const categoryData = [
  { name: 'Skills', value: 35 },
  { name: 'Items', value: 45 },
  { name: 'Services', value: 20 },
];

const COLORS = ['#22c55e', '#f59e0b', '#3b82f6'];

export default function Analytics() {
  return (
    <div className="min-h-screen py-12 px-4 sm:px-6 lg:px-8 relative">
      <div className="absolute top-0 right-0 w-[500px] h-[500px] bg-emerald-500/5 rounded-full blur-[100px] -z-10" />

      <div className="max-w-7xl mx-auto space-y-8">
        
        <div className="flex flex-col md:flex-row md:items-end justify-between gap-4">
          <div className="space-y-2">
            <h1 className="text-4xl font-bold text-white tracking-tight">Analytics Dashboard</h1>
            <p className="text-slate-400">Real-time insights into your trading performance and market trends.</p>
          </div>
          <div className="flex gap-2">
             <div className="bg-slate-900/50 border border-slate-800 px-4 py-2 rounded-lg text-sm text-slate-300">
                Last Updated: <span className="text-emerald-400 font-mono">Just now</span>
             </div>
          </div>
        </div>

        {/* KPI Cards */}
        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
           <MetricCard 
              label="Total Trade Value" 
              value="2,450 BC" 
              trend="+12%" 
              icon={<DollarSign className="w-5 h-5 text-amber-400" />} 
              color="amber"
           />
           <MetricCard 
              label="Success Rate" 
              value="94.2%" 
              trend="+2.1%" 
              icon={<Activity className="w-5 h-5 text-emerald-400" />} 
              color="emerald"
           />
           <MetricCard 
              label="Avg Response Time" 
              value="1.5 Hrs" 
              trend="-15%" 
              icon={<Clock className="w-5 h-5 text-blue-400" />} 
              color="blue"
           />
           <MetricCard 
              label="Active Listings" 
              value="12" 
              trend="Stable" 
              icon={<TrendingUp className="w-5 h-5 text-purple-400" />} 
              color="purple"
           />
        </div>

        <Tabs defaultValue="overview" className="space-y-6">
          <TabsList className="bg-slate-900/80 border border-white/10 p-1 rounded-xl w-full max-w-md">
            <TabsTrigger value="overview" className="flex-1 rounded-lg data-[state=active]:bg-emerald-600 data-[state=active]:text-white">Overview</TabsTrigger>
            <TabsTrigger value="categories" className="flex-1 rounded-lg data-[state=active]:bg-emerald-600 data-[state=active]:text-white">Categories</TabsTrigger>
            <TabsTrigger value="growth" className="flex-1 rounded-lg data-[state=active]:bg-emerald-600 data-[state=active]:text-white">Growth</TabsTrigger>
          </TabsList>

          <TabsContent value="overview" className="space-y-6 animate-fade-in">
            <div className="grid lg:grid-cols-3 gap-6">
              
              {/* Main Chart */}
              <Card className="lg:col-span-2 glass border border-white/5 shadow-xl">
                <CardHeader>
                  <CardTitle className="text-slate-100 flex items-center gap-2">
                     <TrendingUp className="w-5 h-5 text-emerald-400" /> Trade Volume
                  </CardTitle>
                </CardHeader>
                <CardContent>
                  <div className="h-[350px] w-full">
                    <ResponsiveContainer width="100%" height="100%">
                      <AreaChart data={tradeData}>
                        <defs>
                          <linearGradient id="colorCompleted" x1="0" y1="0" x2="0" y2="1">
                            <stop offset="5%" stopColor="#22c55e" stopOpacity={0.3}/>
                            <stop offset="95%" stopColor="#22c55e" stopOpacity={0}/>
                          </linearGradient>
                        </defs>
                        <CartesianGrid strokeDasharray="3 3" stroke="#1e293b" vertical={false} />
                        <XAxis dataKey="month" stroke="#64748b" tickLine={false} axisLine={false} />
                        <YAxis stroke="#64748b" tickLine={false} axisLine={false} />
                        <Tooltip 
                          contentStyle={{ backgroundColor: '#0f172a', border: '1px solid #1e293b', borderRadius: '8px', color: '#fff' }}
                        />
                        <Area type="monotone" dataKey="completed" stroke="#22c55e" fillOpacity={1} fill="url(#colorCompleted)" strokeWidth={3} />
                      </AreaChart>
                    </ResponsiveContainer>
                  </div>
                </CardContent>
              </Card>

              {/* Pie Chart */}
              <Card className="glass border border-white/5 shadow-xl">
                <CardHeader>
                  <CardTitle className="text-slate-100 flex items-center gap-2">
                     <PieIcon className="w-5 h-5 text-blue-400" /> Portfolio Mix
                  </CardTitle>
                </CardHeader>
                <CardContent>
                  <div className="h-[300px] w-full relative">
                    <ResponsiveContainer width="100%" height="100%">
                      <PieChart>
                        <Pie
                          data={categoryData}
                          cx="50%"
                          cy="50%"
                          innerRadius={60}
                          outerRadius={80}
                          paddingAngle={5}
                          dataKey="value"
                        >
                          {categoryData.map((entry, index) => (
                            <Cell key={`cell-${index}`} fill={COLORS[index % COLORS.length]} stroke="rgba(0,0,0,0)" />
                          ))}
                        </Pie>
                        <Tooltip contentStyle={{ backgroundColor: '#0f172a', border: '1px solid #1e293b', borderRadius: '8px', color: '#fff' }} />
                      </PieChart>
                    </ResponsiveContainer>
                    {/* Center Legend Overlay */}
                    <div className="absolute inset-0 flex flex-col items-center justify-center pointer-events-none">
                       <span className="text-2xl font-bold text-white">100%</span>
                       <span className="text-xs text-slate-500">DISTRIBUTION</span>
                    </div>
                  </div>
                  <div className="flex justify-center gap-4 mt-4">
                     {categoryData.map((item, idx) => (
                        <div key={item.name} className="flex items-center gap-2 text-xs text-slate-300">
                           <div className="w-2 h-2 rounded-full" style={{ backgroundColor: COLORS[idx] }} />
                           {item.name}
                        </div>
                     ))}
                  </div>
                </CardContent>
              </Card>
            </div>
          </TabsContent>

          <TabsContent value="categories">
             <div className="glass p-12 text-center border border-white/5 rounded-2xl">
                <p className="text-slate-500">Detailed category breakdown module coming in v2.0</p>
             </div>
          </TabsContent>
          
          <TabsContent value="growth">
             <div className="glass p-12 text-center border border-white/5 rounded-2xl">
                <p className="text-slate-500">Growth forecasting engine initializing...</p>
             </div>
          </TabsContent>
        </Tabs>
      </div>
    </div>
  );
}

function MetricCard({ label, value, trend, icon, color }: { label: string; value: string; trend: string; icon: React.ReactNode; color: string }) {
  const isPositive = trend.startsWith('+') || trend === 'Stable';
  
  return (
    <div className="glass p-6 rounded-2xl border border-white/5 hover:border-white/10 transition-all group">
       <div className="flex justify-between items-start mb-4">
          <div className={`p-3 rounded-xl bg-${color}-500/10 border border-${color}-500/20`}>
             {icon}
          </div>
          <span className={`text-xs font-bold px-2 py-1 rounded-full ${isPositive ? 'bg-emerald-500/10 text-emerald-400' : 'bg-red-500/10 text-red-400'}`}>
             {trend}
          </span>
       </div>
       <div className="space-y-1">
          <h3 className="text-slate-400 text-sm font-medium">{label}</h3>
          <p className="text-2xl font-bold text-white group-hover:text-transparent group-hover:bg-clip-text group-hover:bg-gradient-to-r group-hover:from-white group-hover:to-slate-400 transition-all">
             {value}
          </p>
       </div>
    </div>
  );
}

================================================
FILE: D:\barter_verse\frontend\src\pages\Auth.tsx
================================================
import { useState, useEffect } from 'react';
import { useNavigate } from 'react-router-dom';
import { useForm } from 'react-hook-form';
import { zodResolver } from '@hookform/resolvers/zod';
import * as z from 'zod';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { Label } from '@/components/ui/label';
import { useAuth } from '@/contexts/AuthContext';
import { useToast } from '@/hooks/use-toast';
import { Card, CardContent, CardHeader, CardTitle, CardDescription } from '@/components/ui/card';
import { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';
import { ArrowRight, Lock, Mail, User, ShieldCheck, Sparkles } from 'lucide-react';

const authSchema = z.object({
  email: z.string().email('Invalid email address'),
  password: z.string().min(6, 'Password must be at least 6 characters'),
});

type AuthFormData = z.infer<typeof authSchema>;

export default function Auth() {
  const [isLoading, setIsLoading] = useState(false);
  const { signIn, signUp, user } = useAuth();
  const navigate = useNavigate();
  const { toast } = useToast();

  const loginForm = useForm<AuthFormData>({
    resolver: zodResolver(authSchema),
  });

  const signupForm = useForm<AuthFormData>({
    resolver: zodResolver(authSchema),
  });

  // Redirect if already logged in
  useEffect(() => {
    if (user) {
      navigate('/');
    }
  }, [user, navigate]);

  const handleLogin = async (data: AuthFormData) => {
    setIsLoading(true);
    try {
      const { error } = await signIn(data.email, data.password);
      if (error) {
        toast({
          title: 'Login Failed',
          description: error.message.includes('Invalid login') ? 'Invalid credentials.' : error.message,
          variant: 'destructive',
        });
      } else {
        toast({ title: 'Success', description: 'Welcome back, trader!' });
        navigate('/');
      }
    } catch (err) {
      toast({ title: 'Error', description: 'Unexpected error.', variant: 'destructive' });
    } finally {
      setIsLoading(false);
    }
  };

  const handleSignup = async (data: AuthFormData) => {
    setIsLoading(true);
    try {
      const { error } = await signUp(data.email, data.password);
      if (error) {
        toast({
          title: 'Signup Failed',
          description: error.message,
          variant: 'destructive',
        });
      } else {
        toast({ title: 'Account Created', description: 'Please check your email to verify.' });
        signupForm.reset();
      }
    } catch (err) {
      toast({ title: 'Error', description: 'Unexpected error.', variant: 'destructive' });
    } finally {
      setIsLoading(false);
    }
  };

  return (
    <div className="min-h-screen grid lg:grid-cols-2">
      
      {/* Left Side: Form Area */}
      <div className="flex items-center justify-center p-8 bg-[#020617] relative overflow-hidden">
        {/* Ambient Glows */}
        <div className="absolute top-0 left-0 w-96 h-96 bg-blue-500/10 rounded-full blur-[100px] -z-10" />
        <div className="absolute bottom-0 right-0 w-96 h-96 bg-emerald-500/10 rounded-full blur-[100px] -z-10" />

        <div className="w-full max-w-md space-y-8 animate-fade-in-up">
          <div className="text-center space-y-2">
             <div className="inline-flex items-center justify-center w-12 h-12 rounded-xl bg-gradient-to-br from-emerald-400 to-emerald-600 shadow-lg shadow-emerald-500/20 mb-4">
                <span className="text-white font-bold text-2xl">B</span>
             </div>
             <h1 className="text-3xl font-bold text-white tracking-tight">Welcome to BarterVerse</h1>
             <p className="text-slate-400">Your gateway to decentralized trading.</p>
          </div>

          <Card className="border-0 bg-transparent shadow-none">
            <CardContent className="p-0">
              <Tabs defaultValue="login" className="w-full">
                <TabsList className="grid w-full grid-cols-2 bg-slate-900/50 p-1 rounded-xl border border-white/5 mb-6">
                  <TabsTrigger value="login" className="rounded-lg data-[state=active]:bg-emerald-600 data-[state=active]:text-white">Login</TabsTrigger>
                  <TabsTrigger value="signup" className="rounded-lg data-[state=active]:bg-emerald-600 data-[state=active]:text-white">Create Account</TabsTrigger>
                </TabsList>
                
                <TabsContent value="login">
                  <form onSubmit={loginForm.handleSubmit(handleLogin)} className="space-y-4">
                    <div className="space-y-2">
                      <Label className="text-slate-300">Email Address</Label>
                      <div className="relative">
                        <Mail className="absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-500" />
                        <Input
                          {...loginForm.register('email')}
                          className="pl-10 bg-slate-900/50 border-slate-800 text-white focus:ring-emerald-500/50 rounded-xl h-11"
                          placeholder="name@example.com"
                        />
                      </div>
                      {loginForm.formState.errors.email && <p className="text-xs text-red-400">{loginForm.formState.errors.email.message}</p>}
                    </div>

                    <div className="space-y-2">
                      <Label className="text-slate-300">Password</Label>
                      <div className="relative">
                        <Lock className="absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-500" />
                        <Input
                          type="password"
                          {...loginForm.register('password')}
                          className="pl-10 bg-slate-900/50 border-slate-800 text-white focus:ring-emerald-500/50 rounded-xl h-11"
                          placeholder=""
                        />
                      </div>
                      {loginForm.formState.errors.password && <p className="text-xs text-red-400">{loginForm.formState.errors.password.message}</p>}
                    </div>

                    <Button type="submit" className="w-full btn-primary h-11 text-base shadow-lg shadow-emerald-500/20" disabled={isLoading}>
                      {isLoading ? 'Authenticating...' : 'Sign In'} <ArrowRight className="w-4 h-4 ml-2" />
                    </Button>
                  </form>
                </TabsContent>
                
                <TabsContent value="signup">
                  <form onSubmit={signupForm.handleSubmit(handleSignup)} className="space-y-4">
                    <div className="space-y-2">
                      <Label className="text-slate-300">Email Address</Label>
                      <div className="relative">
                        <Mail className="absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-500" />
                        <Input
                          {...signupForm.register('email')}
                          className="pl-10 bg-slate-900/50 border-slate-800 text-white focus:ring-emerald-500/50 rounded-xl h-11"
                          placeholder="name@example.com"
                        />
                      </div>
                      {signupForm.formState.errors.email && <p className="text-xs text-red-400">{signupForm.formState.errors.email.message}</p>}
                    </div>

                    <div className="space-y-2">
                      <Label className="text-slate-300">Create Password</Label>
                      <div className="relative">
                        <Lock className="absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-500" />
                        <Input
                          type="password"
                          {...signupForm.register('password')}
                          className="pl-10 bg-slate-900/50 border-slate-800 text-white focus:ring-emerald-500/50 rounded-xl h-11"
                          placeholder=""
                        />
                      </div>
                      {signupForm.formState.errors.password && <p className="text-xs text-red-400">{signupForm.formState.errors.password.message}</p>}
                    </div>

                    <Button type="submit" className="w-full btn-primary h-11 text-base shadow-lg shadow-emerald-500/20" disabled={isLoading}>
                      {isLoading ? 'Creating Account...' : 'Create Account'} <Sparkles className="w-4 h-4 ml-2" />
                    </Button>
                  </form>
                </TabsContent>
              </Tabs>
            </CardContent>
          </Card>
          
          <div className="text-center text-sm text-slate-500">
             Protected by enterprise-grade encryption.
          </div>
        </div>
      </div>

      {/* Right Side: Visual Showcase */}
      <div className="hidden lg:flex flex-col items-center justify-center p-12 bg-slate-900 relative">
          <div className="absolute inset-0 bg-[url('https://images.unsplash.com/photo-1639322537228-f710d846310a?q=80&w=2832&auto=format&fit=crop')] bg-cover bg-center opacity-20" />
          <div className="absolute inset-0 bg-gradient-to-t from-slate-900 via-slate-900/80 to-slate-900/40" />
          
          <div className="relative z-10 max-w-lg text-center space-y-6">
             <div className="inline-flex items-center gap-2 px-4 py-2 rounded-full bg-white/5 border border-white/10 backdrop-blur-md text-emerald-300 mb-4">
                <ShieldCheck className="w-4 h-4" />
                <span>Verified & Secure Platform</span>
             </div>
             <h2 className="text-5xl font-extrabold text-white leading-tight">
                Trade Smarter,<br />Not Harder.
             </h2>
             <p className="text-lg text-slate-300 leading-relaxed">
                Join thousands of users exchanging value without spending fiat currency. 
                Experience the freedom of a true barter economy powered by smart matching.
             </p>
          </div>
      </div>
    </div>
  );
}

================================================
FILE: D:\barter_verse\frontend\src\pages\Community.tsx
================================================
import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';
import { Avatar } from '@/components/ui/avatar';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { Heart, MessageCircle, User, Send, Trash2, Users, Trophy, Flame, Search, Hash } from 'lucide-react';
import { useState, useEffect, useRef } from 'react';
import { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';

const threads = [
  {
    id: 1,
    user: 'Ammar',
    title: 'Best practices for successful trades',
    content: 'After completing 50+ trades, here are my top tips for smooth exchanges...',
    likes: 24,
    comments: 8,
    timeAgo: '2h ago',
    tag: 'Tips'
  },
  {
    id: 2,
    user: 'Priya',
    title: 'Looking for graphic design tools',
    content: 'Does anyone have Adobe CC or Figma resources they\'d like to trade? I can offer coding lessons in exchange.',
    likes: 12,
    comments: 5,
    timeAgo: '4h ago',
    tag: 'Request'
  },
  {
    id: 3,
    user: 'Rahul',
    title: 'Success story: Traded my way to a home office',
    content: 'Started with a simple keyboard trade, now I have a complete setup! It took about 3 months of active trading.',
    likes: 45,
    comments: 15,
    timeAgo: '1d ago',
    tag: 'Success'
  },
];

const topTraders = [
  { name: 'Siddu', trades: 127, coins: 5420 },
  { name: 'Ammar', trades: 95, coins: 4230 },
  { name: 'Priya', trades: 82, coins: 3890 },
  { name: 'Alex', trades: 65, coins: 2100 },
  { name: 'Sarah', trades: 44, coins: 1850 },
];

export default function Community() {
  const [likedThreads, setLikedThreads] = useState<number[]>([]);
  
  // Chat functionality
  const [conversations, setConversations] = useState<any[]>([]);
  const [selectedConversation, setSelectedConversation] = useState<string | null>(null);
  const [messages, setMessages] = useState<any[]>([]);
  const [newMessage, setNewMessage] = useState('');
  const [loading, setLoading] = useState(false);
  const [chatMessage, setChatMessage] = useState('');
  const [unreadCount, setUnreadCount] = useState(0);
  const [startNewChat, setStartNewChat] = useState(false);
  const [newChatUserId, setNewChatUserId] = useState('');
  const messagesEndRef = useRef<HTMLDivElement>(null);

  const toggleLike = (id: number) => {
    setLikedThreads(prev =>
      prev.includes(id) ? prev.filter(i => i !== id) : [...prev, id]
    );
  };

  // Chat functions (Mock implementation for UI demo)
  useEffect(() => {
    // Simulating fetching conversations
    setConversations([
        { other_user_id: 'Siddu', last_message_preview: 'Is the guitar still available?' },
        { other_user_id: 'Priya', last_message_preview: 'Thanks for the trade!' },
    ]);
  }, []);

  useEffect(() => {
    scrollToBottom();
  }, [messages]);

  const scrollToBottom = () => {
    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });
  };

  const handleSendMessage = (e: React.FormEvent) => {
    e.preventDefault();
    if (!newMessage.trim()) return;
    
    // Optimistic UI update
    const msg = {
        id: Date.now(),
        content: newMessage,
        is_from_me: true,
        created_at: new Date().toISOString()
    };
    setMessages([...messages, msg]);
    setNewMessage('');
  };

  return (
    <div className="min-h-screen py-12 px-4 sm:px-6 lg:px-8 relative overflow-hidden bg-[#020617]">
      
      {/* Background Ambience */}
      <div className="absolute top-0 right-0 w-full h-full overflow-hidden -z-10 pointer-events-none">
        <div className="absolute top-[-10%] right-[-10%] w-[600px] h-[600px] bg-purple-500/10 rounded-full mix-blend-multiply filter blur-3xl opacity-30 animate-blob" />
        <div className="absolute bottom-[-10%] left-[-10%] w-[600px] h-[600px] bg-blue-500/10 rounded-full mix-blend-multiply filter blur-3xl opacity-30 animate-blob animation-delay-4000" />
      </div>

      <div className="max-w-7xl mx-auto grid lg:grid-cols-3 gap-8">
        
        {/* Main Content Area */}
        <div className="lg:col-span-2 space-y-8 animate-fade-in-up">
          <div className="space-y-4">
            <div className="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-purple-500/10 border border-purple-500/20 text-purple-400 text-sm font-medium">
              <Users className="w-4 h-4" />
              <span>Trader Hub</span>
            </div>
            <h1 className="text-4xl md:text-5xl font-extrabold text-white tracking-tight">
              Community <span className="text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-pink-400">Voices</span>
            </h1>
            <p className="text-lg text-slate-400 max-w-2xl">
              Join the conversation, find trading partners, and share your barter success stories.
            </p>
          </div>

          {/* Tabs */}
          <Tabs defaultValue="discussions" className="w-full">
            <TabsList className="bg-slate-900/80 border border-white/10 p-1 rounded-xl w-full max-w-sm mb-8">
              <TabsTrigger value="discussions" className="flex-1 rounded-lg data-[state=active]:bg-purple-600 data-[state=active]:text-white">
                  Discussions
              </TabsTrigger>
              <TabsTrigger value="messages" className="flex-1 rounded-lg data-[state=active]:bg-purple-600 data-[state=active]:text-white relative">
                  Messages
                 <span className="absolute -top-1 -right-1 flex h-3 w-3">
                    <span className="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"></span>
                    <span className="relative inline-flex rounded-full h-3 w-3 bg-red-500"></span>
                 </span>
              </TabsTrigger>
            </TabsList>

            {/* Discussions Tab */}
            <TabsContent value="discussions" className="space-y-6">
              
              {/* Post Input (Visual) */}
              <div className="glass p-4 rounded-2xl border border-white/5 flex gap-4 items-center mb-8">
                 <Avatar className="w-10 h-10 border border-slate-700">
                    <div className="bg-slate-800 w-full h-full flex items-center justify-center text-white font-bold">ME</div>
                 </Avatar>
                 <div className="flex-1 relative">
                    <input 
                       type="text" 
                       placeholder="Start a discussion..." 
                       className="w-full bg-slate-950/50 border-none rounded-xl h-10 px-4 text-white placeholder:text-slate-500 focus:ring-1 focus:ring-purple-500/50"
                    />
                 </div>
                 <Button size="sm" className="bg-purple-600 hover:bg-purple-500"><Send className="w-4 h-4" /></Button>
              </div>

              {threads.map((thread, idx) => (
                <div 
                   key={thread.id} 
                   className="glass p-6 rounded-2xl border border-white/5 hover:border-purple-500/30 transition-all group hover:-translate-y-1 animate-fade-in-up opacity-0"
                   style={{ animationDelay: `${idx * 150}ms`, animationFillMode: 'forwards' }}
                >
                  <div className="flex items-start gap-4">
                    <Avatar className="w-12 h-12 border-2 border-slate-800 shadow-lg">
                      <div className="bg-gradient-to-br from-slate-700 to-slate-800 w-full h-full flex items-center justify-center text-slate-200 font-bold text-lg">
                         {thread.user[0]}
                      </div>
                    </Avatar>
                    <div className="flex-1 space-y-2">
                       <div className="flex justify-between items-start">
                          <div>
                             <div className="flex items-center gap-2 mb-1">
                                <h3 className="text-lg font-bold text-slate-100 group-hover:text-purple-400 transition-colors">
                                    {thread.title}
                                </h3>
                                <span className="text-[10px] px-2 py-0.5 rounded-full bg-slate-800 text-slate-400 border border-slate-700">{thread.tag}</span>
                             </div>
                             <p className="text-xs text-slate-500">Posted by <span className="text-slate-300 font-medium">{thread.user}</span>  {thread.timeAgo}</p>
                          </div>
                       </div>
                       <p className="text-slate-400 leading-relaxed text-sm border-l-2 border-slate-800 pl-4">
                          {thread.content}
                       </p>
                       
                       <div className="flex gap-4 pt-3">
                          <button 
                             onClick={() => toggleLike(thread.id)}
                             className={`flex items-center gap-2 text-xs font-medium px-3 py-1.5 rounded-lg transition-colors border ${likedThreads.includes(thread.id) ? 'bg-pink-500/10 border-pink-500/20 text-pink-400' : 'bg-slate-900/50 border-slate-800 text-slate-400 hover:bg-slate-800'}`}
                          >
                             <Heart className={`w-3.5 h-3.5 ${likedThreads.includes(thread.id) ? 'fill-pink-400' : ''}`} />
                             {thread.likes + (likedThreads.includes(thread.id) ? 1 : 0)} Likes
                          </button>
                          <button className="flex items-center gap-2 text-xs font-medium px-3 py-1.5 rounded-lg bg-slate-900/50 border border-slate-800 text-slate-400 hover:bg-slate-800 transition-colors">
                             <MessageCircle className="w-3.5 h-3.5" />
                             {thread.comments} Replies
                          </button>
                       </div>
                    </div>
                  </div>
                </div>
              ))}
            </TabsContent>

            {/* Messages Tab */}
            <TabsContent value="messages" className="space-y-6">
              <div className="grid md:grid-cols-3 gap-6 h-[600px]">
                 {/* Conversation List */}
                 <div className="glass rounded-2xl border border-white/5 overflow-hidden flex flex-col">
                    <div className="p-4 border-b border-white/5 bg-slate-900/50">
                        <div className="relative">
                            <Search className="absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-500" />
                            <input className="w-full bg-slate-950 border-none rounded-lg pl-9 h-9 text-sm text-white placeholder:text-slate-600 focus:ring-1 focus:ring-purple-500/50" placeholder="Search chats..." />
                        </div>
                    </div>
                    <div className="flex-1 overflow-y-auto">
                        {conversations.map((conv, i) => (
                            <div
                                key={i}
                                onClick={() => setSelectedConversation(conv.other_user_id)}
                                className={`p-4 border-b border-white/5 cursor-pointer transition-all hover:bg-white/5 ${selectedConversation === conv.other_user_id ? 'bg-purple-500/10 border-l-2 border-l-purple-500' : ''}`}
                            >
                                <div className="flex items-center gap-3">
                                    <div className="w-10 h-10 rounded-full bg-slate-800 flex items-center justify-center font-bold text-slate-400 relative">
                                        {conv.other_user_id[0]}
                                        <div className="absolute bottom-0 right-0 w-3 h-3 bg-emerald-500 border-2 border-slate-900 rounded-full"></div>
                                    </div>
                                    <div className="flex-1 min-w-0">
                                        <div className="flex justify-between items-center mb-0.5">
                                            <span className="font-semibold text-slate-200 truncate">{conv.other_user_id}</span>
                                            <span className="text-[10px] text-slate-600">12:30 PM</span>
                                        </div>
                                        <p className="text-xs text-slate-500 truncate">{conv.last_message_preview}</p>
                                    </div>
                                </div>
                            </div>
                        ))}
                    </div>
                 </div>

                 {/* Chat Area */}
                 <div className="md:col-span-2 glass rounded-2xl border border-white/5 flex flex-col h-full overflow-hidden relative">
                    {selectedConversation ? (
                       <>
                          <div className="p-4 border-b border-white/5 bg-slate-900/80 backdrop-blur-md flex items-center justify-between z-10">
                             <div className="flex items-center gap-3">
                                <div className="w-10 h-10 rounded-full bg-gradient-to-r from-purple-600 to-blue-600 flex items-center justify-center text-white font-bold shadow-lg">
                                   {selectedConversation[0]}
                                </div>
                                <div>
                                    <span className="font-bold text-slate-100 block">{selectedConversation}</span>
                                    <span className="text-xs text-emerald-400 flex items-center gap-1"><span className="w-1.5 h-1.5 rounded-full bg-emerald-400 animate-pulse"></span> Online</span>
                                </div>
                             </div>
                          </div>

                          <div className="flex-1 overflow-y-auto p-6 space-y-6 bg-slate-950/30">
                             {/* Mock Messages */}
                             <div className="flex justify-start">
                                <div className="max-w-[75%] p-4 rounded-2xl rounded-tl-none bg-slate-800 text-slate-300 text-sm shadow-sm">
                                    Hey! I saw your listing for the guitar lessons. Is it still available?
                                </div>
                             </div>
                             <div className="flex justify-end">
                                <div className="max-w-[75%] p-4 rounded-2xl rounded-tr-none bg-purple-600 text-white text-sm shadow-lg shadow-purple-900/20">
                                    Yes it is! I'm looking for web design help. Do you have experience with React?
                                </div>
                             </div>
                             {messages.map((msg) => (
                                <div key={msg.id} className={`flex ${msg.is_from_me ? 'justify-end' : 'justify-start'}`}>
                                   <div className={`max-w-[75%] p-4 rounded-2xl text-sm shadow-md ${
                                      msg.is_from_me 
                                      ? 'bg-purple-600 text-white rounded-tr-none' 
                                      : 'bg-slate-800 text-slate-300 rounded-tl-none'
                                   }`}>
                                      <p>{msg.content}</p>
                                   </div>
                                </div>
                             ))}
                             <div ref={messagesEndRef} />
                          </div>

                          <form onSubmit={handleSendMessage} className="p-4 bg-slate-900/80 border-t border-white/5 flex gap-3 backdrop-blur-md">
                             <div className="relative flex-1">
                                <input
                                    value={newMessage}
                                    onChange={(e) => setNewMessage(e.target.value)}
                                    placeholder="Type a message..."
                                    className="w-full bg-slate-950 border border-slate-800 rounded-xl h-12 pl-4 pr-12 text-white placeholder:text-slate-600 focus:ring-2 focus:ring-purple-500/50 focus:border-purple-500/50 transition-all"
                                />
                                <button type="button" className="absolute right-3 top-1/2 -translate-y-1/2 text-slate-500 hover:text-purple-400">
                                    <Hash className="w-4 h-4" />
                                </button>
                             </div>
                             <Button type="submit" disabled={!newMessage.trim()} size="icon" className="h-12 w-12 rounded-xl bg-purple-600 hover:bg-purple-500 shadow-lg shadow-purple-900/20">
                                <Send className="w-5 h-5" />
                             </Button>
                          </form>
                       </>
                    ) : (
                       <div className="h-full flex flex-col items-center justify-center text-slate-500 p-8 relative overflow-hidden">
                          <div className="absolute inset-0 bg-gradient-to-tr from-purple-500/5 to-transparent"></div>
                          <MessageCircle className="w-16 h-16 mb-6 opacity-20 text-purple-400" />
                          <h3 className="text-xl font-bold text-slate-300">No Chat Selected</h3>
                          <p className="text-sm opacity-60">Select a conversation to start trading</p>
                       </div>
                    )}
                 </div>
              </div>
            </TabsContent>
          </Tabs>
        </div>

        {/* Sidebar */}
        <div className="space-y-8 animate-fade-in-up [animation-delay:200ms] opacity-0" style={{ animationFillMode: 'forwards' }}>
          
          {/* Leaderboard */}
          <div className="glass rounded-3xl border border-white/5 overflow-hidden shadow-2xl relative">
             <div className="absolute top-0 right-0 w-32 h-32 bg-amber-500/10 rounded-full blur-2xl -z-10" />
             <div className="p-6 border-b border-white/5 flex items-center justify-between">
                <div className="flex items-center gap-2">
                    <Trophy className="w-5 h-5 text-amber-400" />
                    <h3 className="font-bold text-white">Top Traders</h3>
                </div>
                <span className="text-[10px] font-bold bg-slate-800 text-slate-400 px-2 py-1 rounded">This Week</span>
             </div>
             <div className="p-4 space-y-2">
                {topTraders.map((trader, index) => (
                   <div key={trader.name} className={`flex items-center justify-between p-3 rounded-xl border transition-all hover:scale-[1.02] ${
                       index === 0 ? 'bg-amber-500/10 border-amber-500/20' : 
                       index === 1 ? 'bg-slate-400/10 border-slate-400/20' : 
                       index === 2 ? 'bg-orange-700/10 border-orange-700/20' : 
                       'bg-slate-900/30 border-transparent hover:bg-slate-900/50'
                   }`}>
                      <div className="flex items-center gap-3">
                         <div className={`w-8 h-8 rounded-full flex items-center justify-center font-bold text-xs shadow-inner ${
                            index === 0 ? 'bg-gradient-to-br from-amber-300 to-amber-600 text-black' : 
                            index === 1 ? 'bg-gradient-to-br from-slate-300 to-slate-500 text-black' : 
                            index === 2 ? 'bg-gradient-to-br from-orange-400 to-orange-700 text-white' : 
                            'bg-slate-800 text-slate-500'
                         }`}>
                            {index + 1}
                         </div>
                         <div>
                            <div className={`font-bold text-sm ${index < 3 ? 'text-white' : 'text-slate-400'}`}>{trader.name}</div>
                            <div className="text-[10px] text-slate-500 uppercase font-bold">{trader.trades} trades</div>
                         </div>
                      </div>
                      <div className="text-right">
                         <div className="text-emerald-400 font-mono font-bold text-sm">{trader.coins}</div>
                         <div className="text-[10px] text-slate-600">BC Earned</div>
                      </div>
                   </div>
                ))}
             </div>
          </div>

          {/* Trending Topics */}
          <div className="glass rounded-3xl border border-white/5 overflow-hidden">
             <div className="p-6 border-b border-white/5 flex items-center gap-2">
                <Flame className="w-5 h-5 text-orange-500" />
                <h3 className="font-bold text-white">Trending</h3>
             </div>
             <div className="p-2">
                {['#BarterTips', '#SuccessStories', '#WebDesign', '#VintageGear', '#SafeTrading'].map((topic, i) => (
                   <Button key={topic} variant="ghost" className="w-full justify-between text-slate-400 hover:text-white hover:bg-white/5 h-12 px-4 group">
                      <span>{topic}</span>
                      <span className="text-xs text-slate-600 group-hover:text-slate-400">{100 - i * 12} posts</span>
                   </Button>
                ))}
             </div>
          </div>
        </div>

      </div>
    </div>
  );
}

================================================
FILE: D:\barter_verse\frontend\src\pages\Dashboard.tsx
================================================
import { useState, useEffect } from 'react';
import { Button } from '@/components/ui/button';
import { useCoins } from '@/contexts/CoinContext';
import { useAuth } from '@/contexts/AuthContext';
import { api } from '@/lib/api';
import { 
  Coins, Package, ArrowLeftRight, TrendingUp, Calendar, 
  Clock, Trash2, Plus, Activity, Zap, ArrowUpRight, 
  Wallet, Bell, Search 
} from 'lucide-react';
import { 
  AreaChart, Area, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer 
} from 'recharts';
import { useNavigate } from 'react-router-dom';
import { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';

interface DashboardStats {
  totalListings: number;
  activeListings: number;
  completedTrades: number;
  totalCoins: number;
}

interface Listing {
  id: string;
  title: string;
  category: string;
  price_bc: number;
  images: string[];
  created_at: string;
  status: string;
}

export default function Dashboard() {
  const { balance, transactions } = useCoins();
  const { user } = useAuth();
  const navigate = useNavigate();
  const [stats, setStats] = useState<DashboardStats>({
    totalListings: 0,
    activeListings: 0,
    completedTrades: 0,
    totalCoins: 0,
  });
  const [myListings, setMyListings] = useState<Listing[]>([]);
  const [chartData, setChartData] = useState<{ month: string; value: number }[]>([]);
  const [isLoading, setIsLoading] = useState(true);
  const [greeting, setGreeting] = useState('');

  // Determine greeting based on time
  useEffect(() => {
    const hour = new Date().getHours();
    if (hour < 12) setGreeting('Good morning');
    else if (hour < 18) setGreeting('Good afternoon');
    else setGreeting('Good evening');
  }, []);

  useEffect(() => {
    if (!user) {
      navigate('/auth');
      return;
    }
    fetchDashboardData();
  }, [user, navigate]);

  const fetchDashboardData = async () => {
    if (!user) return;

    try {
      setIsLoading(true);

      // Fetch user's listings
      const listingsResponse = await api.getUserListings(user.id);
      const listingsData = Array.isArray(listingsResponse.data.data) ? listingsResponse.data.data : [];

      // Fetch user's trades
      const tradesResponse = await api.getTrades();
      const tradesData = Array.isArray(tradesResponse.data.data) ? tradesResponse.data.data : [];

      const completedTrades = tradesData.filter((t: any) => t.status === 'COMPLETED').length || 0;

      // Mock Chart Data (Simulating Net Worth Growth)
      const mockChartData = [
        { month: 'Jan', value: 120 },
        { month: 'Feb', value: 132 },
        { month: 'Mar', value: 101 },
        { month: 'Apr', value: 134 },
        { month: 'May', value: 190 },
        { month: 'Jun', value: 230 },
        { month: 'Jul', value: balance || 245 }, 
      ];

      setStats({
        totalListings: listingsData.length || 0,
        activeListings: listingsData.filter((l: any) => l.status === 'ACTIVE').length || 0,
        completedTrades,
        totalCoins: balance,
      });
      setMyListings(listingsData);
      setChartData(mockChartData);
    } catch (error) {
      console.error('Error fetching dashboard data:', error);
    } finally {
      setIsLoading(false);
    }
  };

  return (
    <div className="min-h-screen bg-[#020617] relative overflow-hidden">
      
      {/* Ambient Background */}
      <div className="absolute top-0 right-0 w-[800px] h-[600px] bg-blue-500/5 rounded-full blur-[120px] -z-10 pointer-events-none" />
      <div className="absolute bottom-0 left-0 w-[600px] h-[600px] bg-emerald-500/5 rounded-full blur-[120px] -z-10 pointer-events-none" />

      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10 space-y-8">
        
        {/* Header Section */}
        <div className="flex flex-col md:flex-row md:items-end justify-between gap-6 animate-fade-in-up">
          <div className="space-y-2">
            <div className="flex items-center gap-2 text-emerald-400 font-medium text-sm">
               <span className="relative flex h-2 w-2">
                  <span className="animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"></span>
                  <span className="relative inline-flex rounded-full h-2 w-2 bg-emerald-500"></span>
               </span>
               Live Dashboard
            </div>
            <h1 className="text-4xl font-bold text-white tracking-tight">
              {greeting}, <span className="text-transparent bg-clip-text bg-gradient-to-r from-white to-slate-400">{user?.display_name || 'Trader'}</span>
            </h1>
            <p className="text-slate-400">Here's what's happening in your barter portfolio today.</p>
          </div>

          <div className="flex gap-3">
             <Button variant="outline" className="border-slate-800 bg-slate-900/50 hover:bg-slate-800 text-slate-300 hover:text-white" onClick={() => navigate('/explore')}>
                <Search className="w-4 h-4 mr-2" /> Find Trades
             </Button>
             <Button className="btn-primary shadow-lg shadow-emerald-500/20" onClick={() => navigate('/post')}>
                <Plus className="w-4 h-4 mr-2" /> New Listing
             </Button>
          </div>
        </div>

        {/* Stats Grid - Staggered Animation */}
        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
          <StatCard
            icon={<Wallet className="w-6 h-6 text-amber-400" />}
            label="Total Balance"
            value={`${balance} BC`}
            trend="+12% this month"
            color="amber"
            delay="0ms"
          />
          <StatCard
            icon={<Package className="w-6 h-6 text-blue-400" />}
            label="Active Listings"
            value={stats.activeListings.toString()}
            trend="2 Pending Approval"
            color="blue"
            delay="100ms"
          />
          <StatCard
            icon={<ArrowLeftRight className="w-6 h-6 text-emerald-400" />}
            label="Completed Trades"
            value={stats.completedTrades.toString()}
            trend="100% Satisfaction"
            color="emerald"
            delay="200ms"
          />
          <StatCard
            icon={<Zap className="w-6 h-6 text-purple-400" />}
            label="Reputation Score"
            value="4.8/5.0"
            trend="Top 10% of Traders"
            color="purple"
            delay="300ms"
          />
        </div>

        {/* Main Content Area */}
        <div className="grid grid-cols-1 lg:grid-cols-3 gap-8 animate-fade-in-up [animation-delay:400ms] opacity-0" style={{ animationFillMode: 'forwards' }}>
          
          {/* Left Column: Charts & Listings */}
          <div className="lg:col-span-2 space-y-8">
             
             {/* Chart Card */}
             <div className="glass p-6 rounded-3xl border border-white/5 shadow-xl relative overflow-hidden">
                <div className="absolute top-0 right-0 p-6 opacity-10">
                   <Activity className="w-24 h-24 text-white" />
                </div>
                
                <div className="flex items-center justify-between mb-8 relative z-10">
                   <div>
                      <h3 className="text-lg font-bold text-white">Portfolio Growth</h3>
                      <p className="text-sm text-slate-400">Net worth in Barter Coins over time</p>
                   </div>
                   <div className="flex gap-2">
                      <select className="bg-slate-950 border border-slate-800 text-slate-300 text-xs rounded-lg px-3 py-1.5 outline-none focus:border-emerald-500/50">
                         <option>Last 6 Months</option>
                         <option>This Year</option>
                      </select>
                   </div>
                </div>

                <div className="h-[300px] w-full relative z-10">
                   <ResponsiveContainer width="100%" height="100%">
                      <AreaChart data={chartData}>
                         <defs>
                            <linearGradient id="colorValue" x1="0" y1="0" x2="0" y2="1">
                               <stop offset="5%" stopColor="#22c55e" stopOpacity={0.3}/>
                               <stop offset="95%" stopColor="#22c55e" stopOpacity={0}/>
                            </linearGradient>
                         </defs>
                         <CartesianGrid strokeDasharray="3 3" stroke="#1e293b" vertical={false} />
                         <XAxis dataKey="month" stroke="#64748b" tickLine={false} axisLine={false} fontSize={12} />
                         <YAxis stroke="#64748b" tickLine={false} axisLine={false} fontSize={12} />
                         <Tooltip 
                            contentStyle={{ backgroundColor: '#020617', border: '1px solid #1e293b', borderRadius: '12px', color: '#fff' }}
                            itemStyle={{ color: '#22c55e' }}
                         />
                         <Area type="monotone" dataKey="value" stroke="#22c55e" strokeWidth={3} fillOpacity={1} fill="url(#colorValue)" />
                      </AreaChart>
                   </ResponsiveContainer>
                </div>
             </div>

             {/* Listings Tabs */}
             <Tabs defaultValue="active" className="w-full">
                <div className="flex items-center justify-between mb-4">
                   <h3 className="text-xl font-bold text-white">Your Inventory</h3>
                   <TabsList className="bg-slate-900/50 border border-slate-800 p-1 rounded-xl">
                      <TabsTrigger value="active" className="text-xs rounded-lg data-[state=active]:bg-emerald-600 data-[state=active]:text-white">Active</TabsTrigger>
                      <TabsTrigger value="drafts" className="text-xs rounded-lg data-[state=active]:bg-emerald-600 data-[state=active]:text-white">Drafts</TabsTrigger>
                   </TabsList>
                </div>

                <TabsContent value="active" className="space-y-4">
                   {isLoading ? (
                      <div className="text-center py-12 text-slate-500">Loading...</div>
                   ) : myListings.length > 0 ? (
                      myListings.slice(0, 3).map((listing) => (
                         <div key={listing.id} className="group glass p-4 rounded-2xl border border-white/5 hover:border-emerald-500/30 transition-all flex items-center gap-4 cursor-pointer">
                            <div className="h-16 w-16 rounded-xl bg-slate-900 overflow-hidden flex-shrink-0">
                               <img src={listing.images?.[0] || 'https://images.unsplash.com/photo-1556740758-90de374c12ad?w=150'} alt={listing.title} className="w-full h-full object-cover group-hover:scale-110 transition-transform" />
                            </div>
                            <div className="flex-1 min-w-0">
                               <h4 className="font-bold text-slate-200 truncate group-hover:text-emerald-400 transition-colors">{listing.title}</h4>
                               <p className="text-xs text-slate-500">{listing.category}  Listed {new Date(listing.created_at).toLocaleDateString()}</p>
                            </div>
                            <div className="text-right">
                               <div className="font-bold text-amber-400 text-lg">{listing.price_bc} BC</div>
                               <div className="text-xs text-emerald-500 font-medium flex items-center justify-end gap-1"><div className="w-1.5 h-1.5 rounded-full bg-emerald-500" /> Active</div>
                            </div>
                         </div>
                      ))
                   ) : (
                      <div className="glass p-12 rounded-2xl border border-dashed border-slate-800 text-center">
                         <p className="text-slate-500 mb-4">No active listings found.</p>
                         <Button variant="outline" size="sm" onClick={() => navigate('/post')}>Create First Listing</Button>
                      </div>
                   )}
                </TabsContent>
             </Tabs>
          </div>

          {/* Right Column: Activity Feed */}
          <div className="space-y-6">
             <div className="glass p-6 rounded-3xl border border-white/5 h-full min-h-[500px] flex flex-col">
                <div className="flex items-center justify-between mb-6">
                   <h3 className="text-lg font-bold text-white flex items-center gap-2">
                      <Bell className="w-5 h-5 text-blue-400" /> Recent Activity
                   </h3>
                </div>

                <div className="flex-1 overflow-y-auto pr-2 space-y-6 relative">
                   {/* Timeline Line */}
                   <div className="absolute left-[19px] top-2 bottom-0 w-0.5 bg-slate-800 -z-10" />

                   {transactions.length > 0 ? (
                      transactions.slice(0, 8).map((tx, idx) => (
                         <div key={tx.id || idx} className="flex gap-4 group">
                            <div className={`w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0 border-4 border-[#020617] shadow-sm transition-colors ${
                               tx.type === 'earn' ? 'bg-emerald-500/20 text-emerald-400 group-hover:bg-emerald-500 group-hover:text-white' : 
                               'bg-slate-800 text-slate-400 group-hover:bg-slate-700 group-hover:text-white'
                            }`}>
                               {tx.type === 'earn' ? <ArrowUpRight className="w-5 h-5" /> : <ArrowLeftRight className="w-5 h-5" />}
                            </div>
                            <div className="pb-6 border-b border-white/5 w-full group-last:border-0 group-last:pb-0">
                               <div className="flex justify-between items-start">
                                  <p className="text-sm font-medium text-slate-200 group-hover:text-white transition-colors">
                                     {tx.meta?.reason || (tx.type === 'earn' ? 'Received Payment' : 'Sent Payment')}
                                  </p>
                                  <span className={`text-xs font-bold ${tx.amount > 0 ? 'text-emerald-400' : 'text-slate-500'}`}>
                                     {tx.amount > 0 ? '+' : ''}{tx.amount} BC
                                  </span>
                               </div>
                               <p className="text-xs text-slate-500 mt-1">
                                  {new Date(tx.created_at).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}  Wallet Transaction
                               </p>
                            </div>
                         </div>
                      ))
                   ) : (
                      <div className="text-center py-20 text-slate-500">
                         <Clock className="w-12 h-12 mx-auto mb-3 opacity-20" />
                         <p>No recent activity recorded.</p>
                      </div>
                   )}
                </div>
             </div>
          </div>

        </div>
      </div>
    </div>
  );
}

function StatCard({ icon, label, value, trend, color, delay }: { icon: React.ReactNode, label: string, value: string, trend: string, color: string, delay: string }) {
   return (
      <div 
         className={`glass p-6 rounded-3xl border border-white/5 hover:-translate-y-1 transition-all duration-300 group hover:border-${color}-500/30 animate-fade-in-up opacity-0`}
         style={{ animationDelay: delay, animationFillMode: 'forwards' }}
      >
         <div className="flex justify-between items-start mb-4">
            <div className={`p-3 rounded-2xl bg-${color}-500/10 border border-${color}-500/20 group-hover:scale-110 transition-transform`}>
               {icon}
            </div>
            {trend && (
               <span className={`text-[10px] font-bold px-2 py-1 rounded-full bg-${color}-500/10 text-${color}-400 border border-${color}-500/10`}>
                  {trend}
               </span>
            )}
         </div>
         <div className="space-y-1">
            <p className="text-sm font-medium text-slate-400">{label}</p>
            <h3 className="text-3xl font-bold text-white tracking-tight group-hover:text-transparent group-hover:bg-clip-text group-hover:bg-gradient-to-r group-hover:from-white group-hover:to-slate-400 transition-all">
               {value}
            </h3>
         </div>
      </div>
   );
}

================================================
FILE: D:\barter_verse\frontend\src\pages\EcoMap.tsx
================================================
import { useState } from 'react';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { MapPin, Navigation, Layers, Search, Zap, ShoppingBag, Truck } from 'lucide-react';

// Mock Data for Map Pins
const PINS = [
  { id: 1, type: 'skill', x: '40%', y: '30%', title: 'Guitar Lessons', user: 'Alex', dist: '0.8km' },
  { id: 2, type: 'item', x: '60%', y: '50%', title: 'Vintage Camera', user: 'Sarah', dist: '1.2km' },
  { id: 3, type: 'service', x: '30%', y: '70%', title: 'Gardening Help', user: 'Mike', dist: '0.5km' },
  { id: 4, type: 'item', x: '75%', y: '25%', title: 'Gaming Monitor', user: 'Priya', dist: '2.1km' },
  { id: 5, type: 'skill', x: '20%', y: '40%', title: 'React Tutoring', user: 'Dev', dist: '1.5km' },
];

export default function EcoMap() {
  const [selectedPin, setSelectedPin] = useState<number | null>(null);
  const [filter, setFilter] = useState('all');

  return (
    <div className="relative h-[calc(100vh-64px)] w-full overflow-hidden bg-[#0B1121]">
      
      {/* 1. The Map Visual (CSS Mock) */}
      <div className="absolute inset-0 z-0">
         {/* Dark Map Base Layer */}
         <div className="w-full h-full bg-[radial-gradient(ellipse_at_center,_var(--tw-gradient-stops))] from-slate-900 via-[#020617] to-black opacity-80" />
         
         {/* Grid Lines for "Tech" feel */}
         <div className="absolute inset-0 bg-[linear-gradient(to_right,#80808008_1px,transparent_1px),linear-gradient(to_bottom,#80808008_1px,transparent_1px)] bg-[size:40px_40px]" />
         
         {/* Simulated Streets (Abstract) */}
         <svg className="absolute inset-0 w-full h-full opacity-20 pointer-events-none stroke-emerald-500/30" strokeWidth="1">
            <path d="M0 200 Q 400 250 800 200 T 1600 200" fill="none" />
            <path d="M200 0 Q 250 400 200 800" fill="none" />
            <path d="M600 0 L 600 1000" fill="none" />
            <path d="M0 600 L 1600 600" fill="none" />
         </svg>

         {/* The Pins */}
         {PINS.map((pin) => (
            <div 
               key={pin.id}
               className="absolute group cursor-pointer"
               style={{ top: pin.y, left: pin.x }}
               onClick={() => setSelectedPin(pin.id)}
            >
               {/* Pulse Effect */}
               <div className={`absolute -inset-4 rounded-full opacity-0 group-hover:opacity-100 animate-ping ${
                  pin.type === 'skill' ? 'bg-purple-500/30' : pin.type === 'item' ? 'bg-blue-500/30' : 'bg-amber-500/30'
               }`} />
               
               {/* Pin Head */}
               <div className={`relative z-10 w-4 h-4 rounded-full border-2 border-white shadow-[0_0_15px_rgba(255,255,255,0.5)] transition-transform group-hover:scale-125 ${
                  pin.type === 'skill' ? 'bg-purple-500' : pin.type === 'item' ? 'bg-blue-500' : 'bg-amber-500'
               }`} />

               {/* Hover Tooltip */}
               <div className="absolute left-1/2 -translate-x-1/2 bottom-full mb-3 opacity-0 group-hover:opacity-100 transition-all duration-300 pointer-events-none">
                  <div className="glass px-3 py-2 rounded-xl border border-white/10 whitespace-nowrap text-xs text-white">
                     <span className="font-bold block">{pin.title}</span>
                     <span className="text-slate-400">{pin.dist} away</span>
                  </div>
               </div>
            </div>
         ))}

         {/* User Location Pulse */}
         <div className="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2">
            <div className="w-6 h-6 bg-emerald-500 rounded-full border-4 border-white shadow-2xl z-20 relative"></div>
            <div className="absolute inset-0 bg-emerald-500 rounded-full animate-ping opacity-50 h-full w-full"></div>
            <div className="absolute -inset-8 bg-emerald-500/20 rounded-full animate-pulse"></div>
         </div>
      </div>

      {/* 2. Floating Controls */}
      <div className="absolute top-6 left-6 z-10 space-y-4 max-w-xs w-full">
         
         {/* Search */}
         <div className="glass p-2 rounded-xl border border-white/10 flex gap-2">
            <Search className="w-5 h-5 text-slate-400 ml-2 mt-2.5" />
            <Input 
               placeholder="Search area..." 
               className="bg-transparent border-none text-white placeholder:text-slate-500 focus-visible:ring-0" 
            />
         </div>

         {/* Filters */}
         <div className="glass p-4 rounded-2xl border border-white/10 space-y-3">
            <div className="text-xs font-bold text-slate-400 uppercase tracking-wider">Filters</div>
            <div className="grid grid-cols-2 gap-2">
               <FilterBtn active={filter === 'all'} onClick={() => setFilter('all')} icon={<Layers className="w-3 h-3" />} label="All" />
               <FilterBtn active={filter === 'skill'} onClick={() => setFilter('skill')} icon={<Zap className="w-3 h-3" />} label="Skills" color="purple" />
               <FilterBtn active={filter === 'item'} onClick={() => setFilter('item')} icon={<ShoppingBag className="w-3 h-3" />} label="Items" color="blue" />
               <FilterBtn active={filter === 'service'} onClick={() => setFilter('service')} icon={<Truck className="w-3 h-3" />} label="Services" color="amber" />
            </div>
         </div>
      </div>

      {/* 3. Selected Pin Detail (Bottom Card) */}
      {selectedPin && (
         <div className="absolute bottom-8 left-1/2 -translate-x-1/2 w-full max-w-md px-4 animate-fade-in-up">
            <div className="glass p-6 rounded-3xl border border-white/10 shadow-2xl relative overflow-hidden">
               <div className="absolute top-0 right-0 w-32 h-32 bg-emerald-500/10 blur-[50px] -z-10" />
               
               <div className="flex justify-between items-start">
                  <div>
                     <h3 className="text-xl font-bold text-white">{PINS.find(p => p.id === selectedPin)?.title}</h3>
                     <p className="text-slate-400 text-sm mt-1">Listed by {PINS.find(p => p.id === selectedPin)?.user}  {PINS.find(p => p.id === selectedPin)?.dist}</p>
                  </div>
                  <Button variant="ghost" size="icon" onClick={() => setSelectedPin(null)} className="text-slate-500 hover:text-white"></Button>
               </div>
               
               <div className="mt-6 flex gap-3">
                  <Button className="flex-1 btn-primary">Start Trade</Button>
                  <Button variant="outline" className="flex-1 border-slate-700 text-slate-300 hover:text-white bg-slate-800/50">
                     <Navigation className="w-4 h-4 mr-2" /> Directions
                  </Button>
               </div>
            </div>
         </div>
      )}
    </div>
  );
}

function FilterBtn({ active, icon, label, onClick, color = 'emerald' }: any) {
   return (
      <button 
         onClick={onClick}
         className={`flex items-center gap-2 px-3 py-2 rounded-lg text-xs font-medium transition-all ${
            active 
            ? `bg-${color}-500/20 text-${color}-400 border border-${color}-500/30` 
            : 'bg-slate-900/50 text-slate-400 hover:bg-slate-800 hover:text-white border border-transparent'
         }`}
      >
         {icon}
         {label}
      </button>
   );
}

================================================
FILE: D:\barter_verse\frontend\src\pages\Explore.tsx
================================================
import { useState, useEffect } from 'react';
import { Input } from '@/components/ui/input';
import { Button } from '@/components/ui/button';
import { Search, Loader2, MapPin, Filter, SlidersHorizontal, Grid, List as ListIcon, Star, Zap, ShoppingBag, GraduationCap, Truck, CheckCircle } from 'lucide-react';
import { useListings } from '@/contexts/ListingsContext';
import ListingCard from '@/components/ListingCard';
import ListingModal from '@/components/ListingModal';
import type { Listing } from '@/contexts/ListingsContext';

// Visual Category Data
const CATEGORIES = [
  { id: 'all', label: 'All', icon: <Grid className="w-4 h-4" /> },
  { id: 'Skills', label: 'Skills', icon: <GraduationCap className="w-4 h-4" /> },
  { id: 'Items', label: 'Items', icon: <ShoppingBag className="w-4 h-4" /> },
  { id: 'Services', label: 'Services', icon: <Zap className="w-4 h-4" /> },
  { id: 'Transport', label: 'Transport', icon: <Truck className="w-4 h-4" /> },
];

export default function Explore() {
  const { listings, isLoading } = useListings();
  const [searchQuery, setSearchQuery] = useState('');
  const [selectedCategory, setSelectedCategory] = useState('all');
  const [selectedListing, setSelectedListing] = useState<Listing | null>(null);
  const [isModalOpen, setIsModalOpen] = useState(false);
  const [viewMode, setViewMode] = useState<'grid' | 'list'>('grid');
  
  // Advanced Filter States
  const [showFilters, setShowFilters] = useState(false);
  const [priceRange, setPriceRange] = useState([0, 1000]);
  const [verifiedOnly, setVerifiedOnly] = useState(false);

  // Mock "Featured" Listings for the Hero Section
  const featuredListings = listings.slice(0, 3); 

  const filteredListings = listings.filter(listing => {
    const matchesSearch = listing.title.toLowerCase().includes(searchQuery.toLowerCase()) ||
                          listing.description?.toLowerCase().includes(searchQuery.toLowerCase());
    const matchesCategory = selectedCategory === 'all' || listing.category === selectedCategory;
    const matchesVerified = !verifiedOnly || listing.verified;
    // Simple lower bound check for price demo
    const matchesPrice = (listing.price_bc || 0) >= priceRange[0]; 

    return matchesSearch && matchesCategory && matchesVerified && matchesPrice;
  });

  const handleViewDetails = (listing: Listing) => {
    setSelectedListing(listing);
    setIsModalOpen(true);
  };

  return (
    <div className="min-h-screen bg-[#020617] relative">
      {/* Background Ambience */}
      <div className="fixed top-0 left-0 w-full h-[500px] bg-gradient-to-b from-blue-900/10 to-transparent -z-10" />

      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 space-y-8">
        
        {/* 1. Marketplace Spotlight Hero */}
        <div className="relative rounded-3xl overflow-hidden border border-white/10 shadow-2xl h-[280px] md:h-[320px] group animate-fade-in-up">
           <div className="absolute inset-0 bg-[url('https://images.unsplash.com/photo-1556761175-5973dc0f32e7?q=80&w=2664&auto=format&fit=crop')] bg-cover bg-center transition-transform duration-700 group-hover:scale-105" />
           <div className="absolute inset-0 bg-gradient-to-r from-slate-950 via-slate-950/80 to-transparent" />
           
           <div className="relative z-10 h-full flex flex-col justify-center px-8 md:px-12 space-y-4 max-w-2xl">
              <div className="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-emerald-500/20 border border-emerald-500/30 text-emerald-400 text-xs font-bold uppercase tracking-wider w-fit animate-fade-in-up">
                 <Star className="w-3 h-3 fill-emerald-400" /> Featured Collections
              </div>
              <h1 className="text-4xl md:text-5xl font-extrabold text-white leading-tight animate-fade-in-up [animation-delay:100ms]">
                 Discover Rare Finds & <br/>
                 <span className="text-transparent bg-clip-text bg-gradient-to-r from-emerald-400 to-cyan-400">Expert Services</span>
              </h1>
              <p className="text-slate-300 text-lg animate-fade-in-up [animation-delay:200ms]">
                 Connect with top-rated traders in your area today.
              </p>
           </div>
        </div>

        {/* 2. Control Bar (Search & Toggles) */}
        <div className="sticky top-20 z-30 glass p-2 rounded-2xl border border-white/10 shadow-xl flex flex-col md:flex-row gap-3">
           <div className="relative flex-1">
              <Search className="absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400" />
              <input
                 type="text"
                 placeholder="Search for items, skills, services..."
                 value={searchQuery}
                 onChange={(e) => setSearchQuery(e.target.value)}
                 className="w-full h-12 pl-12 pr-4 bg-slate-950/50 rounded-xl border border-transparent focus:border-emerald-500/50 focus:bg-slate-900 text-white placeholder:text-slate-500 outline-none transition-all"
              />
           </div>
           
           <div className="flex items-center gap-2">
              <Button 
                 onClick={() => setShowFilters(!showFilters)}
                 variant="outline" 
                 className={`h-12 px-4 border-slate-700 hover:bg-slate-800 text-slate-300 ${showFilters ? 'bg-emerald-500/10 border-emerald-500/50 text-emerald-400' : ''}`}
              >
                 <SlidersHorizontal className="w-4 h-4 mr-2" /> Filters
              </Button>
              
              <div className="h-12 bg-slate-950/50 rounded-xl p-1 flex border border-white/5">
                 <button 
                    onClick={() => setViewMode('grid')}
                    className={`px-3 rounded-lg flex items-center justify-center transition-all ${viewMode === 'grid' ? 'bg-slate-800 text-white shadow-sm' : 'text-slate-500 hover:text-slate-300'}`}
                 >
                    <Grid className="w-5 h-5" />
                 </button>
                 <button 
                    onClick={() => setViewMode('list')}
                    className={`px-3 rounded-lg flex items-center justify-center transition-all ${viewMode === 'list' ? 'bg-slate-800 text-white shadow-sm' : 'text-slate-500 hover:text-slate-300'}`}
                 >
                    <ListIcon className="w-5 h-5" />
                 </button>
              </div>
           </div>
        </div>

        <div className="flex flex-col lg:flex-row gap-8 items-start">
           
           {/* 3. Sidebar Filters (Collapsible on Mobile) */}
           <div className={`w-full lg:w-64 space-y-6 flex-shrink-0 transition-all duration-300 ${showFilters ? 'block' : 'hidden lg:block'}`}>
              <div className="glass rounded-2xl p-6 border border-white/5 space-y-8 sticky top-36">
                 
                 {/* Categories */}
                 <div className="space-y-3">
                    <h3 className="text-sm font-bold text-slate-400 uppercase tracking-wider">Categories</h3>
                    <div className="space-y-1">
                       {CATEGORIES.map(cat => (
                          <button
                             key={cat.id}
                             onClick={() => setSelectedCategory(cat.id)}
                             className={`w-full flex items-center gap-3 px-3 py-2 rounded-lg text-sm font-medium transition-all ${
                                selectedCategory === cat.id 
                                ? 'bg-emerald-500/10 text-emerald-400 border border-emerald-500/20' 
                                : 'text-slate-400 hover:bg-white/5 hover:text-white'
                             }`}
                          >
                             {cat.icon}
                             {cat.label}
                          </button>
                       ))}
                    </div>
                 </div>

                 {/* Price/Value Range */}
                 <div className="space-y-4">
                    <div className="flex justify-between text-sm">
                       <span className="text-slate-400 font-bold">Min Value</span>
                       <span className="text-emerald-400 font-bold">{priceRange[0]} BC</span>
                    </div>
                    <input 
                       type="range" 
                       min="0" 
                       max="1000" 
                       value={priceRange[0]} 
                       onChange={(e) => setPriceRange([parseInt(e.target.value), priceRange[1]])}
                       className="w-full h-2 bg-slate-800 rounded-lg appearance-none cursor-pointer accent-emerald-500"
                    />
                 </div>

                 {/* Verified Toggle */}
                 <div className="pt-4 border-t border-white/5">
                    <label className="flex items-center gap-3 cursor-pointer group">
                       <div className={`w-5 h-5 rounded border flex items-center justify-center transition-colors ${verifiedOnly ? 'bg-emerald-500 border-emerald-500' : 'border-slate-600 bg-transparent group-hover:border-slate-500'}`}>
                          {verifiedOnly && <CheckCircle className="w-3.5 h-3.5 text-white" />}
                       </div>
                       <input type="checkbox" className="hidden" checked={verifiedOnly} onChange={() => setVerifiedOnly(!verifiedOnly)} />
                       <span className="text-sm text-slate-300 group-hover:text-white">Verified Traders Only</span>
                    </label>
                 </div>

                 <div className="pt-4">
                    <Button className="w-full btn-primary" onClick={() => {}}>Apply Filters</Button>
                 </div>
              </div>
           </div>

           {/* 4. Results Grid */}
           <div className="flex-1 min-h-[500px]">
              <div className="flex justify-between items-center mb-4">
                 <h2 className="text-xl font-bold text-white">
                    {selectedCategory === 'all' ? 'All Listings' : selectedCategory}
                 </h2>
                 <span className="text-sm text-slate-500">{filteredListings.length} results found</span>
              </div>

              {isLoading ? (
                 <div className="flex flex-col items-center justify-center py-32">
                    <Loader2 className="w-10 h-10 animate-spin text-emerald-500 mb-4" />
                    <p className="text-slate-500">Searching the Verse...</p>
                 </div>
              ) : filteredListings.length > 0 ? (
                 <div className={`grid gap-6 ${
                    viewMode === 'grid' 
                    ? 'grid-cols-1 sm:grid-cols-2 xl:grid-cols-3' 
                    : 'grid-cols-1'
                 }`}>
                    {filteredListings.map(listing => (
                       viewMode === 'grid' ? (
                          <ListingCard key={listing.id} listing={listing} onViewDetails={handleViewDetails} />
                       ) : (
                          <ListViewCard key={listing.id} listing={listing} onViewDetails={handleViewDetails} />
                       )
                    ))}
                 </div>
              ) : (
                 <div className="glass rounded-2xl p-12 text-center border border-dashed border-slate-700">
                    <div className="w-16 h-16 bg-slate-900 rounded-full flex items-center justify-center mx-auto mb-4 border border-slate-800">
                       <Filter className="w-8 h-8 text-slate-600" />
                    </div>
                    <h3 className="text-xl font-bold text-white mb-2">No matches found</h3>
                    <p className="text-slate-400 mb-6">Try adjusting your filters or search for something else.</p>
                    <Button variant="outline" onClick={() => {setSearchQuery(''); setSelectedCategory('all');}} className="border-slate-700 text-slate-300">
                       Clear Filters
                    </Button>
                 </div>
              )}
           </div>
        </div>
      </div>

      <ListingModal
        listing={selectedListing}
        isOpen={isModalOpen}
        onClose={() => setIsModalOpen(false)}
      />
    </div>
  );
}

// Special Card for "List View" mode
function ListViewCard({ listing, onViewDetails }: { listing: Listing, onViewDetails: (l: Listing) => void }) {
   const imageUrl = listing.images?.[0] || 'https://images.unsplash.com/photo-1557821552-17105176677c?w=500';
   
   return (
      <div className="glass p-4 rounded-xl border border-white/5 hover:border-emerald-500/30 transition-all flex gap-6 items-center group cursor-pointer" onClick={() => onViewDetails(listing)}>
         <div className="h-24 w-32 flex-shrink-0 rounded-lg overflow-hidden bg-slate-900">
            <img src={imageUrl} alt={listing.title} className="w-full h-full object-cover group-hover:scale-110 transition-transform duration-500" />
         </div>
         <div className="flex-1 min-w-0">
            <div className="flex justify-between items-start">
               <div>
                  <h3 className="text-lg font-bold text-white truncate group-hover:text-emerald-400 transition-colors">{listing.title}</h3>
                  <div className="flex items-center gap-2 text-sm text-slate-500 mt-1">
                     <span className="px-2 py-0.5 rounded bg-white/5 border border-white/10 text-xs">{listing.category}</span>
                     <span></span>
                     <span className="flex items-center gap-1"><MapPin className="w-3 h-3" /> {listing.location || 'Remote'}</span>
                  </div>
               </div>
               <div className="text-right">
                  <div className="text-xl font-bold text-amber-400">{listing.price_bc} BC</div>
                  {listing.verified && <div className="text-xs text-emerald-500 font-medium flex items-center justify-end gap-1"><CheckCircle className="w-3 h-3" /> Verified</div>}
               </div>
            </div>
            <p className="text-sm text-slate-400 mt-2 line-clamp-1">{listing.description}</p>
         </div>
      </div>
   );
}

================================================
FILE: D:\barter_verse\frontend\src\pages\Governance.tsx
================================================
import { useState } from 'react';
import { Button } from '@/components/ui/button';
import { Progress } from '@/components/ui/progress';
import { Badge } from '@/components/ui/badge';
import { 
  Vote, Users, TrendingUp, AlertCircle, Check, X, 
  FileText, ArrowRight, MessageSquare 
} from 'lucide-react';
import { toast } from 'sonner';

export default function Governance() {
  return (
    <div className="min-h-screen py-12 px-4 sm:px-6 lg:px-8 bg-[#020617] relative">
       {/* Background Ambience */}
       <div className="absolute top-0 right-0 w-[600px] h-[600px] bg-purple-500/5 rounded-full blur-[120px] -z-10" />

       <div className="max-w-6xl mx-auto space-y-10">
          
          {/* Header */}
          <div className="flex flex-col md:flex-row justify-between items-end gap-6 animate-fade-in-up">
             <div>
                <div className="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-purple-500/10 border border-purple-500/20 text-purple-400 text-xs font-bold uppercase tracking-wider mb-4">
                   <Vote className="w-3 h-3" /> Community DAO
                </div>
                <h1 className="text-4xl font-extrabold text-white mb-2">Governance Console</h1>
                <p className="text-slate-400 max-w-2xl">
                   Shape the future of the BarterVerse. Your coins give you voting power to decide on platform fees, new features, and community rules.
                </p>
             </div>
             <div className="flex gap-4">
                <StatsCard label="Active Voters" value="1,204" icon={<Users className="w-4 h-4 text-blue-400" />} />
                <StatsCard label="Treasury" value="45k BC" icon={<TrendingUp className="w-4 h-4 text-emerald-400" />} />
             </div>
          </div>

          {/* Active Proposals Grid */}
          <div className="grid md:grid-cols-2 gap-6 animate-fade-in-up [animation-delay:200ms] opacity-0" style={{ animationFillMode: 'forwards' }}>
             
             {/* Featured Proposal */}
             <div className="md:col-span-2 glass p-8 rounded-3xl border border-purple-500/30 relative overflow-hidden group">
                <div className="absolute top-0 right-0 p-4 bg-purple-500 text-white text-xs font-bold rounded-bl-2xl">
                   ENDING SOON
                </div>
                <div className="flex flex-col md:flex-row gap-8">
                   <div className="flex-1 space-y-4">
                      <div className="flex items-center gap-2 text-slate-400 text-sm">
                         <span>Proposal #104</span>
                         <span></span>
                         <span className="text-purple-400">Core Protocol</span>
                      </div>
                      <h2 className="text-2xl font-bold text-white">Reduce Listing Fee to 5 BC</h2>
                      <p className="text-slate-300 leading-relaxed">
                         To encourage more new users to join, we propose lowering the standard listing fee from 10 BC to 5 BC for the next 3 months. This will be subsidized by the Community Treasury.
                      </p>
                      
                      <div className="space-y-2 pt-2">
                         <div className="flex justify-between text-sm font-medium">
                            <span className="text-emerald-400">Yes (68%)</span>
                            <span className="text-red-400">No (32%)</span>
                         </div>
                         <Progress value={68} className="h-4 bg-slate-900" indicatorClassName="bg-gradient-to-r from-emerald-500 to-emerald-400" />
                         <div className="text-xs text-slate-500 text-right">1,402 Votes Cast</div>
                      </div>

                      <div className="flex gap-3 pt-4">
                         <VoteButton type="yes" label="Vote YES" />
                         <VoteButton type="no" label="Vote NO" />
                         <Button variant="outline" className="ml-auto border-slate-700 text-slate-300">
                            <MessageSquare className="w-4 h-4 mr-2" /> Discuss
                         </Button>
                      </div>
                   </div>
                   
                   {/* Visual / Icon */}
                   <div className="hidden md:flex flex-col items-center justify-center w-48 border-l border-white/5 pl-8">
                      <div className="w-24 h-24 rounded-full bg-slate-900 border-4 border-slate-800 flex items-center justify-center mb-4 group-hover:scale-110 transition-transform">
                         <FileText className="w-10 h-10 text-purple-400" />
                      </div>
                      <div className="text-center">
                         <div className="text-sm font-bold text-white">By @AlexAdmin</div>
                         <div className="text-xs text-slate-500">Core Team</div>
                      </div>
                   </div>
                </div>
             </div>

             {/* Secondary Proposals */}
             <ProposalCard 
                id="#105"
                title="Add 'Vehicle' Category"
                desc="Should we add a dedicated category for vehicle rentals and swaps?"
                status="Active"
                yesPercent={92}
             />
             <ProposalCard 
                id="#106"
                title="Increase Escrow Time"
                desc="Extend the auto-release timer from 3 days to 5 days."
                status="Review"
                yesPercent={45}
             />
          </div>

          {/* Past Decisions */}
          <div className="space-y-4">
             <h3 className="text-xl font-bold text-white">Recent Decisions</h3>
             <div className="glass rounded-xl overflow-hidden border border-white/5">
                {[
                   { id: 103, title: "Enable Dark Mode by Default", result: "Passed", date: "Oct 12" },
                   { id: 102, title: "Allow Anonymous Trading", result: "Rejected", date: "Sep 28" },
                   { id: 101, title: "Launch Mobile App Beta", result: "Passed", date: "Sep 15" },
                ].map((item, i) => (
                   <div key={i} className="flex items-center justify-between p-4 border-b border-white/5 last:border-0 hover:bg-white/5 transition-colors">
                      <div className="flex items-center gap-4">
                         <div className={`p-2 rounded-lg ${item.result === 'Passed' ? 'bg-emerald-500/10 text-emerald-400' : 'bg-red-500/10 text-red-400'}`}>
                            {item.result === 'Passed' ? <Check className="w-4 h-4" /> : <X className="w-4 h-4" />}
                         </div>
                         <span className="font-medium text-slate-200">{item.title}</span>
                      </div>
                      <div className="flex items-center gap-4 text-sm text-slate-500">
                         <span>{item.date}</span>
                         <ArrowRight className="w-4 h-4" />
                      </div>
                   </div>
                ))}
             </div>
          </div>

       </div>
    </div>
  );
}

// Sub-components
function StatsCard({ label, value, icon }: any) {
   return (
      <div className="glass px-5 py-3 rounded-xl border border-white/5 flex items-center gap-3">
         <div className="p-2 bg-slate-800 rounded-lg">{icon}</div>
         <div>
            <div className="text-xs text-slate-500 uppercase font-bold">{label}</div>
            <div className="text-lg font-bold text-white">{value}</div>
         </div>
      </div>
   );
}

function ProposalCard({ id, title, desc, status, yesPercent }: any) {
   return (
      <div className="glass p-6 rounded-3xl border border-white/5 hover:border-purple-500/30 transition-all flex flex-col justify-between">
         <div className="space-y-3">
            <div className="flex justify-between items-start">
               <Badge variant="outline" className="bg-slate-900 text-slate-400 border-slate-700">{id}</Badge>
               <Badge className={`${status === 'Active' ? 'bg-emerald-500' : 'bg-amber-500'}`}>{status}</Badge>
            </div>
            <h3 className="text-xl font-bold text-white">{title}</h3>
            <p className="text-sm text-slate-400">{desc}</p>
         </div>
         
         <div className="pt-6 space-y-3">
            <div className="flex justify-between text-xs font-bold text-slate-300">
               <span>Approval Rating</span>
               <span>{yesPercent}%</span>
            </div>
            <Progress value={yesPercent} className="h-2 bg-slate-900" />
            <Button variant="outline" className="w-full border-slate-700 text-slate-300 hover:text-white mt-2">
               View Details
            </Button>
         </div>
      </div>
   );
}

function VoteButton({ type, label }: { type: 'yes' | 'no', label: string }) {
   const [voted, setVoted] = useState(false);
   
   const handleVote = () => {
      setVoted(true);
      toast.success(`You voted ${type.toUpperCase()}!`);
   };

   return (
      <Button 
         onClick={handleVote}
         disabled={voted}
         className={`min-w-[120px] font-bold ${
            type === 'yes' 
            ? 'bg-emerald-600 hover:bg-emerald-500 text-white' 
            : 'bg-transparent border border-red-900/50 text-red-400 hover:bg-red-900/20'
         }`}
      >
         {voted ? <Check className="w-4 h-4 mr-2" /> : null}
         {voted ? 'Voted' : label}
      </Button>
   );
}

================================================
FILE: D:\barter_verse\frontend\src\pages\Home.tsx
================================================
import { Button } from '@/components/ui/button';
import { 
  ArrowRight, Coins, Globe, Handshake, Zap, ShieldCheck, 
  CheckCircle, ArrowLeftRight, Users, Repeat, GraduationCap, 
  Briefcase, Heart, Sprout
} from 'lucide-react';
import { Link } from 'react-router-dom';

export default function Home() {
  return (
    <div className="relative min-h-screen overflow-hidden bg-[#020617] selection:bg-emerald-500/30">
      
      {/* Deep Space Background Ambience */}
      <div className="absolute top-0 left-0 w-full h-full overflow-hidden -z-10 pointer-events-none">
        <div className="absolute top-[-10%] left-[20%] w-[500px] h-[500px] bg-purple-500/10 rounded-full mix-blend-screen filter blur-[100px] opacity-30 animate-blob" />
        <div className="absolute top-[40%] right-[10%] w-[400px] h-[400px] bg-emerald-500/10 rounded-full mix-blend-screen filter blur-[100px] opacity-30 animate-blob animation-delay-2000" />
        <div className="absolute bottom-[-10%] left-[10%] w-[600px] h-[600px] bg-blue-500/10 rounded-full mix-blend-screen filter blur-[100px] opacity-30 animate-blob animation-delay-4000" />
      </div>

      {/* Hero Section: The Manifesto */}
      <section className="relative pt-32 pb-20 lg:pt-48 lg:pb-32">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
          
          <div className="inline-flex items-center gap-2 px-4 py-2 rounded-full bg-slate-900/80 border border-slate-700/50 backdrop-blur-md mb-8 animate-fade-in-up shadow-xl shadow-emerald-900/10">
            <span className="relative flex h-2 w-2">
              <span className="animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"></span>
              <span className="relative inline-flex rounded-full h-2 w-2 bg-emerald-500"></span>
            </span>
            <span className="text-xs font-bold text-slate-300 tracking-widest uppercase">Beyond The Cash Economy</span>
          </div>
          
          <h1 className="text-5xl md:text-7xl lg:text-8xl font-extrabold tracking-tight mb-8 leading-[1.1] animate-fade-in-up [animation-delay:200ms] opacity-0">
            <span className="text-white">A Parallel</span><br />
            <span className="bg-clip-text text-transparent bg-gradient-to-r from-emerald-400 via-cyan-200 to-emerald-400 bg-[length:200%_auto] animate-shimmer">
              Micro-Economy.
            </span>
          </h1>
          
          <p className="text-lg md:text-2xl text-slate-400 max-w-3xl mx-auto mb-12 leading-relaxed animate-fade-in-up [animation-delay:400ms] opacity-0 font-light">
            We are building a world where <span className="text-emerald-400 font-medium">trust</span>, <span className="text-emerald-400 font-medium">skills</span>, and <span className="text-emerald-400 font-medium">utility</span> replace cash. 
            Connect with your local community to exchange what you have for what you need.
          </p>
          
          <div className="flex flex-col sm:flex-row justify-center gap-5 mb-24 animate-fade-in-up [animation-delay:600ms] opacity-0">
            <Link to="/explore">
              <Button size="lg" className="h-16 px-10 text-lg rounded-full bg-emerald-600 hover:bg-emerald-500 text-white shadow-lg shadow-emerald-500/25 transition-all duration-300 hover:scale-105">
                Join the Ecosystem
                <ArrowRight className="ml-2 w-5 h-5" />
              </Button>
            </Link>
            <Link to="/about">
              <Button size="lg" variant="outline" className="h-16 px-10 text-lg rounded-full border-slate-700 bg-slate-900/40 text-slate-200 hover:bg-slate-800 hover:text-white transition-all duration-300">
                How It Works
              </Button>
            </Link>
          </div>
        </div>
      </section>

      {/* The Ecosystem Logic (3 Models) */}
      <section className="py-24 relative border-y border-white/5 bg-slate-900/20 backdrop-blur-sm">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <div className="text-center mb-16">
            <h2 className="text-3xl font-bold text-white mb-4">Multiple Ways to Exchange</h2>
            <p className="text-slate-400 max-w-2xl mx-auto">
              Money-centric platforms fail when you have skills but no income. Barter Verse bridges that gap with three distinct exchange models.
            </p>
          </div>

          <div className="grid md:grid-cols-3 gap-8">
            <ModelCard 
              icon={<Repeat className="w-8 h-8 text-blue-400" />}
              title="Direct Barter"
              subtitle="I give X, You give Y"
              description="The classic swap. Exchange a laptop repair for graphic design, or a textbook for a guitar. Simple, direct, and cash-free."
              delay="0ms"
            />
            <ModelCard 
              icon={<Coins className="w-8 h-8 text-amber-400" />}
              title="Barter Coins"
              subtitle="Internal Credit Ledger"
              description="Earn coins by offering value now, spend them later. It prevents deadlocks and keeps the economy flowing. Not crypto, just credit."
              delay="100ms"
            />
            <ModelCard 
              icon={<ArrowLeftRight className="w-8 h-8 text-emerald-400" />}
              title="Multi-Hop Exchange"
              subtitle="A  B  C  A"
              description="Our future engine will connect the dots. You teach Math to B, B designs for C, and C fixes your phone. Everyone wins."
              delay="200ms"
            />
          </div>
        </div>
      </section>

      {/* Target Audience / Use Cases */}
      <section className="py-32 relative">
         <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div className="grid lg:grid-cols-2 gap-16 items-center">
               <div className="space-y-8 relative z-10">
                  <h2 className="text-4xl md:text-5xl font-extrabold text-white leading-tight">
                     Built for the <br/>
                     <span className="text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-pink-400">Value Creators.</span>
                  </h2>
                  <p className="text-lg text-slate-400 leading-relaxed">
                     This isn't for everyone. It's for those who understand that value isn't just a number in a bank account.
                  </p>
                  
                  <div className="space-y-6">
                     <AudienceItem 
                        icon={<GraduationCap className="w-6 h-6 text-emerald-400" />}
                        title="Students"
                        desc="Exchange notes, tutoring, and tech help without spending your allowance."
                     />
                     <AudienceItem 
                        icon={<Briefcase className="w-6 h-6 text-blue-400" />}
                        title="Freelancers & Creators"
                        desc="Trade your professional skills for services you need, instead of underpricing your work."
                     />
                     <AudienceItem 
                        icon={<Sprout className="w-6 h-6 text-green-400" />}
                        title="Local Communities"
                        desc="Strengthen neighborhood bonds by circulating goods and help locally."
                     />
                  </div>
               </div>

               {/* Visual Representation */}
               <div className="relative group">
                  <div className="absolute inset-0 bg-gradient-to-r from-purple-500/20 to-blue-500/20 rounded-3xl blur-3xl -z-10 group-hover:blur-[80px] transition-all duration-700" />
                  <div className="glass rounded-3xl p-8 border border-white/10 relative overflow-hidden">
                     <div className="absolute inset-0 bg-[url('https://images.unsplash.com/photo-1522071820081-009f0129c71c?q=80&w=2670&auto=format&fit=crop')] bg-cover bg-center opacity-30 mix-blend-overlay" />
                     <div className="relative z-10 space-y-6">
                        <div className="flex justify-between items-center border-b border-white/10 pb-4">
                           <div>
                              <div className="text-xs text-emerald-400 font-bold uppercase tracking-wider">Recent Activity</div>
                              <div className="text-xl font-bold text-white">Campus Hub</div>
                           </div>
                           <Globe className="w-8 h-8 text-slate-500" />
                        </div>
                        <div className="space-y-4">
                           <TradeRow user="Alex" action="taught Python to" target="Sarah" value="Skill Swap" />
                           <TradeRow user="Sarah" action="gave a Monitor to" target="Mike" value="450 BC" />
                           <TradeRow user="Mike" action="fixed Bike for" target="Alex" value="Service" />
                        </div>
                        <div className="pt-4">
                           <div className="text-center text-sm text-slate-400">
                              <span className="text-white font-bold">142</span> trades in your area this week
                           </div>
                        </div>
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </section>

      {/* Trust & Safety Features */}
      <section className="py-24 relative bg-slate-900/30">
         <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div className="text-center mb-16">
               <h2 className="text-3xl font-bold text-white">The Trust Layer</h2>
               <p className="text-slate-400 mt-2">Unlike messy forums, we provide the infrastructure for safety.</p>
            </div>
            
            <div className="grid md:grid-cols-4 gap-6">
               <FeaturePill icon={<ShieldCheck className="w-5 h-5" />} title="Verified Users" />
               <FeaturePill icon={<Heart className="w-5 h-5" />} title="Reputation Score" />
               <FeaturePill icon={<Handshake className="w-5 h-5" />} title="Escrow Protocol" />
               <FeaturePill icon={<Users className="w-5 h-5" />} title="Dispute Resolution" />
            </div>
         </div>
      </section>

      {/* Final Call to Action */}
      <section className="py-32 relative overflow-hidden">
        <div className="absolute inset-0 bg-gradient-to-b from-[#020617] to-emerald-950/30 -z-10" />
        <div className="absolute bottom-0 left-1/2 -translate-x-1/2 w-[800px] h-[400px] bg-emerald-500/20 blur-[150px] rounded-full -z-10 pointer-events-none" />

        <div className="max-w-4xl mx-auto px-4 text-center space-y-8">
          <h2 className="text-4xl md:text-6xl font-extrabold text-white tracking-tight">
            Stop Buying.<br/>
            <span className="text-transparent bg-clip-text bg-gradient-to-r from-emerald-400 to-cyan-400">Start Bartering.</span>
          </h2>
          <p className="text-xl text-slate-400 font-light max-w-2xl mx-auto">
             Your skills and unused items are currency. Unlock their value in the Barter Verse today.
          </p>
          <div className="pt-8">
            <Link to="/auth">
              <Button size="lg" className="h-16 px-12 text-lg font-bold btn-primary rounded-full shadow-2xl shadow-emerald-500/30 hover:scale-105 transition-transform duration-300">
                Join the Revolution
              </Button>
            </Link>
          </div>
        </div>
      </section>
    </div>
  );
}

// --- Sub-components for Cleaner Code ---

function ModelCard({ icon, title, subtitle, description, delay }: { icon: React.ReactNode, title: string, subtitle: string, description: string, delay: string }) {
   return (
      <div 
         className="glass p-8 rounded-3xl border border-white/5 hover:border-emerald-500/30 transition-all duration-500 group animate-fade-in-up opacity-0 hover:-translate-y-2"
         style={{ animationDelay: delay, animationFillMode: 'forwards' }}
      >
         <div className="mb-6 p-4 bg-slate-950/50 rounded-2xl inline-block border border-white/5 group-hover:scale-110 transition-transform duration-500 shadow-lg">
            {icon}
         </div>
         <h3 className="text-2xl font-bold text-white mb-1">{title}</h3>
         <div className="text-emerald-400 text-sm font-mono mb-4">{subtitle}</div>
         <p className="text-slate-400 leading-relaxed text-sm">
            {description}
         </p>
      </div>
   );
}

function AudienceItem({ icon, title, desc }: { icon: React.ReactNode, title: string, desc: string }) {
   return (
      <div className="flex gap-4 items-start p-4 rounded-xl hover:bg-white/5 transition-colors duration-300 border border-transparent hover:border-white/5">
         <div className="p-3 bg-slate-900 rounded-xl border border-slate-700 flex-shrink-0">
            {icon}
         </div>
         <div>
            <h4 className="text-lg font-bold text-slate-200">{title}</h4>
            <p className="text-slate-400 text-sm leading-relaxed mt-1">{desc}</p>
         </div>
      </div>
   );
}

function TradeRow({ user, action, target, value }: { user: string, action: string, target: string, value: string }) {
   return (
      <div className="flex items-center justify-between p-3 bg-slate-950/40 rounded-xl border border-white/5">
         <div className="flex items-center gap-2 text-sm text-slate-300">
            <span className="font-bold text-white">{user}</span>
            <span className="text-slate-500 text-xs">{action}</span>
            <span className="font-bold text-white">{target}</span>
         </div>
         <div className="text-xs font-bold text-emerald-400 bg-emerald-500/10 px-2 py-1 rounded">{value}</div>
      </div>
   );
}

function FeaturePill({ icon, title }: { icon: React.ReactNode, title: string }) {
   return (
      <div className="flex items-center justify-center gap-3 p-4 rounded-xl bg-slate-900 border border-slate-800 text-slate-300 hover:text-white hover:border-emerald-500/30 transition-all cursor-default">
         {icon}
         <span className="font-semibold">{title}</span>
      </div>
   );
}

================================================
FILE: D:\barter_verse\frontend\src\pages\Index.tsx
================================================
// Update this page (the content is just a fallback if you fail to update the page)

const Index = () => {
  return (
    <div className="flex min-h-screen items-center justify-center bg-background">
      <div className="text-center">
        <h1 className="mb-4 text-4xl font-bold">Welcome to Your Blank App</h1>
        <p className="text-xl text-muted-foreground">Start building your amazing project here!</p>
      </div>
    </div>
  );
};

export default Index;


================================================
FILE: D:\barter_verse\frontend\src\pages\Messages.tsx
================================================
import { useState } from 'react';
import { Search, Send, MoreVertical, Phone, Video, Image as ImageIcon, Paperclip } from 'lucide-react';
import { Avatar, AvatarFallback, AvatarImage } from '@/components/ui/avatar';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { ScrollArea } from '@/components/ui/scroll-area';

// Mock Data for Chats
const CHATS = [
  {
    id: 1,
    user: "Alex Trader",
    avatar: "", 
    status: "online",
    lastMessage: "Is the vintage camera still available?",
    time: "2m ago",
    unread: 2,
    messages: [
      { id: 1, sender: "them", content: "Hi! I saw your listing.", time: "10:30 AM" },
      { id: 2, sender: "me", content: "Hey Alex! Yes, the camera is available.", time: "10:32 AM" },
      { id: 3, sender: "them", content: "Great! Would you accept 450 BC for it?", time: "10:33 AM" },
      { id: 4, sender: "them", content: "I can also throw in a tripod.", time: "10:34 AM" }
    ]
  },
  {
    id: 2,
    user: "Sarah Green",
    avatar: "",
    status: "offline",
    lastMessage: "Thanks for the trade!",
    time: "1d ago",
    unread: 0,
    messages: [
      { id: 1, sender: "me", content: "I've sent the seeds.", time: "Yesterday" },
      { id: 2, sender: "them", content: "Received them! Thanks for the trade!", time: "Yesterday" }
    ]
  }
];

export default function Messages() {
  const [selectedChat, setSelectedChat] = useState(CHATS[0]);
  const [newMessage, setNewMessage] = useState("");

  const handleSend = () => {
    if (!newMessage.trim()) return;
    
    // In a real app, you'd send this to the backend
    const msg = {
      id: Date.now(),
      sender: "me",
      content: newMessage,
      time: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })
    };
    
    // Optimistically update UI (Mock)
    const updatedChat = { ...selectedChat, messages: [...selectedChat.messages, msg] };
    setSelectedChat(updatedChat);
    setNewMessage("");
  };

  return (
    <div className="h-[calc(100vh-64px)] bg-[#020617] flex overflow-hidden">
      
      {/* Sidebar - Chat List */}
      <div className="w-80 border-r border-white/5 bg-slate-950/50 flex flex-col">
        <div className="p-4 border-b border-white/5">
          <h2 className="text-xl font-bold text-white mb-4">Messages</h2>
          <div className="relative">
            <Search className="absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-500" />
            <Input 
              placeholder="Search chats..." 
              className="pl-9 bg-slate-900 border-slate-800 text-white focus:ring-emerald-500/20" 
            />
          </div>
        </div>
        
        <ScrollArea className="flex-1">
          <div className="p-2 space-y-1">
            {CHATS.map(chat => (
              <button
                key={chat.id}
                onClick={() => setSelectedChat(chat)}
                className={`w-full flex items-center gap-3 p-3 rounded-xl transition-all ${
                  selectedChat.id === chat.id 
                    ? 'bg-emerald-500/10 border border-emerald-500/20' 
                    : 'hover:bg-white/5 border border-transparent'
                }`}
              >
                <div className="relative">
                  <Avatar>
                    <AvatarImage src={chat.avatar} />
                    <AvatarFallback className="bg-slate-800 text-slate-300">{chat.user[0]}</AvatarFallback>
                  </Avatar>
                  {chat.status === 'online' && (
                    <span className="absolute bottom-0 right-0 w-3 h-3 bg-emerald-500 border-2 border-[#020617] rounded-full"></span>
                  )}
                </div>
                
                <div className="flex-1 text-left overflow-hidden">
                  <div className="flex justify-between items-center mb-0.5">
                    <span className={`font-medium ${selectedChat.id === chat.id ? 'text-emerald-400' : 'text-slate-200'}`}>
                      {chat.user}
                    </span>
                    <span className="text-[10px] text-slate-500">{chat.time}</span>
                  </div>
                  <p className="text-xs text-slate-400 truncate">{chat.lastMessage}</p>
                </div>
                
                {chat.unread > 0 && (
                  <div className="bg-emerald-500 text-black text-[10px] font-bold px-1.5 py-0.5 rounded-full min-w-[1.25rem] text-center">
                    {chat.unread}
                  </div>
                )}
              </button>
            ))}
          </div>
        </ScrollArea>
      </div>

      {/* Main Chat Area */}
      <div className="flex-1 flex flex-col bg-[url('/bg-pattern.svg')] bg-opacity-5">
        
        {/* Chat Header */}
        <div className="h-16 border-b border-white/5 bg-slate-950/80 backdrop-blur-md flex items-center justify-between px-6">
          <div className="flex items-center gap-3">
            <Avatar>
              <AvatarImage src={selectedChat.avatar} />
              <AvatarFallback className="bg-emerald-900 text-emerald-200">{selectedChat.user[0]}</AvatarFallback>
            </Avatar>
            <div>
              <h3 className="font-bold text-white">{selectedChat.user}</h3>
              <p className="text-xs text-emerald-400 flex items-center gap-1">
                {selectedChat.status === 'online' ? 'Online' : 'Last seen recently'}
              </p>
            </div>
          </div>
          
          <div className="flex items-center gap-2">
            <Button variant="ghost" size="icon" className="text-slate-400 hover:text-white hover:bg-white/5">
              <Phone className="w-5 h-5" />
            </Button>
            <Button variant="ghost" size="icon" className="text-slate-400 hover:text-white hover:bg-white/5">
              <Video className="w-5 h-5" />
            </Button>
            <Button variant="ghost" size="icon" className="text-slate-400 hover:text-white hover:bg-white/5">
              <MoreVertical className="w-5 h-5" />
            </Button>
          </div>
        </div>

        {/* Messages Feed */}
        <ScrollArea className="flex-1 p-6">
          <div className="space-y-6">
            {selectedChat.messages.map((msg) => (
              <div 
                key={msg.id} 
                className={`flex ${msg.sender === 'me' ? 'justify-end' : 'justify-start'}`}
              >
                <div className={`max-w-[70%] rounded-2xl p-4 ${
                  msg.sender === 'me' 
                    ? 'bg-emerald-600 text-white rounded-tr-none' 
                    : 'bg-slate-800 text-slate-200 rounded-tl-none'
                }`}>
                  <p className="text-sm">{msg.content}</p>
                  <p className={`text-[10px] mt-1 text-right ${msg.sender === 'me' ? 'text-emerald-200' : 'text-slate-500'}`}>
                    {msg.time}
                  </p>
                </div>
              </div>
            ))}
          </div>
        </ScrollArea>

        {/* Input Area */}
        <div className="p-4 bg-slate-950 border-t border-white/5">
          <div className="flex items-center gap-2 bg-slate-900/50 p-2 rounded-xl border border-white/5">
            <Button variant="ghost" size="icon" className="text-slate-400 hover:text-white hover:bg-white/5">
              <Paperclip className="w-5 h-5" />
            </Button>
            <Button variant="ghost" size="icon" className="text-slate-400 hover:text-white hover:bg-white/5">
              <ImageIcon className="w-5 h-5" />
            </Button>
            
            <Input 
              value={newMessage}
              onChange={(e) => setNewMessage(e.target.value)}
              onKeyDown={(e) => e.key === 'Enter' && handleSend()}
              placeholder="Type a message..." 
              className="flex-1 bg-transparent border-none focus-visible:ring-0 text-white placeholder:text-slate-500"
            />
            
            <Button 
              onClick={handleSend} 
              disabled={!newMessage.trim()}
              className="bg-emerald-600 hover:bg-emerald-500 text-white rounded-lg w-10 h-10 p-0"
            >
              <Send className="w-5 h-5" />
            </Button>
          </div>
        </div>

      </div>
    </div>
  );
}

================================================
FILE: D:\barter_verse\frontend\src\pages\NotFound.tsx
================================================
import { useLocation } from "react-router-dom";
import { useEffect } from "react";

const NotFound = () => {
  const location = useLocation();

  useEffect(() => {
    console.error("404 Error: User attempted to access non-existent route:", location.pathname);
  }, [location.pathname]);

  return (
    <div className="flex min-h-screen items-center justify-center bg-background">
      <div className="text-center space-y-4">
        <h1 className="text-4xl font-bold text-primary">404</h1>
        <p className="text-xl text-muted-foreground">Oops! Page not found</p>
        <a href="/" className="inline-block text-primary underline hover:text-brand-green-dark transition-colors">
          Return to Home
        </a>
      </div>
    </div>
  );
};

export default NotFound;


================================================
FILE: D:\barter_verse\frontend\src\pages\PostListing.tsx
================================================
import { useState, useEffect } from 'react';
import { useNavigate, useSearchParams } from 'react-router-dom'; // Added useSearchParams
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { Label } from '@/components/ui/label';
import { Textarea } from '@/components/ui/textarea';
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';
import { useCoins } from '@/contexts/CoinContext';
import { useAuth } from '@/contexts/AuthContext';
import { api } from '@/lib/api';
import { toast } from 'sonner';
import { Loader2, LayoutGrid, MapPin, Coins, Image as ImageIcon, Sparkles, Type, ArrowRight, Save } from 'lucide-react';

export default function PostListing() {
  const navigate = useNavigate();
  const [searchParams] = useSearchParams();
  const editId = searchParams.get('edit'); // Get ID from URL
  
  const { balance, spendCoins } = useCoins();
  const { user, isAuthenticated } = useAuth();
  const [isSubmitting, setIsSubmitting] = useState(false);
  const [isLoadingData, setIsLoadingData] = useState(false);

  const [formData, setFormData] = useState({
    title: '',
    category: '',
    location: '',
    coins: '',
    description: '',
    image: '',
  });

  const LISTING_COST = 10;

  // --- NEW: Fetch Data if Editing ---
  useEffect(() => {
    if (editId && isAuthenticated) {
      setIsLoadingData(true);
      api.getListingById(editId)
        .then((response: any) => {
          const data = response.data.data || response.data; // Handle API wrapper
          setFormData({
            title: data.title,
            category: data.category,
            location: data.location,
            coins: data.price_bc.toString(),
            description: data.description,
            image: data.images?.[0] || '', // Handle image array
          });
        })
        .catch(() => {
          toast.error("Could not load listing details");
          navigate('/post'); // Fallback to create mode
        })
        .finally(() => setIsLoadingData(false));
    }
  }, [editId, isAuthenticated, navigate]);

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    
    if (!isAuthenticated || !user) {
      toast.error('Please login to continue');
      navigate('/auth');
      return;
    }

    if (!formData.title || !formData.category || !formData.coins) {
      toast.error('Please fill in all required fields');
      return;
    }

    const coins = parseInt(formData.coins);
    if (isNaN(coins) || coins < 1) {
      toast.error('Please enter a valid coin value');
      return;
    }

    // Only check balance if creating a NEW listing
    if (!editId && balance < LISTING_COST) {
      toast.error(`Insufficient coins! You need ${LISTING_COST} BC.`);
      return;
    }

    setIsSubmitting(true);

    try {
      const payload = {
        title: formData.title,
        category: formData.category,
        description: formData.description,
        price_bc: coins,
        location: formData.location || 'Remote',
        images: formData.image ? [formData.image] : [],
        ownerId: user.id,
        status: 'ACTIVE',
      };

      if (editId) {
        // --- UPDATE MODE ---
        await api.updateListing(editId, payload);
        toast.success('Listing updated successfully!');
        navigate('/profile'); // Go back to profile after edit
      } else {
        // --- CREATE MODE ---
        await api.createListing(payload);
        await spendCoins(LISTING_COST, 'listing_posted');
        toast.success(`Listing posted! ${LISTING_COST} BC deducted.`);
        navigate('/explore');
      }

    } catch (error) {
      console.error('Error submitting listing:', error);
      toast.error(error instanceof Error ? error.message : 'Failed to submit');
    } finally {
      setIsSubmitting(false);
    }
  };

  if (isLoadingData) {
    return (
        <div className="min-h-screen bg-[#020617] flex items-center justify-center">
            <Loader2 className="w-8 h-8 text-emerald-500 animate-spin" />
        </div>
    );
  }

  return (
    <div className="min-h-screen py-16 px-4 sm:px-6 lg:px-8 relative overflow-hidden bg-[#020617]">
      {/* Animated Background */}
      <div className="absolute top-0 left-0 w-full h-full overflow-hidden -z-10 pointer-events-none">
        <div className="absolute top-[-10%] left-[-10%] w-[600px] h-[600px] bg-purple-500/10 rounded-full mix-blend-multiply filter blur-3xl opacity-30 animate-blob" />
        <div className="absolute bottom-[-10%] right-[-10%] w-[600px] h-[600px] bg-emerald-500/10 rounded-full mix-blend-multiply filter blur-3xl opacity-30 animate-blob animation-delay-2000" />
      </div>

      <div className="max-w-3xl mx-auto space-y-10">
        
        {/* Header */}
        <div className="text-center space-y-4 animate-fade-in-up">
          <div className="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-slate-800/50 border border-slate-700 text-slate-300 text-sm font-medium">
            <Sparkles className="w-4 h-4 text-emerald-400" />
            <span>{editId ? 'Editor Studio' : 'Creation Studio'}</span>
          </div>
          <h1 className="text-4xl md:text-5xl font-extrabold text-white tracking-tight">
            {editId ? 'Edit Your ' : 'Create a New '} 
            <span className="text-transparent bg-clip-text bg-gradient-to-r from-emerald-400 to-cyan-400">Opportunity</span>
          </h1>
          <p className="text-lg text-slate-400 max-w-lg mx-auto">
            {editId ? 'Update details to attract more traders.' : 'Turn your skills, items, or services into Barter Coins.'}
          </p>
        </div>

        {/* Form Card */}
        <div className="glass rounded-3xl p-8 md:p-12 border border-white/10 shadow-2xl relative animate-fade-in-up [animation-delay:200ms]">
          
          {/* Progress Indicator */}
          <div className="absolute top-0 left-0 w-full h-1 bg-slate-800 rounded-t-3xl overflow-hidden">
             <div className="h-full bg-emerald-500 w-1/3" />
          </div>

          <form onSubmit={handleSubmit} className="space-y-8">
            
            {/* Main Details */}
            <div className="space-y-6">
               <div className="space-y-2">
                  <Label className="text-xs font-bold text-emerald-400 uppercase tracking-wider ml-1">What are you offering?</Label>
                  <div className="relative group">
                    <Type className="absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-500 group-focus-within:text-emerald-400 transition-colors" />
                    <Input
                      placeholder="e.g., Vintage Film Camera or Python Tutoring"
                      value={formData.title}
                      onChange={(e) => setFormData({ ...formData, title: e.target.value })}
                      className="pl-12 h-14 bg-slate-950/50 border-slate-800 text-white placeholder:text-slate-600 focus:ring-emerald-500/50 focus:border-emerald-500/50 rounded-xl text-lg transition-all"
                    />
                  </div>
               </div>

               <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                  <div className="space-y-2">
                    <Label className="text-xs font-bold text-slate-500 uppercase tracking-wider ml-1">Category</Label>
                    <div className="relative group">
                       <div className="absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-500 z-10 pointer-events-none group-focus-within:text-emerald-400 transition-colors">
                         <LayoutGrid className="w-full h-full" />
                       </div>
                       <Select value={formData.category} onValueChange={(value) => setFormData({ ...formData, category: value })}>
                        <SelectTrigger className="pl-12 h-12 bg-slate-950/50 border-slate-800 text-slate-200 rounded-xl focus:ring-emerald-500/50">
                          <SelectValue placeholder="Select category" />
                        </SelectTrigger>
                        <SelectContent className="bg-slate-900 border-slate-800 text-slate-200">
                          <SelectItem value="Skills">Skills</SelectItem>
                          <SelectItem value="Items">Items</SelectItem>
                          <SelectItem value="Services">Services</SelectItem>
                          <SelectItem value="Transport">Transport</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                  </div>

                  <div className="space-y-2">
                    <Label className="text-xs font-bold text-slate-500 uppercase tracking-wider ml-1">Value (BC)</Label>
                    <div className="relative group">
                      <Coins className="absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-amber-500 group-focus-within:text-amber-400 transition-colors" />
                      <Input
                        type="number"
                        placeholder="e.g. 30"
                        value={formData.coins}
                        onChange={(e) => setFormData({ ...formData, coins: e.target.value })}
                        className="pl-12 h-12 bg-slate-950/50 border-slate-800 text-white placeholder:text-slate-600 focus:ring-amber-500/50 focus:border-amber-500/50 rounded-xl font-mono"
                      />
                    </div>
                  </div>
               </div>
            </div>

            {/* Rich Details */}
            <div className="space-y-6 pt-4 border-t border-white/5">
                <div className="space-y-2">
                  <Label className="text-xs font-bold text-slate-500 uppercase tracking-wider ml-1">Location</Label>
                  <div className="relative group">
                    <MapPin className="absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-500 group-focus-within:text-emerald-400 transition-colors" />
                    <Input
                      placeholder="City, Neighborhood, or 'Remote'"
                      value={formData.location}
                      onChange={(e) => setFormData({ ...formData, location: e.target.value })}
                      className="pl-12 h-12 bg-slate-950/50 border-slate-800 text-white placeholder:text-slate-600 focus:ring-emerald-500/50 rounded-xl"
                    />
                  </div>
                </div>

                <div className="space-y-2">
                  <Label className="text-xs font-bold text-slate-500 uppercase tracking-wider ml-1">Description</Label>
                  <Textarea
                    placeholder="Tell the story of your item or explain your teaching style..."
                    value={formData.description}
                    onChange={(e) => setFormData({ ...formData, description: e.target.value })}
                    rows={5}
                    className="bg-slate-900/50 border-slate-800 text-white placeholder:text-slate-600 focus:ring-emerald-500/50 rounded-xl resize-none p-4 leading-relaxed"
                  />
                </div>

                <div className="space-y-2">
                  <Label className="text-xs font-bold text-slate-500 uppercase tracking-wider ml-1">Cover Image URL</Label>
                  <div className="relative group">
                    <ImageIcon className="absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-500 group-focus-within:text-emerald-400 transition-colors" />
                    <Input
                      placeholder="Paste image URL (e.g. https://images.unsplash.com/...)"
                      value={formData.image}
                      onChange={(e) => setFormData({ ...formData, image: e.target.value })}
                      className="pl-12 h-12 bg-slate-950/50 border-slate-800 text-white placeholder:text-slate-600 focus:ring-emerald-500/50 rounded-xl"
                    />
                  </div>
                  <p className="text-xs text-slate-500 ml-1">Tip: Right-click an image online and select "Copy Image Address"</p>
                </div>
            </div>

            {/* Action Bar */}
            <div className="pt-6">
              <Button 
                type="submit" 
                size="lg" 
                className="w-full btn-primary h-14 text-lg font-bold shadow-lg shadow-emerald-500/20 hover:scale-[1.02] transition-transform duration-200"
                disabled={isSubmitting}
              >
                {isSubmitting ? (
                  <>
                    <Loader2 className="w-5 h-5 mr-2 animate-spin" />
                    {editId ? 'Updating Listing...' : 'Publishing to the Verse...'}
                  </>
                ) : (
                  <span className="flex items-center gap-2">
                    {editId ? <Save className="w-5 h-5" /> : <ArrowRight className="w-5 h-5" />}
                    {editId ? 'Save Changes' : 'Publish Listing'}
                  </span>
                )}
              </Button>
              
              {!editId && (
                <div className="flex items-center justify-center gap-2 text-sm text-slate-500 mt-4 bg-slate-900/50 py-2 rounded-lg border border-slate-800/50 w-fit mx-auto px-4">
                  <span>Cost: <span className="text-white font-bold">{LISTING_COST} BC</span></span>
                  <span className="text-slate-700">|</span>
                  <span>Your Balance: <span className={`font-bold ${balance < LISTING_COST ? 'text-red-400' : 'text-emerald-400'}`}>{balance} BC</span></span>
                </div>
              )}
            </div>
          </form>
        </div>
      </div>
    </div>
  );
}

================================================
FILE: D:\barter_verse\frontend\src\pages\Profile.tsx
================================================
import { useState, useRef, useEffect } from 'react';
import { useAuth } from '@/contexts/AuthContext';
import { useTrade } from '@/contexts/TradeContext';
import { useListings } from '@/contexts/ListingsContext'; // Import Listings Context
import { useNavigate } from 'react-router-dom';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { Textarea } from '@/components/ui/textarea';
import { Avatar, AvatarFallback, AvatarImage } from '@/components/ui/avatar';
import { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';
import { toast } from 'sonner';
import { api } from '@/lib/api';
import ListingCard from '@/components/ListingCard'; // Import ListingCard
import { 
  Loader2, Edit2, Check, X, Upload, Coins, Star, Calendar, 
  ShieldCheck, MapPin, Package, Trophy, LogOut, ArrowUpRight, ArrowDownLeft, Grid 
} from 'lucide-react';

export default function Profile() {
  const { user, isAuthenticated, signOut } = useAuth();
  const { trades, fetchTrades } = useTrade();
  const { listings, fetchListings, deleteListing } = useListings(); // Get listing functions
  
  const navigate = useNavigate();
  const [isEditing, setIsEditing] = useState(false);
  const [isLoading, setIsLoading] = useState(false);
  const fileInputRef = useRef<HTMLInputElement>(null);
  
  const [formData, setFormData] = useState({
    display_name: user?.display_name || '',
    bio: user?.bio || '',
    avatar_url: user?.avatar_url || '',
  });

  // Fetch Data on Load
  useEffect(() => {
    if (user) {
        fetchTrades();
        fetchListings(); // Fetch all listings (Context usually filters, but we filter below)
    }
  }, [user]);

  // Filter listings belonging to the current user
  const myListings = listings.filter(item => item.owner_id === user?.id || item.owner?.id === user?.id);

  if (!isAuthenticated || !user) {
    navigate('/auth');
    return null;
  }

  const getInitials = (name?: string) => {
    if (!name) return user.email[0].toUpperCase();
    return name.split(' ').map((n) => n[0]).join('').toUpperCase().slice(0, 2);
  };

  // --- Handlers ---
  const handleAvatarUpload = (e: React.ChangeEvent<HTMLInputElement>) => {
    const file = e.target.files?.[0];
    if (!file) return;
    
    // (Keep your existing image compression logic here if you want, usually handled by API in real apps)
    // For now, assuming simple read for preview
    const reader = new FileReader();
    reader.onloadend = () => {
        setFormData({ ...formData, avatar_url: reader.result as string });
    };
    reader.readAsDataURL(file);
  };

  const handleSave = async () => {
    if (!formData.display_name.trim()) return toast.error('Display name is required');
    setIsLoading(true);
    try {
      const response = await api.updateProfile(formData);
      // Ideally update AuthContext state here too
      toast.success('Profile updated successfully!');
      setIsEditing(false);
      window.location.reload(); 
    } catch (error: any) {
      toast.error(error.message || 'Failed to update');
    } finally {
      setIsLoading(false);
    }
  };

  const handleDeleteListing = async (id: string) => {
      if (confirm("Are you sure you want to delete this listing? This action cannot be undone.")) {
          try {
              await deleteListing(id); // Use context function
              toast.success("Listing deleted successfully");
          } catch (e) {
              toast.error("Failed to delete listing");
          }
      }
  };

  return (
    <div className="min-h-screen py-12 px-4 relative bg-[#020617]">
      {/* Ambience */}
      <div className="absolute top-0 left-0 w-full h-[400px] bg-gradient-to-b from-emerald-900/10 to-transparent -z-10" />
      
      <div className="max-w-5xl mx-auto space-y-8">
        
        {/* 1. Profile Header (Unchanged Logic) */}
        <div className="glass rounded-[2.5rem] p-8 md:p-10 border border-white/5 shadow-2xl relative overflow-hidden animate-fade-in-up">
           <div className="flex flex-col md:flex-row gap-8 items-start relative z-10">
              <div className="flex flex-col items-center gap-4 w-full md:w-auto">
                 <div className="relative group">
                    <Avatar className="w-32 h-32 md:w-40 md:h-40 border-4 border-[#020617] shadow-xl">
                       <AvatarImage src={formData.avatar_url || user?.avatar_url} className="object-cover" />
                       <AvatarFallback className="bg-slate-800 text-3xl font-bold text-emerald-400">
                          {getInitials(formData.display_name)}
                       </AvatarFallback>
                    </Avatar>
                    {isEditing && (
                       <button onClick={() => fileInputRef.current?.click()} className="absolute inset-0 flex items-center justify-center bg-black/60 rounded-full opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer z-10 text-white">
                          <Upload className="w-8 h-8" />
                       </button>
                    )}
                    <input ref={fileInputRef} type="file" accept="image/*" onChange={handleAvatarUpload} className="hidden" />
                 </div>
              </div>

              <div className="flex-1 w-full space-y-6">
                 {isEditing ? (
                    <div className="bg-slate-900/50 p-6 rounded-2xl border border-white/5 space-y-4">
                       <Input value={formData.display_name} onChange={(e) => setFormData({ ...formData, display_name: e.target.value })} placeholder="Display Name" className="bg-slate-950 border-slate-800 text-white" />
                       <Textarea value={formData.bio} onChange={(e) => setFormData({ ...formData, bio: e.target.value })} placeholder="Bio" className="bg-slate-950 border-slate-800 text-white" />
                       <div className="flex gap-2">
                          <Button onClick={handleSave} disabled={isLoading} className="btn-primary flex-1">Save</Button>
                          <Button onClick={() => setIsEditing(false)} variant="outline" className="flex-1">Cancel</Button>
                       </div>
                    </div>
                 ) : (
                    <div className="space-y-4">
                       <div className="flex justify-between items-start">
                          <div>
                             <h1 className="text-3xl font-bold text-white">{user.display_name}</h1>
                             <div className="flex items-center gap-4 text-slate-400 mt-1 text-sm">
                                <span className="flex items-center gap-1"><MapPin className="w-3 h-3" /> Earth</span>
                                <span className="flex items-center gap-1"><Calendar className="w-3 h-3" /> Joined 2024</span>
                             </div>
                          </div>
                          <div className="flex gap-2">
                             <Button onClick={() => setIsEditing(true)} variant="outline" size="sm" className="border-slate-700">Edit Profile</Button>
                             {signOut && <Button onClick={signOut} variant="ghost" size="icon" className="text-red-400"><LogOut className="w-4 h-4" /></Button>}
                          </div>
                       </div>
                       <p className="text-slate-300 italic">"{user.bio || "No bio yet."}"</p>
                       <div className="flex flex-wrap gap-4">
                          <StatPill icon={<Coins className="w-4 h-4 text-amber-400" />} label="Balance" value={`${user.coins || 0} BC`} />
                          <StatPill icon={<Star className="w-4 h-4 text-emerald-400" />} label="Rating" value={user.rating || "5.0"} />
                       </div>
                    </div>
                 )}
              </div>
           </div>
        </div>

        {/* 2. Tabs Section */}
        <Tabs defaultValue="inventory" className="w-full">
           <TabsList className="bg-slate-900/50 border border-slate-800 p-1 rounded-xl mb-8">
              <TabsTrigger value="inventory" className="flex-1 px-6 rounded-lg data-[state=active]:bg-emerald-600 data-[state=active]:text-white">
                 <Grid className="w-4 h-4 mr-2" /> Inventory ({myListings.length})
              </TabsTrigger>
              <TabsTrigger value="history" className="flex-1 px-6 rounded-lg data-[state=active]:bg-emerald-600 data-[state=active]:text-white">
                 <Package className="w-4 h-4 mr-2" /> History
              </TabsTrigger>
              <TabsTrigger value="achievements" className="flex-1 px-6 rounded-lg data-[state=active]:bg-emerald-600 data-[state=active]:text-white">
                 <Trophy className="w-4 h-4 mr-2" /> Badges
              </TabsTrigger>
           </TabsList>

           {/* --- INVENTORY TAB (NEW) --- */}
           <TabsContent value="inventory" className="animate-in fade-in slide-in-from-bottom-4">
              {myListings.length > 0 ? (
                 <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                    {myListings.map(item => (
                       <ListingCard 
                          key={item.id} 
                          listing={item}
                          onViewDetails={() => navigate(`/explore?id=${item.id}`)}
                          onEdit={(item) => navigate(`/post?edit=${item.id}`)} // Redirects to Post form in Edit mode
                          onDelete={handleDeleteListing} // Passes delete handler
                       />
                    ))}
                 </div>
              ) : (
                 <div className="glass p-12 text-center rounded-3xl border border-dashed border-slate-800">
                    <Package className="w-16 h-16 mx-auto text-slate-700 mb-4" />
                    <h3 className="text-xl font-bold text-slate-300">Your Inventory is Empty</h3>
                    <p className="text-slate-500 mb-6">Start listing items to trade with the community.</p>
                    <Button onClick={() => navigate('/post')} className="btn-primary">Post Item</Button>
                 </div>
              )}
           </TabsContent>

           {/* History Tab */}
           <TabsContent value="history">
              {trades.length > 0 ? (
                 <div className="grid gap-4">
                    {trades.map((trade: any) => {
                       const isIncoming = trade.responderUserId === user.id || trade.responder_id === user.id;
                       return (
                          <div key={trade.id} className="glass p-5 rounded-2xl border border-white/5 flex items-center justify-between">
                             <div className="flex items-center gap-4">
                                <div className={`p-3 rounded-full ${trade.status === 'COMPLETED' ? 'bg-emerald-500/10 text-emerald-400' : 'bg-slate-800 text-slate-400'}`}>
                                   <Package className="w-6 h-6" />
                                </div>
                                <div>
                                   <h4 className="font-bold text-white">{trade.listing?.title || 'Unknown Item'}</h4>
                                   <div className="text-xs text-slate-500 mt-1 flex gap-2">
                                      <span className="uppercase">{trade.status}</span>
                                      <span></span>
                                      <span>{new Date(trade.createdAt || trade.created_at).toLocaleDateString()}</span>
                                   </div>
                                </div>
                             </div>
                             <div className="text-right">
                                <div className="font-bold text-white">{trade.coin_amount} BC</div>
                                <div className={`text-xs ${isIncoming ? 'text-emerald-400' : 'text-slate-400'}`}>
                                   {isIncoming ? 'Received' : 'Sent'}
                                </div>
                             </div>
                          </div>
                       );
                    })}
                 </div>
              ) : (
                 <div className="text-center p-12 text-slate-500">No trades yet.</div>
              )}
           </TabsContent>

           {/* Achievements Tab */}
           <TabsContent value="achievements">
              <div className="glass p-8 rounded-3xl border border-white/5">
                 <div className="grid grid-cols-2 md:grid-cols-4 gap-6">
                    <BadgeDisplay icon="" name="Eco Starter" unlocked />
                    <BadgeDisplay icon="" name="Trusted" unlocked />
                    <BadgeDisplay icon="" name="Fast Responder" />
                    <BadgeDisplay icon="" name="Power Trader" />
                 </div>
              </div>
           </TabsContent>
        </Tabs>
      </div>
    </div>
  );
}

// Helpers
function StatPill({ icon, label, value }: any) {
   return (
      <div className="flex items-center gap-3 px-4 py-2.5 bg-slate-900/80 border border-slate-800 rounded-xl">
         {icon}
         <div className="flex flex-col leading-none">
            <span className="text-[10px] text-slate-500 uppercase font-bold mb-0.5">{label}</span>
            <span className="text-sm font-bold text-white">{value}</span>
         </div>
      </div>
   );
}

function BadgeDisplay({ icon, name, unlocked }: any) {
   return (
      <div className={`text-center p-5 rounded-2xl border ${unlocked ? 'bg-emerald-500/5 border-emerald-500/20' : 'bg-slate-900/50 border-slate-800 opacity-50'}`}>
         <div className="text-4xl mb-3">{icon}</div>
         <div className="font-bold text-sm text-slate-300">{name}</div>
      </div>
   );
}

================================================
FILE: D:\barter_verse\frontend\src\pages\Quests.tsx
================================================
import { Button } from '@/components/ui/button';
import { Progress } from '@/components/ui/progress';
import { Trophy, Swords, Star, CheckCircle, Clock, Target, Gift, Flame, Coins } from 'lucide-react';

export default function Quests() {
  return (
    <div className="min-h-screen py-12 px-4 sm:px-6 lg:px-8 bg-[#020617] relative">
       {/* Background Effects */}
       <div className="absolute top-0 right-0 w-[600px] h-[600px] bg-amber-500/5 rounded-full blur-[120px] -z-10" />

       <div className="max-w-5xl mx-auto space-y-12">
          
          {/* Hero: Season Pass Style */}
          <div className="relative glass rounded-[2rem] p-8 md:p-12 border border-white/10 overflow-hidden">
             <div className="absolute top-0 left-0 w-full h-full bg-gradient-to-r from-amber-500/10 to-transparent -z-10" />
             
             <div className="flex flex-col md:flex-row justify-between items-end gap-8">
                <div className="space-y-4 max-w-lg">
                   <div className="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-amber-500/20 text-amber-400 text-xs font-bold border border-amber-500/20">
                      <Flame className="w-3 h-3" /> Season 1: The Pioneers
                   </div>
                   <h1 className="text-4xl font-extrabold text-white">Level 5 Trader</h1>
                   <div className="space-y-2">
                      <div className="flex justify-between text-sm font-medium">
                         <span className="text-slate-300">XP Progress</span>
                         <span className="text-amber-400">2,450 / 3,000</span>
                      </div>
                      <Progress value={82} className="h-3 bg-slate-900 border border-slate-800" indicatorClassName="bg-gradient-to-r from-amber-500 to-orange-500" />
                   </div>
                </div>
                
                <div className="flex gap-4">
                   <RewardBox label="Next Reward" value="50 BC" icon={<Gift className="w-5 h-5 text-purple-400" />} />
                   <RewardBox label="Season End" value="12 Days" icon={<Clock className="w-5 h-5 text-blue-400" />} />
                </div>
             </div>
          </div>

          <div className="grid lg:grid-cols-3 gap-8">
             
             {/* Left: Daily Quests */}
             <div className="lg:col-span-2 space-y-6">
                <h2 className="text-2xl font-bold text-white flex items-center gap-2">
                   <Swords className="w-6 h-6 text-emerald-400" /> Daily Quests
                </h2>
                
                <div className="space-y-4">
                   <QuestItem 
                      title="The Lister" 
                      desc="Post 1 new item or skill listing today."
                      reward="5 BC"
                      progress={1}
                      total={1}
                      completed
                   />
                   <QuestItem 
                      title="Community Voice" 
                      desc="Comment on 3 community threads to help others."
                      reward="10 BC"
                      progress={1}
                      total={3}
                   />
                   <QuestItem 
                      title="Deal Maker" 
                      desc="Complete 1 trade verification."
                      reward="25 BC"
                      progress={0}
                      total={1}
                   />
                </div>

                <h2 className="text-2xl font-bold text-white flex items-center gap-2 pt-8">
                   <Target className="w-6 h-6 text-red-400" /> Community Bounties
                </h2>
                <div className="grid sm:grid-cols-2 gap-4">
                   <BountyCard 
                      title="Logo Design Needed" 
                      requester="StartupDAO" 
                      reward="500 BC" 
                      difficulty="Hard"
                   />
                   <BountyCard 
                      title="Move a Sofa" 
                      requester="LocalCafe" 
                      reward="150 BC" 
                      difficulty="Medium"
                   />
                </div>
             </div>

             {/* Right: Achievements */}
             <div className="space-y-6">
                <h2 className="text-2xl font-bold text-white flex items-center gap-2">
                   <Trophy className="w-6 h-6 text-amber-400" /> Badges
                </h2>
                <div className="glass rounded-2xl p-6 border border-white/5 grid grid-cols-3 gap-4">
                   <BadgeItem icon="" name="Eco Starter" unlocked />
                   <BadgeItem icon="" name="Trusted" unlocked />
                   <BadgeItem icon="" name="Power User" />
                   <BadgeItem icon="" name="Diamond" />
                   <BadgeItem icon="" name="Mentor" />
                   <BadgeItem icon="" name="Legend" />
                </div>
             </div>
          </div>
       </div>
    </div>
  );
}

function QuestItem({ title, desc, reward, progress, total, completed }: any) {
   const percent = (progress / total) * 100;
   
   return (
      <div className={`glass p-5 rounded-2xl border transition-all ${completed ? 'border-emerald-500/30 bg-emerald-500/5' : 'border-white/5'}`}>
         <div className="flex justify-between items-start mb-3">
            <div>
               <h3 className={`font-bold text-lg ${completed ? 'text-emerald-400' : 'text-white'}`}>{title}</h3>
               <p className="text-slate-400 text-sm">{desc}</p>
            </div>
            <div className="bg-slate-900 border border-slate-800 px-3 py-1 rounded-lg text-amber-400 font-bold text-sm">
               +{reward}
            </div>
         </div>
         <div className="flex items-center gap-4">
            <div className="flex-1 h-2 bg-slate-900 rounded-full overflow-hidden">
               <div className="h-full bg-emerald-500 transition-all duration-1000" style={{ width: `${percent}%` }} />
            </div>
            <div className="text-xs font-bold text-slate-500">
               {progress} / {total}
            </div>
            {completed && <CheckCircle className="w-5 h-5 text-emerald-500" />}
         </div>
      </div>
   );
}

function BountyCard({ title, requester, reward, difficulty }: any) {
   return (
      <div className="glass p-5 rounded-2xl border border-white/5 hover:border-red-500/30 hover:bg-red-500/5 transition-all cursor-pointer group">
         <div className="flex justify-between items-start mb-4">
            <div className="p-2 bg-red-500/10 rounded-lg text-red-400 group-hover:bg-red-500 group-hover:text-white transition-colors">
               <Target className="w-5 h-5" />
            </div>
            <span className="text-[10px] uppercase font-bold text-slate-500 border border-slate-700 px-2 py-0.5 rounded">{difficulty}</span>
         </div>
         <h3 className="font-bold text-white mb-1">{title}</h3>
         <p className="text-sm text-slate-400 mb-4">by {requester}</p>
         <div className="flex items-center gap-2 text-amber-400 font-bold">
            <Coins className="w-4 h-4" /> {reward}
         </div>
      </div>
   );
}

function RewardBox({ label, value, icon }: any) {
   return (
      <div className="bg-slate-900/50 backdrop-blur border border-white/10 rounded-xl p-3 flex flex-col items-center min-w-[80px]">
         {icon}
         <div className="text-lg font-bold text-white mt-1">{value}</div>
         <div className="text-[10px] text-slate-400 uppercase">{label}</div>
      </div>
   );
}

function BadgeItem({ icon, name, unlocked }: any) {
   return (
      <div className={`flex flex-col items-center gap-2 ${unlocked ? 'opacity-100' : 'opacity-30 grayscale'}`}>
         <div className="w-16 h-16 rounded-full bg-gradient-to-br from-slate-800 to-slate-900 border border-white/10 flex items-center justify-center text-2xl shadow-lg">
            {icon}
         </div>
         <span className="text-xs font-medium text-slate-300">{name}</span>
      </div>
   );
}

================================================
FILE: D:\barter_verse\frontend\src\pages\Settings.tsx
================================================
import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { Label } from '@/components/ui/label';
import { useCoins } from '@/contexts/CoinContext';
import { Coins, LogOut, AlertCircle, Download, Trash2 } from 'lucide-react';
import { toast } from 'sonner';
import { useState, useEffect } from 'react';

export default function Settings() {
  const { balance, addCoins, spendCoins } = useCoins();
  const [loading, setLoading] = useState(false);
  const [message, setMessage] = useState('');
  const [deletePassword, setDeletePassword] = useState('');
  const [showDeleteConfirm, setShowDeleteConfirm] = useState(false);
  const [auditLogs, setAuditLogs] = useState<any[]>([]);

  const handleExportData = async () => {
    try {
      setLoading(true);
      const response = await fetch('/api/privacy/export', {
        headers: { Authorization: `Bearer ${localStorage.getItem('auth_token')}` },
      });
      const result = await response.json();

      if (result.success) {
        const dataStr = JSON.stringify(result.data, null, 2);
        const dataBlob = new Blob([dataStr], { type: 'application/json' });
        const url = URL.createObjectURL(dataBlob);
        const link = document.createElement('a');
        link.href = url;
        link.download = `barter_verse_data_${new Date().toISOString().split('T')[0]}.json`;
        link.click();
        toast.success(' Your data has been exported successfully!');
        setMessage(' Your data has been exported successfully!');
      } else {
        setMessage(` Error: ${result.message}`);
        toast.error(`Error: ${result.message}`);
      }
    } catch (error: any) {
      setMessage(` Error: ${error.message}`);
      toast.error(`Error: ${error.message}`);
    } finally {
      setLoading(false);
    }
  };

  const handleDeleteAccount = async () => {
    if (!deletePassword) {
      setMessage(' Please enter your password to confirm deletion');
      toast.error('Please enter your password to confirm deletion');
      return;
    }

    try {
      setLoading(true);
      const response = await fetch('/api/privacy/delete-account', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          Authorization: `Bearer ${localStorage.getItem('auth_token')}`,
        },
        body: JSON.stringify({ password: deletePassword }),
      });
      const result = await response.json();

      if (result.success) {
        setMessage(' Account deleted successfully. You will be logged out in 3 seconds...');
        toast.success('Account deleted. Logging out...');
        setTimeout(() => {
          localStorage.removeItem('token');
          window.location.href = '/';
        }, 3000);
      } else {
        setMessage(` Error: ${result.message}`);
        toast.error(`Error: ${result.message}`);
      }
    } catch (error: any) {
      setMessage(` Error: ${error.message}`);
      toast.error(`Error: ${error.message}`);
    } finally {
      setLoading(false);
      setDeletePassword('');
    }
  };

  const fetchAuditLogs = async () => {
    try {
      const response = await fetch('/api/privacy/audit-logs?limit=20', {
        headers: { Authorization: `Bearer ${localStorage.getItem('auth_token')}` },
      });
      const result = await response.json();
      if (result.success) {
        setAuditLogs(result.data);
      }
    } catch (error) {
      console.error('Error fetching audit logs:', error);
    }
  };

  useEffect(() => {
    fetchAuditLogs();
  }, []);

  const handleAddCoins = async () => {
    const success = await addCoins(50, 'manual_add');
    if (success) {
      toast.success('Added 50 BC to your wallet!');
    }
  };

  const handleSpendCoins = async () => {
    const success = await spendCoins(25, 'manual_spend');
    if (success) {
      toast.success('Spent 25 BC successfully!');
    }
  };

  return (
    <div className="container mx-auto px-4 py-8 max-w-4xl">
      <div className="space-y-8">
        <div className="space-y-2">
          <h1 className="text-4xl font-bold">Settings</h1>
          <p className="text-muted-foreground text-lg">
            Manage your profile and preferences
          </p>
        </div>

        <div className="space-y-6">
          {/* Profile Settings */}
          <Card className="card-glass">
            <CardHeader>
              <CardTitle>Profile Information</CardTitle>
            </CardHeader>
            <CardContent className="space-y-4">
              <div className="space-y-2">
                <Label htmlFor="name">Display Name</Label>
                <Input id="name" defaultValue="You" />
              </div>
              <div className="space-y-2">
                <Label htmlFor="email">Email</Label>
                <Input id="email" type="email" defaultValue="trader@barterverse.com" />
              </div>
              <div className="space-y-2">
                <Label htmlFor="location">Location</Label>
                <Input id="location" defaultValue="Delhi" />
              </div>
              <Button className="bg-primary hover:bg-primary/90">
                Save Changes
              </Button>
            </CardContent>
          </Card>

          {/* Coin Wallet */}
          <Card className="card-glass">
            <CardHeader>
              <CardTitle>Barter Coin Wallet</CardTitle>
            </CardHeader>
            <CardContent className="space-y-6">
              <div className="flex items-center justify-between p-6 rounded-xl bg-gradient-to-r from-primary/20 to-accent/20 border border-primary/30">
                <div className="flex items-center gap-3">
                  <Coins className="w-8 h-8 text-accent" />
                  <div>
                    <div className="text-sm text-muted-foreground">Current Balance</div>
                    <div className="text-3xl font-bold text-accent">{balance} BC</div>
                  </div>
                </div>
              </div>
              <div className="flex gap-4">
                <Button onClick={handleAddCoins} className="flex-1 bg-primary hover:bg-primary/90">
                  Add 50 BC
                </Button>
                <Button onClick={handleSpendCoins} variant="outline" className="flex-1">
                  Spend 25 BC
                </Button>
              </div>
            </CardContent>
          </Card>

          {/* Account Actions */}
          <Card className="card-glass">
            <CardHeader>
              <CardTitle>Account</CardTitle>
            </CardHeader>
            <CardContent className="space-y-4">
              <Button variant="destructive" className="w-full">
                <LogOut className="w-4 h-4 mr-2" />
                Logout
              </Button>
            </CardContent>
          </Card>

          {/* Privacy & Data Protection */}
          <Card className="card-glass">
            <CardHeader>
              <CardTitle className="flex items-center gap-2">
                <span></span> Privacy & Data Protection
              </CardTitle>
            </CardHeader>
            <CardContent className="space-y-6">
              {message && (
                <div className="p-4 rounded-lg bg-primary/5 border border-primary/20 text-sm text-foreground">
                  {message}
                </div>
              )}

              {/* Export Data Section */}
              <div className="space-y-3 p-4 rounded-lg border border-border">
                <div className="flex items-start gap-3">
                  <Download className="w-5 h-5 text-primary mt-1 flex-shrink-0" />
                  <div className="flex-1">
                    <h3 className="font-semibold mb-1"> Export Your Data (GDPR)</h3>
                    <p className="text-sm text-muted-foreground mb-3">
                      Download a complete copy of your profile, listings, trades, and transaction history
                    </p>
                    <Button
                      onClick={handleExportData}
                      disabled={loading}
                      variant="default"
                    >
                      {loading ? ' Exporting...' : ' Export Data'}
                    </Button>
                  </div>
                </div>
              </div>

              {/* Audit Logs Section */}
              <div className="space-y-3">
                <h3 className="font-semibold"> Account Activity Log</h3>
                <div className="overflow-x-auto border rounded-lg">
                  <table className="w-full text-sm">
                    <thead className="bg-muted">
                      <tr>
                        <th className="px-4 py-2 text-left">Action</th>
                        <th className="px-4 py-2 text-left">Resource</th>
                        <th className="px-4 py-2 text-left">Status</th>
                        <th className="px-4 py-2 text-left">Date</th>
                      </tr>
                    </thead>
                    <tbody>
                      {auditLogs.length > 0 ? (
                        auditLogs.map((log) => (
                          <tr key={log.userId + log.timestamp} className="border-t">
                            <td className="px-4 py-2">{log.action}</td>
                            <td className="px-4 py-2">{log.resource}</td>
                            <td className="px-4 py-2">
                              <span
                                className={`px-2 py-1 rounded text-xs font-medium ${
                                  log.status === 'success'
                                    ? 'bg-success/10 text-success'
                                    : 'bg-destructive/10 text-destructive'
                                }`}
                              >
                                {log.status}
                              </span>
                            </td>
                            <td className="px-4 py-2 text-muted-foreground">
                              {new Date(log.timestamp).toLocaleDateString()}
                            </td>
                          </tr>
                        ))
                      ) : (
                        <tr>
                          <td colSpan={4} className="px-4 py-2 text-center text-muted-foreground">
                            No activity logs yet
                          </td>
                        </tr>
                      )}
                    </tbody>
                  </table>
                </div>
              </div>

              {/* Delete Account Section */}
              <div className="space-y-3 p-4 rounded-lg border border-destructive/20 bg-destructive/5">
                <div className="flex items-start gap-3">
                  <AlertCircle className="w-5 h-5 text-destructive mt-1 flex-shrink-0" />
                  <div className="flex-1">
                    <h3 className="font-semibold text-destructive mb-1">
                       Delete Account (GDPR)
                    </h3>
                    <p className="text-sm text-muted-foreground mb-3">
                      Your account will be anonymized and all personal information will be removed. This action cannot be undone.
                    </p>

                    {!showDeleteConfirm ? (
                      <Button
                        onClick={() => setShowDeleteConfirm(true)}
                        variant="destructive"
                      >
                        <Trash2 className="w-4 h-4 mr-2" />
                        Delete Account
                      </Button>
                    ) : (
                      <div className="card-upgrade p-3 border border-destructive/20 bg-card">
                        <p className="text-sm font-semibold">Confirm account deletion by entering your password:</p>
                        <Input
                          type="password"
                          placeholder="Enter your password"
                          value={deletePassword}
                          onChange={(e) => setDeletePassword(e.target.value)}
                        />
                        <div className="flex gap-3">
                          <Button
                            onClick={handleDeleteAccount}
                            disabled={loading}
                            variant="destructive"
                          >
                            {loading ? ' Deleting...' : 'Confirm Deletion'}
                          </Button>
                          <Button
                            onClick={() => {
                              setShowDeleteConfirm(false);
                              setDeletePassword('');
                            }}
                            variant="outline"
                          >
                            Cancel
                          </Button>
                        </div>
                      </div>
                    )}
                  </div>
                </div>
              </div>

              {/* Privacy Info */}
              <div className="p-3 bg-primary/5 border border-primary/20 rounded-lg text-sm space-y-2 text-foreground">
                <p>
                  <strong> Data Protection:</strong> Your password is hashed using bcryptjs. Sensitive data is encrypted.
                </p>
                <p>
                  <strong> GDPR Compliance:</strong> We support your right to access, export, and delete your data.
                </p>
              </div>
            </CardContent>
          </Card>
        </div>
      </div>
    </div>
  );
}


================================================
FILE: D:\barter_verse\frontend\src\pages\SkillShare.tsx
================================================
import { Card, CardContent } from '@/components/ui/card';
import { Badge } from '@/components/ui/badge';
import { Button } from '@/components/ui/button';
import { Calendar, User, Star, Zap, Clock, ShieldCheck, Search, Filter } from 'lucide-react';
import { Input } from '@/components/ui/input';

const skills = [
  {
    id: 1,
    title: 'Web Development',
    provider: 'Ammar',
    rating: 4.8,
    available: true,
    category: 'Tech',
    image: 'https://images.unsplash.com/photo-1498050108023-c5249f4df085?w=500',
  },
  {
    id: 2,
    title: 'Graphic Design',
    provider: 'Priya',
    rating: 4.9,
    available: true,
    category: 'Design',
    image: 'https://images.unsplash.com/photo-1626785774573-4b799315345d?w=500',
  },
  {
    id: 3,
    title: 'Language Tutoring',
    provider: 'Rahul',
    rating: 4.7,
    available: false,
    category: 'Education',
    image: 'https://images.unsplash.com/photo-1546410531-bb4caa6b424d?w=500',
  },
  {
    id: 4,
    title: 'Music Lessons',
    provider: 'Siddu',
    rating: 5.0,
    available: true,
    category: 'Arts',
    image: 'https://images.unsplash.com/photo-1511379938547-c1f69419868d?w=500',
  },
];

export default function SkillShare() {
  return (
    <div className="min-h-screen py-12 px-4 sm:px-6 lg:px-8 relative bg-[#020617]">
      {/* Background Ambience */}
      <div className="absolute top-0 left-0 w-full h-[500px] bg-indigo-500/10 blur-[120px] -z-10" />

      <div className="max-w-7xl mx-auto space-y-12">
        
        {/* Header Section */}
        <div className="flex flex-col md:flex-row justify-between items-end gap-6 animate-fade-in-up">
          <div className="space-y-4 max-w-2xl">
            <div className="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-indigo-500/10 border border-indigo-500/20 text-indigo-400 text-sm font-medium">
              <Zap className="w-4 h-4" />
              <span>Master New Skills</span>
            </div>
            <h1 className="text-4xl md:text-6xl font-extrabold text-white tracking-tight">
              Skill <span className="text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 to-purple-400">Exchange</span>
            </h1>
            <p className="text-lg text-slate-400">
              Trade your expertise for knowledge. Connect with mentors and learners in the BarterVerse.
            </p>
          </div>

          {/* Search/Filter Bar */}
          <div className="glass p-2 rounded-xl border border-white/10 flex gap-2 w-full md:w-auto">
             <div className="relative flex-1 md:w-64">
                <Search className="absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-500" />
                <Input 
                   placeholder="Find a skill..." 
                   className="pl-9 bg-slate-900/50 border-transparent text-white focus:bg-slate-900 h-10 rounded-lg"
                />
             </div>
             <Button size="icon" variant="ghost" className="text-slate-400 hover:text-white">
                <Filter className="w-4 h-4" />
             </Button>
          </div>
        </div>

        {/* Skills Grid */}
        <div className="grid sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8 animate-fade-in-up [animation-delay:200ms] opacity-0" style={{ animationFillMode: 'forwards' }}>
          {skills.map((skill, idx) => (
            <div 
               key={skill.id} 
               className="group relative bg-slate-900 border border-slate-800 hover:border-indigo-500/50 rounded-3xl overflow-hidden transition-all duration-500 hover:shadow-2xl hover:shadow-indigo-500/20 flex flex-col hover:-translate-y-1"
               style={{ animationDelay: `${idx * 100}ms` }}
            >
              
              {/* Image Area */}
              <div className="relative h-56 overflow-hidden">
                <img
                  src={skill.image}
                  alt={skill.title}
                  className="w-full h-full object-cover transition-transform duration-700 group-hover:scale-110"
                />
                <div className="absolute inset-0 bg-gradient-to-t from-slate-900 via-slate-900/40 to-transparent" />
                
                {/* Status Badge */}
                <div className="absolute top-4 right-4">
                  {skill.available ? (
                    <div className="flex items-center gap-1.5 px-3 py-1 rounded-full bg-emerald-500/20 backdrop-blur-md border border-emerald-500/30 text-emerald-400 text-xs font-bold shadow-lg">
                      <span className="relative flex h-2 w-2">
                        <span className="animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"></span>
                        <span className="relative inline-flex rounded-full h-2 w-2 bg-emerald-500"></span>
                      </span>
                      OPEN
                    </div>
                  ) : (
                    <div className="flex items-center gap-1.5 px-3 py-1 rounded-full bg-slate-800/80 backdrop-blur-md border border-white/10 text-slate-400 text-xs font-bold">
                      <Clock className="w-3 h-3" />
                      BUSY
                    </div>
                  )}
                </div>

                <div className="absolute bottom-4 left-4 right-4">
                  <Badge variant="outline" className="bg-white/10 backdrop-blur-sm border-white/20 text-white mb-2 hover:bg-white/20 transition-colors">
                    {skill.category}
                  </Badge>
                  <h3 className="text-xl font-bold text-white group-hover:text-indigo-400 transition-colors line-clamp-1">{skill.title}</h3>
                </div>
              </div>

              {/* Content Area */}
              <div className="p-5 flex flex-col flex-1 gap-4">
                <div className="flex items-center justify-between p-3 rounded-xl bg-slate-950/50 border border-white/5 group-hover:border-white/10 transition-colors">
                  <div className="flex items-center gap-3">
                    <div className="w-10 h-10 rounded-full bg-slate-800 flex items-center justify-center border border-slate-700 text-slate-300 font-bold">
                      {skill.provider[0]}
                    </div>
                    <div>
                      <p className="text-sm font-medium text-slate-200">{skill.provider}</p>
                      <div className="flex items-center text-xs text-amber-400 font-medium">
                        <Star className="w-3 h-3 fill-amber-400 mr-1" />
                        {skill.rating}
                      </div>
                    </div>
                  </div>
                  <ShieldCheck className="w-5 h-5 text-slate-600 group-hover:text-emerald-500 transition-colors" />
                </div>

                <Button
                  className={`w-full h-12 text-base font-medium transition-all duration-300 ${
                    skill.available 
                      ? 'bg-indigo-600 hover:bg-indigo-500 text-white shadow-lg shadow-indigo-900/20 hover:shadow-indigo-500/30' 
                      : 'bg-slate-800 text-slate-500 cursor-not-allowed hover:bg-slate-800'
                  }`}
                  disabled={!skill.available}
                >
                  <Calendar className="w-4 h-4 mr-2" />
                  {skill.available ? 'Book Session' : 'Unavailable'}
                </Button>
              </div>
            </div>
          ))}
        </div>
      </div>
    </div>
  );
}

================================================
FILE: D:\barter_verse\frontend\src\pages\TradeCenter.tsx
================================================
import { useEffect, useState } from 'react';
import { useTrade, Trade } from '@/contexts/TradeContext';
import { useAuth } from '@/contexts/AuthContext';
import { Button } from '@/components/ui/button';
import { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';
import { 
  CheckCircle, Clock, ShieldCheck, 
  AlertTriangle, Package, ArrowRight, Lock, User,
  ArrowUpRight, ArrowDownLeft
} from 'lucide-react';
import { Link } from 'react-router-dom';

export default function TradeCenter() {
  const { trades, fetchTrades, isLoading, acceptTrade, rejectTrade, confirmDelivery, completeTrade, activeEscrowAmount } = useTrade();
  const { user } = useAuth();
  const [activeTab, setActiveTab] = useState('active');

  useEffect(() => {
    fetchTrades();
    const interval = setInterval(fetchTrades, 5000);
    return () => clearInterval(interval);
  }, []);

  const activeTrades = trades.filter(t => ['PENDING', 'ESCROW_LOCKED', 'DELIVERED'].includes(t.status));
  const historyTrades = trades.filter(t => ['COMPLETED', 'REJECTED', 'DISPUTED'].includes(t.status));

  return (
    <div className="min-h-screen py-12 px-4 sm:px-6 lg:px-8 bg-[#020617] relative">
      <div className="absolute top-0 right-0 w-[500px] h-[500px] bg-emerald-500/5 rounded-full blur-[100px] -z-10" />
      
      <div className="max-w-5xl mx-auto space-y-8">
        
        {/* Header */}
        <div className="flex flex-col md:flex-row justify-between items-end gap-6 animate-fade-in-up">
          <div>
            <h1 className="text-3xl font-bold text-white mb-2">Trade Control Center</h1>
            <p className="text-slate-400">Manage your active negotiations and secure escrow exchanges.</p>
          </div>
          
          <div className="glass px-6 py-3 rounded-2xl border border-emerald-500/20 bg-emerald-500/5 flex items-center gap-4">
             <div className="p-2 bg-emerald-500/20 rounded-lg text-emerald-400">
                <Lock className="w-5 h-5" />
             </div>
             <div>
                <div className="text-xs text-emerald-400 font-bold uppercase tracking-wider">Active Escrow</div>
                <div className="text-xl font-bold text-white">{activeEscrowAmount} BC <span className="text-xs text-slate-400 font-normal">Locked</span></div>
             </div>
          </div>
        </div>

        {/* Tabs */}
        <Tabs defaultValue="active" onValueChange={setActiveTab} className="w-full">
          <TabsList className="bg-slate-900/80 border border-slate-800 p-1 rounded-xl mb-6">
            <TabsTrigger value="active" className="flex-1 rounded-lg text-slate-400 data-[state=active]:bg-emerald-600 data-[state=active]:text-white transition-all font-medium">
               Active Trades ({activeTrades.length})
            </TabsTrigger>
            <TabsTrigger value="history" className="flex-1 rounded-lg text-slate-400 data-[state=active]:bg-emerald-600 data-[state=active]:text-white transition-all font-medium">
               History
            </TabsTrigger>
          </TabsList>

          <div className="space-y-4">
             {isLoading ? (
                <div className="text-center py-20 text-slate-400 animate-pulse">Loading secure data...</div>
             ) : (activeTab === 'active' ? activeTrades : historyTrades).length === 0 ? (
                <div className="text-center py-20 glass rounded-3xl border border-dashed border-slate-800">
                   <Package className="w-12 h-12 text-slate-600 mx-auto mb-4" />
                   <h3 className="text-lg font-medium text-slate-300">No trades found</h3>
                   <p className="text-slate-400 mb-6">Start a conversation to initiate a trade.</p>
                   <Link to="/explore"><Button variant="outline" className="border-slate-700 text-slate-300 hover:text-white hover:bg-slate-800">Browse Listings</Button></Link>
                </div>
             ) : (
                (activeTab === 'active' ? activeTrades : historyTrades).map((trade) => (
                   <TradeCard 
                      key={trade.id} 
                      trade={trade} 
                      currentUserId={user?.id || ''}
                      actions={{ acceptTrade, rejectTrade, confirmDelivery, completeTrade }}
                   />
                ))
             )}
          </div>
        </Tabs>
      </div>
    </div>
  );
}

// --- Trade Card Component ---
function TradeCard({ trade, currentUserId, actions }: { trade: Trade, currentUserId: string, actions: any }) {
   const isInitiator = trade.initiatorId === currentUserId;
   
   // Logic: If you are the Responder (Seller), the trade is Incoming.
   const isIncoming = trade.responderUserId === currentUserId || trade.responder_id === currentUserId;
   
   const partner = isInitiator ? trade.responder : trade.initiator;

   const formatDate = (dateString: string) => {
       try {
           return new Date(dateString).toLocaleDateString();
       } catch (e) {
           return 'New';
       }
   };

   return (
      <div className="glass p-6 rounded-3xl border border-white/10 relative overflow-hidden group hover:border-emerald-500/30 transition-all bg-[#0B1121]/50">
         {/* Status Line */}
         <div className={`absolute left-0 top-0 bottom-0 w-1 ${
            trade.status === 'COMPLETED' ? 'bg-emerald-500' : 
            trade.status === 'ESCROW_LOCKED' ? 'bg-amber-500' : 
            trade.status === 'DELIVERED' ? 'bg-blue-500' :
            trade.status === 'DISPUTED' ? 'bg-red-500' : 'bg-slate-600'
         }`} />

         <div className="flex flex-col md:flex-row gap-6 items-center">
            
            <div className="flex-1 space-y-4 w-full">
               <div className="flex justify-between items-start">
                  <div className="flex items-center gap-3">
                     
                     {/* 1. Status Badge */}
                     <span className={`text-[10px] font-bold px-2 py-1 rounded border uppercase tracking-wider ${
                        trade.status === 'ESCROW_LOCKED' ? 'bg-amber-500/10 text-amber-400 border-amber-500/20' :
                        trade.status === 'DELIVERED' ? 'bg-blue-500/10 text-blue-400 border-blue-500/20' :
                        trade.status === 'COMPLETED' ? 'bg-emerald-500/10 text-emerald-400 border-emerald-500/20' :
                        'bg-slate-800 text-slate-300 border-slate-600'
                     }`}>
                        {trade.status.replace('_', ' ')}
                     </span>

                     {/* 2. Direction Badge */}
                     <span className={`text-[10px] font-bold px-2 py-1 rounded border uppercase tracking-wider flex items-center gap-1 ${
                        isIncoming 
                        ? 'bg-blue-500/10 text-blue-400 border-blue-500/20' 
                        : 'bg-purple-500/10 text-purple-400 border-purple-500/20'
                     }`}>
                        {isIncoming ? <ArrowDownLeft className="w-3 h-3" /> : <ArrowUpRight className="w-3 h-3" />}
                        {isIncoming ? 'Received' : 'Sent'}
                     </span>

                     <span className="text-xs text-slate-400 font-medium">
                        {trade.createdAt ? formatDate(trade.createdAt) : 'Just now'}
                     </span>
                  </div>
               </div>

               <div className="flex items-center justify-between p-4 bg-slate-900/80 rounded-2xl border border-white/5">
                  <div className="flex items-center gap-3">
                     <div className="w-10 h-10 rounded-full bg-slate-800 flex items-center justify-center border border-slate-700">
                        <User className="w-5 h-5 text-slate-300" />
                     </div>
                     <div>
                        <div className="text-sm font-bold text-white">
                            {partner?.display_name || partner?.username || 'Trading Partner'}
                        </div>
                        <div className="text-xs text-slate-400">Partner</div>
                     </div>
                  </div>
                  
                  <ArrowRight className="w-5 h-5 text-slate-500" />
                  
                  <div className="text-right">
                     <div className="text-sm font-bold text-white truncate max-w-[150px]">
                        {trade.listing?.title || 'Unknown Item'}
                     </div>
                     <div className="text-xs text-emerald-400 font-bold">
                        {trade.proposedCoins || trade.coin_amount || 0} BC
                     </div>
                  </div>
               </div>
            </div>

            {/* Actions */}
            <div className="w-full md:w-auto min-w-[200px] flex flex-col gap-3">
               
               {/* 1. PENDING: Only Seller (Incoming) can accept */}
               {trade.status === 'PENDING' && isIncoming && (
                  <>
                     <div className="text-xs text-center text-amber-400 mb-1 flex items-center justify-center gap-1">
                        <AlertTriangle className="w-3 h-3" /> Action Required
                     </div>
                     <Button onClick={() => actions.acceptTrade(trade.id)} className="w-full bg-emerald-600 hover:bg-emerald-500 text-white">
                        Accept & Lock Funds
                     </Button>
                     <Button onClick={() => actions.rejectTrade(trade.id)} variant="outline" className="w-full border-red-900/50 text-red-400 hover:bg-red-900/20">
                        Decline Offer
                     </Button>
                  </>
               )}
               {trade.status === 'PENDING' && !isIncoming && (
                   <div className="text-center p-4 rounded-xl bg-slate-800/50 border border-slate-700">
                      <Clock className="w-6 h-6 text-slate-400 mx-auto mb-2 animate-pulse" />
                      <div className="text-sm text-slate-300">Waiting for response</div>
                   </div>
               )}

               {/* 2. ESCROW LOCKED: Seller (Incoming) must Deliver */}
               {trade.status === 'ESCROW_LOCKED' && (
                  <div className="space-y-3">
                     <div className="flex items-center justify-center gap-2 text-xs text-emerald-400 font-bold bg-emerald-500/10 p-2 rounded-lg border border-emerald-500/20">
                        <ShieldCheck className="w-3 h-3" /> Funds Secured
                     </div>
                     
                     {/* FIX: If you are the SELLER (Incoming), YOU confirm delivery */}
                     {isIncoming ? ( 
                        <Button onClick={() => actions.confirmDelivery(trade.id)} className="w-full bg-blue-600 hover:bg-blue-500 text-white">
                           <Package className="w-4 h-4 mr-2" /> Confirm I Sent It
                        </Button>
                     ) : (
                        <div className="text-xs text-slate-400 text-center">Waiting for seller to deliver...</div>
                     )}
                  </div>
               )}

               {/* 3. DELIVERED: Buyer (Outgoing) must Release Funds */}
               {trade.status === 'DELIVERED' && (
                  <div className="space-y-3">
                     {/* FIX: If you are the BUYER (Not Incoming), YOU release funds */}
                     {!isIncoming ? (
                        <Button onClick={() => actions.completeTrade(trade.id)} className="w-full bg-emerald-600 hover:bg-emerald-500 shadow-[0_0_15px_rgba(16,185,129,0.4)] animate-pulse text-white">
                           <CheckCircle className="w-4 h-4 mr-2" /> Release Funds
                        </Button>
                     ) : (
                        <div className="text-xs text-slate-400 text-center">Waiting for buyer to confirm...</div>
                     )}
                  </div>
               )}
               
               {/* 4. COMPLETED */}
               {trade.status === 'COMPLETED' && (
                  <div className="flex items-center justify-center gap-2 text-emerald-400 font-bold bg-emerald-500/5 p-3 rounded-xl border border-emerald-500/20">
                     <CheckCircle className="w-5 h-5" /> Trade Successful
                  </div>
               )}
            </div>
         </div>
      </div>
   );
}

================================================
FILE: D:\barter_verse\frontend\src\vite-env.d.ts
================================================
/// <reference types="vite/client" />


================================================
FILE: D:\barter_verse\frontend\tailwind.config.ts
================================================
import type { Config } from "tailwindcss";

export default {
  darkMode: ["class"],
  content: [
    "./pages/**/*.{ts,tsx}",
    "./components/**/*.{ts,tsx}",
    "./app/**/*.{ts,tsx}",
    "./src/**/*.{ts,tsx}",
  ],
  prefix: "",
  theme: {
    container: {
      center: true,
      padding: "2rem",
      screens: {
        "2xl": "1400px",
      },
    },
    extend: {
      colors: {
        border: "hsl(var(--border))",
        input: "hsl(var(--input))",
        ring: "hsl(var(--ring))",
        background: "hsl(var(--background))",
        foreground: "hsl(var(--foreground))",
        primary: {
          DEFAULT: "hsl(var(--primary))",
          foreground: "hsl(var(--primary-foreground))",
        },
        secondary: {
          DEFAULT: "hsl(var(--secondary))",
          foreground: "hsl(var(--secondary-foreground))",
        },
        destructive: {
          DEFAULT: "hsl(var(--destructive))",
          foreground: "hsl(var(--destructive-foreground))",
        },
        muted: {
          DEFAULT: "hsl(var(--muted))",
          foreground: "hsl(var(--muted-foreground))",
        },
        accent: {
          DEFAULT: "hsl(var(--accent))",
          foreground: "hsl(var(--accent-foreground))",
        },
        popover: {
          DEFAULT: "hsl(var(--popover))",
          foreground: "hsl(var(--popover-foreground))",
        },
        card: {
          DEFAULT: "hsl(var(--card))",
          foreground: "hsl(var(--card-foreground))",
        },
      },
      borderRadius: {
        lg: "var(--radius)",
        md: "calc(var(--radius) - 2px)",
        sm: "calc(var(--radius) - 4px)",
      },
      keyframes: {
        "accordion-down": {
          from: { height: "0" },
          to: { height: "var(--radix-accordion-content-height)" },
        },
        "accordion-up": {
          from: { height: "var(--radix-accordion-content-height)" },
          to: { height: "0" },
        },
        "fade-in-up": {
          "0%": { opacity: "0", transform: "translateY(20px)" },
          "100%": { opacity: "1", transform: "translateY(0)" },
        },
        "float": {
          "0%, 100%": { transform: "translateY(0)" },
          "50%": { transform: "translateY(-15px)" },
        },
        "blob": {
          "0%": { transform: "translate(0px, 0px) scale(1)" },
          "33%": { transform: "translate(30px, -50px) scale(1.1)" },
          "66%": { transform: "translate(-20px, 20px) scale(0.9)" },
          "100%": { transform: "translate(0px, 0px) scale(1)" },
        },
        "shimmer": {
          "0%": { backgroundPosition: "200% 0" },
          "100%": { backgroundPosition: "-200% 0" },
        },
        "pulse-slow": {
          "0%, 100%": { opacity: "1" },
          "50%": { opacity: "0.5" },
        },
      },
      animation: {
        "accordion-down": "accordion-down 0.2s ease-out",
        "accordion-up": "accordion-up 0.2s ease-out",
        "fade-in-up": "fade-in-up 0.8s ease-out forwards",
        "float": "float 6s ease-in-out infinite",
        "blob": "blob 7s infinite",
        "shimmer": "shimmer 8s linear infinite",
        "pulse-slow": "pulse-slow 4s cubic-bezier(0.4, 0, 0.6, 1) infinite",
      },
    },
  },
  plugins: [require("tailwindcss-animate")],
} satisfies Config;

================================================
FILE: D:\barter_verse\frontend\tsconfig.app.json
================================================
{
  "compilerOptions": {
    "target": "ES2020",
    "useDefineForClassFields": true,
    "lib": ["ES2020", "DOM", "DOM.Iterable"],
    "module": "ESNext",
    "skipLibCheck": true,

    /* Bundler mode */
    "moduleResolution": "bundler",
    "allowImportingTsExtensions": true,
    "isolatedModules": true,
    "moduleDetection": "force",
    "noEmit": true,
    "jsx": "react-jsx",

    /* Linting */
    "strict": false,
    "noUnusedLocals": false,
    "noUnusedParameters": false,
    "noImplicitAny": false,
    "noFallthroughCasesInSwitch": false,

    "baseUrl": ".",
    "paths": {
      "@/*": ["./src/*"]
    }
  },
  "include": ["src"]
}


================================================
FILE: D:\barter_verse\frontend\tsconfig.json
================================================
{
  "files": [],
  "references": [{ "path": "./tsconfig.app.json" }, { "path": "./tsconfig.node.json" }],
  "compilerOptions": {
    "baseUrl": ".",
    "paths": {
      "@/*": ["./src/*"]
    },
    "noImplicitAny": false,
    "noUnusedParameters": false,
    "skipLibCheck": true,
    "allowJs": true,
    "noUnusedLocals": false,
    "strictNullChecks": false
  }
}


================================================
FILE: D:\barter_verse\frontend\tsconfig.node.json
================================================
{
  "compilerOptions": {
    "target": "ES2022",
    "lib": ["ES2023"],
    "module": "ESNext",
    "skipLibCheck": true,

    /* Bundler mode */
    "moduleResolution": "bundler",
    "allowImportingTsExtensions": true,
    "isolatedModules": true,
    "moduleDetection": "force",
    "noEmit": true,

    /* Linting */
    "strict": true,
    "noUnusedLocals": false,
    "noUnusedParameters": false,
    "noFallthroughCasesInSwitch": true
  },
  "include": ["vite.config.ts"]
}


================================================
FILE: D:\barter_verse\frontend\vite.config.ts
================================================
import { defineConfig } from "vite";
import react from "@vitejs/plugin-react-swc";
import path from "path";
import { componentTagger } from "lovable-tagger";

// https://vitejs.dev/config/
export default defineConfig(({ mode }) => ({
  server: {
    host: "localhost",
    port: 8080,
  },
  plugins: [react(), mode === "development" && componentTagger()].filter(Boolean),
  resolve: {
    alias: {
      "@": path.resolve(__dirname, "./src"),
    },
  },
}));
